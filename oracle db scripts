https://www.onlinedigitallearning.com/my/ 


====================
                                                                                                                                                                       


select name,open_mode,database_role from v$database;

select sum(bytes)/1024/1024/1024 from dba_segments;

Gobinda AADHAAR 974427784769



set linesize 120
set linesize 120
set pagesize 100
column username format a30
column created format a20

select username,created from dba_users order by created;

select username,created from dba_users where username like '%&1';

COMMON

PY/BOM/13015/0065754atafile


select sum(bytes)/1024/1024/1024 from dba_segments where OWNER='&1';

select username,default_tablespace from dba_users where username like '&1';


orapwd file=password_file_name [password=the_password] [entries=n] [force=Y|N] [ignorecase=Y|N] [nosysdba=Y|N]

orapwd file=orapwPDB01 password=Oracle123 entries=n force=Y

orapwd file=orapwESAPA  password=Z9qefodf#9 entries=max_users

orapwd file=orapwWCMC1  password=oracle123 entries=n force=Y

orapwd file=orapwremprd  password=oracle123 force=Y 

select username,created from dba_users where username like '%&1%' order by created;

grep -c ^processor /proc/cpuinfo

Set user for current session :
==========================================
alter session set current_schema='&1';


alter session set current_schema=DARWIN2;

select sys_context('USERENV','SESSION_USER') current_user,sys_context('USERENV','SESSION_SCHEMA') current_schema from dual;






execute dbms_stats.gather_schema_stats(ownname => 'AVUSER',estimate_percent => 50,DEGREE => 4,cascade => TRUE);


EXEC DBMS_STATS.gather_table_stats('SCPOMGR', 'PROCESSSKU', estimate_percent => 50, cascade => TRUE);

EXEC DBMS_STATS.gather_table_stats('SCPOMGR', 'PROCESSDFU', estimate_percent => 50, cascade => TRUE);


====================================================================
Redo Logs :

=======================

set linesize 200
set pagesize 1000
column member format a80

select group#,member from v$logfile;


select THREAD#,group#,bytes from v$LOG;

select group#,bytes from v$STANDBY_LOG;


=========================================

column REDOLOG_FILE_NAME format a40;
set lines 1000

SELECT a.GROUP#, a.THREAD#, a.SEQUENCE#,
 a.ARCHIVED, a.STATUS, b.MEMBER AS REDOLOG_FILE_NAME,
 (a.BYTES/1024/1024) AS SIZE_MB FROM v$log a
JOIN v$logfile b ON a.Group#=b.Group#
ORDER BY a.GROUP#;




ALTER DATABASE ADD LOGFILE THREAD 1
GROUP 1 ('+DATA7/qacst/redo01a.log') SIZE 256m,
GROUP 1 ('+DATA7/qacst/redo01b.log') SIZE 256m;

ALTER DATABASE ADD LOGFILE THREAD 2
GROUP 3 ('+DATA7/qacst/redo03a.log') SIZE 256m,
GROUP 3 ('+DATA7/qacst/redo03b.log') SIZE 256m;


ALTER DATABASE ADD LOGFILE THREAD 1
GROUP 1 ('+DATA7/qacst/redo01a.log','+DATA7/qacst/redo01b.log') SIZE 256m,
GROUP 2 ('+DATA7/qacst/redo02a.log','+DATA7/qacst/redo02b.log') SIZE 256m;

ALTER DATABASE ADD LOGFILE THREAD 2
GROUP 3 ('+DATA7/qacst/redo03a.log','+DATA7/qacst/redo03b.log') SIZE 256m,
GROUP 4 ('+DATA7/qacst/redo04a.log','+DATA7/qacst/redo04b.log') SIZE 256m;


select group#,thread#,members,status from v$log;

alter system switch logfile;


Alter database drop logfile group 3;		 

ALTER DATABASE CLEAR UNARCHIVED LOGFILE GROUP 3;


Alter database drop logfile group 4;

ALTER SYSTEM ARCHIVE LOG GROUP


Alter database drop logfile group 3;
====================================================================

IN GB
=======
set linesize 120
set pagesize 100
column DATAFILE format a50
column TABLESPACE format a20
column CREATION_TIME format a15
select ts.name "TABLESPACE",df.name "DATAFILE",(df.bytes)/1024/1024/1024 IN_GB,df.CREATION_TIME TIME
from v$tablespace ts, v$datafile df
where ts.ts#=df.ts#
and ts.name='&1' order by CREATION_TIME
/

IN MB
=======
set linesize 120
set pagesize 100
column DATAFILE format a50
column TABLESPACE format a20
column CREATION_TIME format a15
select ts.name "TABLESPACE",df.name "DATAFILE",(df.bytes)/1024/1024 IN_MB,df.CREATION_TIME TIME
from v$tablespace ts, v$datafile df
where ts.ts#=df.ts#
and ts.name='&1' order by CREATION_TIME
/

========================================SPC TBLSPC==============================

set lines 150
COLUMN TABLESPACE_NAME format a35;
COLUMN free_space_mb format 99999990.00;
COLUMN allocated_mb format 99999990.00;
COLUMN used_mb format 99999990.00;
COLUMN percent_used format 00.00;

SELECT  SUBSTR(df.tablespace_name,1,20) tablespace_name,
        (df.bytes) / 1024 / 1024 allocated_mb,
        ((df.bytes)-nvl(dfs.bytes,0))/1024/1024 used_mb,
        NVL ((dfs.bytes) / 1024 / 1024, 0) free_space_mb,
        round(  ((df.bytes-nvl(dfs.bytes,0))/df.bytes * 100),2) percent_used
FROM    ( select sum(bytes) bytes,tablespace_name from dba_data_files group by tablespace_name) df,
        ( select  sum(bytes) bytes , tablespace_name from dba_free_space group by tablespace_name) dfs
WHERE   df.tablespace_name = dfs.tablespace_name
and df.tablespace_name like '%&1%';


=============================  ALL table space including temp =============


select b.tablespace_name, tbs_size SizeMb, a.free_space FreeMb
from 
(select tablespace_name, round(sum(bytes)/1024/1024 ,2) as free_space 
from dba_free_space group by tablespace_name) a, 
(select tablespace_name, sum(bytes)/1024/1024 as tbs_size 
from dba_data_files group by tablespace_name
UNION
select tablespace_name, sum(bytes)/1024/1024 tbs_size
from dba_temp_files
group by tablespace_name ) b
where a.tablespace_name(+)=b.tablespace_name;


========================================ALL TBLSPC==============================

set pages 999
set linesize 150
col tablespace_name format a40
col "size MB" format 999,999,999
col "free MB" format 99,999,999
col "% Used" format 999disk_

SELECT  SUBSTR(df.tablespace_name,1,20) tablespace_name,
        (df.bytes) / 1024 / 1024 allocated_mb,
        ((df.bytes)-nvl(dfs.bytes,0))/1024/1024 used_mb,
        NVL ((dfs.bytes) / 1024 / 1024, 0) free_space_mb,
        round(  ((df.bytes-nvl(dfs.bytes,0))/df.bytes * 100),2) percent_used
FROM    ( select sum(bytes) bytes,tablespace_name from dba_data_files group by tablespace_name) df,
        ( select  sum(bytes) bytes , tablespace_name from dba_free_space group by tablespace_name) dfs
WHERE   df.tablespace_name = dfs.tablespace_name
ORDER BY percent_used ;


========================================TEMP TBLSPC==============================

SELECT A.tablespace_name tablespace, D.mb_total,
SUM (A.used_blocks * D.block_size) / 1024 / 1024 mb_used,
D.mb_total - SUM (A.used_blocks * D.block_size) / 1024 / 1024 mb_free
FROM v$sort_segment A,
(
SELECT B.name, C.block_size, SUM (C.bytes) / 1024 / 1024 mb_total
FROM v$tablespace B, v$tempfile C
WHERE B.ts#= C.ts#
GROUP BY B.name, C.block_size
) D
WHERE A.tablespace_name = D.name
GROUP by A.tablespace_name, D.mb_total;


=========================================
COLUMN property_name FORMAT A30
COLUMN property_value FORMAT A30
COLUMN description FORMAT A50
SET LINESIZE 200

SELECT *
FROM database_properties
WHERE property_name like '%TABLESPACE';
=====================================

select distinct substr(name, 1, instr(name, '/',-1)) PATH from v$datafile;
select distinct substr(member, 1, instr(member,'/',-1)) PATH from v$logfile;
select distinct substr(name, 1, instr(name,'/',-1)) PATH from v$controlfile;
select distinct substr(name, 1, instr(name, '/',-1)) PATH from v$tempfile; 


AUTO EXTENDED :
=========================
set pages 999
set linesize 150
col tablespace_name format a25
col file_name format a50
col AUTOEXTENSIBLE format a15
col "MAXBYTES" format 9999999999999999
col "INCREMENT_BY" format 99,999,999

select tablespace_name, file_name ,AUTOEXTENSIBLE,MAXBYTES,INCREMENT_BY from dba_data_files order by 1,2;

#####################################################


set pages 9999
set linesize 150
col "FILE#" format 99999
col Name format a70
select FILE#,Name from v$datafile;

=======================================
DATAFILE:

set linesize 150
col TABLESPACE_NAME format a20
col FILE_NAME format a40
col PERCENT_USED format 999
SELECT  a.tablespace_name, a.file_name, a.bytes/1024/1024  allocated_bytes, 
b.free_bytes/1024/1024 free_bytes, 
round(  ((a.bytes/1024/1024-nvl(b.free_bytes/1024/1024,0))/(a.bytes/1024/1024) * 100),2) percent_used 
FROM  dba_data_files a,(SELECT file_id, SUM(bytes) free_bytes FROM dba_free_space b GROUP BY file_id) b 
WHERE a.file_id=b.file_id and a.tablespace_name like '%&1%';

Tablespace  Creation Scripts :
=========================

select 'create tablespace ' || df.tablespace_name || chr(10)
 || ' datafile ''' || df.file_name || ''' size ' || df.bytes 
 || decode(autoextensible,'N',null, chr(10) || ' autoextend on maxsize ' 
 || maxbytes) 
 || chr(10) 
 || 'default storage ( initial ' || initial_extent 
 || decode (next_extent, null, null, ' next ' || next_extent )
 || ' minextents ' || min_extents
 || ' maxextents ' ||  decode(max_extents,'2147483645','unlimited',max_extents) 
 || ') ;'
 from dba_data_files df, dba_tablespaces t
 where df.tablespace_name=t.tablespace_name 
/

###########################################################
set pages 999
set linesize 150
col NAME format a50
col VALUE format a50
select NAME,VALUE from v$parameter;

RENAME DATAFILE  :
===================================

select tablespace_name,status from dba_tablespaces order by   tablespace_name;

select tablespace_name,status from dba_tablespaces where  tablespace_name='&1'; 

set linesize 150
col TABLESPACE_NAME format a40
col FILE_NAME format a60
col PERCENT_USED format 999
SELECT  a.tablespace_name, a.file_name, a.bytes/1024/1024  allocated_bytes, 
b.free_bytes/1024/1024 free_bytes, 
round(  ((a.bytes/1024/1024-nvl(b.free_bytes/1024/1024,0))/(a.bytes/1024/1024) * 100),2) percent_used 
FROM  dba_data_files a,(SELECT file_id, SUM(bytes) free_bytes FROM dba_free_space b GROUP BY file_id) b 
WHERE a.file_id=b.file_id and a.tablespace_name like '%&1%';


select file_name,status from dba_data_files where file_id=8;


select file_id,file_name,bytes/1024/1024 "Size_MB" from dba_data_files order by TABLESPACE_NAME;


select file_id,file_name,bytes/1024/1024 "Size_MB" from dba_data_files where tablespace_name='&1';

( with down time):
------------------

shu immediate;

startup mount;

ASMCMD> cd +DG1/testdb/datafile

ASMCMD> ls -lt

ASMCMD> cp ‘TS1.256.739201677’ ‘/u01/datafiles/ts1.dbf’

SQL> alter database rename file ‘+DG1/testdb/datafile/TS1.256.739201677’ to ‘/u01/datafiles/ts1.dbf’;




SQL> alter database open;


SQL> select tablespace_name,status from dba_tablespaces where  tablespace_name=’TS1';


SQL> select file_name,status from dba_data_files where file_id=8;

+DATA7/pncccgws/datafile/sysaux.292.938587455

( without down time) :
-----------------------
SQL> alter tablespace ts1 offline;


rman target / nocatalog

RMAN>  copy datafile 8 to ‘/u01/datafiles/ts1.dbf’;


SQL> alter database rename file ‘+DG1/testdb/datafile/ts1.256.739204397’ to ‘/u01/datafiles/ts1.dbf’;



SQL> alter tablespace ts1 online;


SQL> select tablespace_name,status from dba_tablespaces where  tablespace_name='&1';



SQL> select file_name,status from dba_data_files where file_id=8;


===================================

CREATE PROFILE c##POC 
LIMIT PASSWORD_LIFE_TIME UNLIMITED 
PASSWORD_GRACE_TIME UNLIMITED 
PASSWORD_REUSE_TIME UNLIMITED 
PASSWORD_REUSE_MAX UNLIMITED 
FAILED_LOGIN_ATTEMPTS UNLIMITED 
PASSWORD_VERIFY_FUNCTION NULL
PASSWORD_LOCK_TIME UNLIMITED;



alter user C##DBMOTO profile c##POC;


------===================================


all table creation for an user :


set long 100000
set head off
set echo off
set pagesize 0
set verify off
set feedback off
spool create_table_2_2307.sql
SELECT OBJECT_TYPE, OBJECT_NAME,DBMS_METADATA.GET_DDL(OBJECT_TYPE, OBJECT_NAME, OWNER)
  FROM ALL_OBJECTS 
  WHERE (OWNER = 'GTS_ENTERPRISE') AND OBJECT_TYPE  IN('TABLE') ORDER BY OBJECT_TYPE, OBJECT_NAME;
spool off;
/

=================================

set long 100000
set head off
set echo off
set pagesize 0
set verify off
set feedback off
select dbms_metadata.get_ddl(object_type, object_name, owner)
from
(
    --Convert DBA_OBJECTS.OBJECT_TYPE to DBMS_METADATA object type:
    select
        owner,
        --Java object names may need to be converted with DBMS_JAVA.LONGNAME.
        --That code is not included since many database don't have Java installed.
        object_name,
        decode(object_type,
            'DATABASE LINK',      'DB_LINK',
            'JOB',                'PROCOBJ',
            'RULE SET',           'PROCOBJ',
            'RULE',               'PROCOBJ',
            'EVALUATION CONTEXT', 'PROCOBJ',
            'CREDENTIAL',         'PROCOBJ',
            'CHAIN',              'PROCOBJ',
            'PROGRAM',            'PROCOBJ',
            'PACKAGE',            'PACKAGE_SPEC',
            'PACKAGE BODY',       'PACKAGE_BODY',
            'TYPE',               'TYPE_SPEC',
            'TYPE BODY',          'TYPE_BODY',
            'MATERIALIZED VIEW',  'MATERIALIZED_VIEW',
            'QUEUE',              'AQ_QUEUE',
            'JAVA CLASS',         'JAVA_CLASS',
            'JAVA TYPE',          'JAVA_TYPE',
            'JAVA SOURCE',        'JAVA_SOURCE',
            'JAVA RESOURCE',      'JAVA_RESOURCE',
            'XML SCHEMA',         'XMLSCHEMA',
            object_type
        ) object_type
    from dba_objects 
    where owner in ('&1')
)
order by owner, object_type, object_name;

spool off



=============




=====================================================================
User creation scripts:
=====================
set pagesize 0
set escape on
select 'create user ' || U.username || ' identified ' || 
DECODE(password, 
      NULL, 'EXTERNALLY', 
      ' by values ' || '''' || password || ''''
      ) 
|| chr(10) ||
'default tablespace ' || default_tablespace || chr(10) ||
'temporary tablespace ' || temporary_Tablespace || chr(10) ||
' profile ' || profile || chr(10) ||
'quota ' ||
decode ( Q.max_bytes, -1, 'UNLIMITED', NULL, 'UNLIMITED', Q.max_bytes) ||
' on ' || default_tablespace || 
decode (account_status,'LOCKED', ' account lock',
			'EXPIRED', ' password expire',
			'EXPIRED \& LOCKED', ' account lock password expire',
			null)
||
';'
from dba_users U, dba_ts_quotas Q
-- Comment this clause out to include system & default users
where U.username not in ('ABC')
and U.username=Q.username(+) and U.default_tablespace=Q.tablespace_name(+)
;
set pagesize 100
set escape off


=================================


set long 300000 pages 0 lines 140

SELECT DBMS_METADATA.GET_DDL('TABLE','PROPERTY','BENTLEY') FROM DUAL;



select
'alter user "'||username||'" identified by values '''||extract(xmltype(dbms_metadata.get_xml('USER',username)),'//USER_T/PASSWORD/text()').getStringVal()||''';'  old_password
from
   dba_users
where
username = '&1';

B3ntleY3o!81



###############################################################################
ALL GRANTS AND PRIVILEGE FOR A USER :


SELECT LPAD(' ', 2*level) || granted_role "USER PRIVS"
FROM (
  SELECT NULL grantee,  username granted_role
  FROM dba_users
  WHERE username LIKE UPPER('%&uname%')
  UNION
  SELECT grantee, granted_role
  FROM dba_role_privs
  FROM dba_role_privs
  UNION
  SELECT grantee, privilege
  FROM dba_sys_privs)
START WITH grantee IS NULL
CONNECT BY grantee = prior granted_role;

############################################################

create user KTIS_Test identified by Welcome123
default tablespace USERS
temporary tablespace TEMP
 profile DEFAULT;
 
quota UNLIMITED on SYSAUX account lock password expire;


===================================================

mkdir /tmp/LinuxDVD
mount /oraback/rhel-server-6.3-x86_64-dvd.iso /tmp/LinuxDVD -o ro,loop -t iso9660
umount -t /oraback/rhel-server-5.8-x86_64-dvd.iso /tmp/LinuxDVD



tar -ztvf MIPROD_2052011.tar.gz 
tar -xzf MIPROD_2052011.tar.gz MIPROD_2052011.dmp


:%s/old-text/new-text/g


egrep '(JNJ_IRT63_PROD_COMM)' DAILY_BACKUP_20120406.rpt



tail /u01/app/oracle/admin/GEAGIPRD/bdump/alert_GEAGIPRD.log -n 1000 | grep ORA
tail /u01/app/oracle/admin/GEAGIPRD/bdump/alert_GEAGIPRD.log -n 1000 | grep redo011


egrep '(GE)' /oraback/bkpscript/cronjobdailyrun_for_rman_or_expdp_script.sh

egrep '(ASPENPHARMA|ORION_AGCAPTURE41_PROD)' /oraback/bkpscript/cronjobdailyrun_for_rman_or_expdp_script.sh

find /home/oracle/DAILY_BACKUP_LOG -type f -cmin -6000 -exec grep ORA- {} \;

find /u01/app/oracle/admin/GEAGIPRD/bdump/alert_GEAGIPRD.log -type f -cmin -100 -exec grep ORA- {} \;



#####################################################

TIME ZONE CHANGE :

mv /etc/localtime  /etc/localtime-old
cd /usr/share/zoneinfo/
ln -sf /usr/share/zoneinfo/EST5EDT /etc/localtime

vi /etc/sysconfig/clock

ZONE="Asia/Kolkata"   >  ZONE="America/Los_Angeles"

/sbin/hwclock --systohc

Copy tz.bash to server :
bash tz.bash

bash tz.bash -z 13:00 EDT
bash tz.bash -z 10:00 UTC
bash tz.bash -z 10:00 EDT


[root@ARISPRDDB005 ~]# bash tz.bash -z 13:00 IST
Mon Oct 15 03:30:00 EDT 2012
[root@ARISPRDDB005 ~]# bash tz.bash -z 14:00 IST
Mon Oct 15 04:30:00 EDT 2012
[root@ARISPRDDB005 ~]# bash tz.bash -z 15:00 IST
Mon Oct 15 05:30:00 EDT 2012
[root@ARISPRDDB005 ~]#

########################################################

FULL=N 
IGNORE=Y 
FILE=/oracle/kna/prd/export/oneprod/exp_oneprd_oneprd_01.dmp
LOG=/oracle/kna/prd/export/oneprod/imp_oneprd_oneprd_
FROM USER=ISDBA,ONEPRD,RAFAEL_RODRIGUES,SCOTT,SISMON  
TOUSER=ISDBA,ONEPRD,RAFAEL_RODRIGUES,SCOTT,SISMON

imp \"/ as sysdba\" file=/oracle/kna/prd/export/oneprod/exp_oneprd_oneprd_01.dmp SQLFILE=/oracle/kna/prd/export/oneprod/imp_2601.sql 

create or replace directory migration as '/u01/app/oracle/admin/migration';

grant read,write on directory migration to public;


expdp  \"/ as sysdba\" DIRECTORY=migration  SCHEMAS=GTS_INFO_CONTRACT DUMPFILE=GTS_INFO_CONTRACT_GSPROD2_0407.dmp LOGFILE=GTS_INFO_CONTRACT_GSPROD2_0407.log

expdate=`date '+%d%m%Y'`
dat=`date '+%m%d%y %H:%M:%S'`

expdp SEIKAGAKU_ARISG65_VAL/SEIKAGAKU_ARISG65_VAL@AGEUVLDB DIRECTORY=DATA_PUMP_DIR DUMPFILE=AGEUVLDB_SEIKAGAKU_ARISG65_VAL_$expdate.dmp LOGFILE=AGEUVLDB_SEIKAGAKU_ARISG65_VAL_$expdate.log exclude=statistics
expdp SEIKAGAKU_CCM65_VAL/SEIKAGAKU_CCM65_VAL@AGEUVLDB DIRECTORY=DATA_PUMP_DIR DUMPFILE=AGEUVLDB_SEIKAGAKU_CCM65_VAL_$expdate.dmp LOGFILE=AGEUVLDB_SEIKAGAKU_CCM65_VAL_$expdate.log exclude=statistics


expdp VERIUS_AG631007_PROD/VERIUS_AG631007_PROD@AGEUPRDB schemas=VERIUS_AG631007_PROD DIRECTORY=DATA_PUMP_DIR DUMPFILE=AGEUPRDB_VERIUS_AG631007_PROD_06092012.dmp LOGFILE=AGEUPRDB_VERIUS_AG631007_PROD_06092012.log EXCLUDE=TABLE:"IN('ARIS_DOCUMENT_FILE')"

expdp VERIUS_AG631007_PROD/VERIUS_AG631007_PROD@AGEUPRDB DIRECTORY=DATA_PUMP_DIR DUMPFILE=AGEUPRDB_VERIUS_AG631007_PROD_TBL_06092012.dmp LOGFILE=AGEUPRDB_VERIUS_AG631007_PROD_TBL_06092012.log TABLES=ARIS_DOCUMENT_FILE

expdp VERIUS_AG631007_PROD/VERIUS_AG631007_PROD@AGEUPRDB DIRECTORY=DATA_PUMP_DIR DUMPFILE=AGEUPRDB_VERIUS_ARIS_DOCUMENT_FILE_06092012.dmp LOGFILE=AGEUPRDB_VERIUS_ARIS_DOCUMENT_FILE_06092012.log TABLES=ARIS_DOCUMENT_FILE content=metadata_only

expdate=`date '+%d%m%Y'`
dat=`date '+%m%d%y %H:%M:%S'`

expdp \'sys/sys as sysdba\' DIRECTORY=EXPORT_BKP ESTIMATE_ONLY=Y SCHEMAS=ORAWEB

expdp PPDI_AG65_SANDBOX03/PPDI_AG65_SANDBOX03@AGEUSNDB DIRECTORY=BACKUP DUMPFILE=PPDI_AG65_SANDBOX03_$expdate.dmp LOGFILE=PPDI_AG65_SANDBOX03_expdp_$expdate.log 
expdp JNJ_ADHOC_REPORT/JNJ_ADHOC_REPORT@JJIRTDRS ESTIMATE_ONLY=Y

expdp JNJ_IRT63_PROD/JNJ_IRT63_PROD@JJIRTPRD DIRECTORY=DUMPBKP DUMPFILE=JNJ_AG_AT_TRAIL_table_$expdate.dmp LOGFILE=JNJ_AG_AT_TRAIL_table_$expdate.log tables=AG_AT_TRAIL query=\"where fk_at_session_rec_id in '(select record_id from ag_at_session where trunc(date_time)= trunc(sysdate)-180)'\"

impdp system/manager@JJIRTDRs REMAP_SCHEMA=JNJ_IRT63_PROD:JNJ_ADHOC_REPORT REMAP_TABLESPACE=JNJ_IRT63_PROD:JNJ_IRT63_PROD DIRECTORY=BACKUP tables=AG_AT_TRAIL DUMPFILE=JNJ_AG_AT_TRAIL_table_$expdate.dmp LOGFILE=JNJ_AG_AT_TRAIL_table_impdp_$expdate.log  TABLE_EXISTS_ACTION=REPLACE
impdp system/manager@JJIRTDRs REMAP_SCHEMA=JNJ_IRT63_PROD:JNJ_ADHOC_REPORT REMAP_TABLESPACE=JNJ_IRT63_PROD:JNJ_IRT63_PROD DIRECTORY=BACKUP tables=AG_AT_TRAIL DUMPFILE=JNJ_AG_AT_TRAIL_table_$expdate.dmp LOGFILE=JNJ_AG_AT_TRAIL_table_impdp_$expdate.log  TABLE_EXISTS_ACTION=REPLACE

expdp \"/ as sysdba\" FILE=/oraback/dbbackup/dumpbkp/AUD_TABLE.dmp log=/oraback/dbbackup/dumpbkp/AUD_TABLE.log statistics=none tables=SYS.AUD$ 

COST_V_BUDGET_DETAILS_TAB
SUPPLIERS_SPEND_TAB


expdate=`date '+%d%m%Y'`
dat=`date '+%m%d%y %H:%M:%S'`
sh ALCONPRD_checklist.sh > /home/oracle/Checklist/DAILY_CHECKLIST.rpt

expdp AGINQ3013_NEW/AGINQ3013_NEW@TESTPRDB DIRECTORY=BACKUP DUMPFILE=AGINQ3013_NEW_$expdate.dmp logfile=AGINQ3013_NEW_EXPDP_$expdate.log exclude=statistics version=10.2

imp system/sainath6@EUDEVDB file=/oraback/dbbackup/dumpbackup/TRGORION08022012.DMP log=/oraback/dbbackup/dumpbackup/TRGORION08022012_imp.log show=y full=y

expdp ORION_AG631003_VAL/ORION_AG631003_VAL@sanddb DIRECTORY=EXP_SANDDB_DUMPS DUMPFILE=ORION_AG631003_VAL_18052011.dmp logfile=ORION_AG631003_VAL_18052011.log exclude=statistics

 expdp \'sys/sys as sysdba\' full=y DIRECTORY=DATA_PUMP_DIR JOB_NAME=test dumpfile=TEST_full_timestamp_%u.dmp logfile=TEST_full_timestamp_%u.log PARALLEL=8


 expdp full=y DIRECTORY=DATA_PUMP_DIR  dumpfile=.dmp logfile=.log 


 export NLS_LANG=AMERICAN_AMERICA.WE8ISO8859P1

 exp ENDO_AG622_PROD/ENDO_AG622_PROD@PROSVR1 file=/oraback/dbbackup/dumpbackup/ENDO_AG622_PROD_02042011_exp.dmp log=/oraback/dbbackup/dumpbackup/ENDO_AG622_PROD_02042011_exp.log statistics=none


imp \'sys/sys as sysdba\' full=y FILE=/u01/app/oracle/my_dir/TEST.dmp log=/u01/app/oracle/my_dir/TEST_imp.log ignore=y


imp system/manager@ASMDB file=/Extra/soft/aris.dmp sql=/Extra/soft/aris_exp_20032012.sql

expdp AGINQDOMPEBO/AGINQDOMPEBO@SANDDB DIRECTORY=exp_sanddb_dumps DUMPFILE=AGINQDOMPEBO_$expdate.dmp logfile=ESPRDTRS_$expdate.log

exp file=/oraback/dbbackup/dumpbackup/AGI_AGCAPTURE_POC2_exp_14062011.dmp log=/oraback/dbbackup/dumpbackup/AGI_AGCAPTURE_POC2_exp_14062011.log statistics=none

impdp system/sainathsainathsainath6@PROSVR1  tables=COMPANY_UNIT DIRECTORY=exp_poiprod_dumps  REMAP_SCHEMA=ORION_AG631003_VAL:ORION_AG631005_PROD REMAP_TABLESPACE=ORION_AG631003_VAL:ORION_AG631005_PROD DUMPFILE=ORION_AG631003_VAL_COMPANY_UNIT.dmp logfile=ORION_AG631003_VAL_COMPANY_UNIT_impdp.log exclude=statistics TABLE_EXISTS_ACTION=REPLACE

impdp system/manager@ORAPRD DIRECTORY=BACKUP DUMPFILE=POI_AG622_PROD_09022012.dmp SQLFILE=POI_AG622_PROD_09022012.sql

imp system/Oracle123@ONEPRD file=/oracle/kna/prd/export/oneprod/exp_oneprd_oneprd_01.dmp show=y log=/oracle/kna/prd/export/oneprod/imponeprd_2601.log show=y full=y

imp system/manager@TESTPRDB file=/oraback/datapump/POI_AG622_PROD_09022012.dmp log=/oraback/datapump/POI_AG622_PROD_09022012.log show=y full=y

imp system@AGIDEVDB file=/oraback/datapump/backup/MESOBLAST_AG631007_VAL_NORMAL_EXP_28062012.dmp log=/backup/MESOBLAST_AG631007_VAL_NORMAL_IMP_28062012.log fromuser=MESOBLAST_AG631007_VAL touser=MESOBLAST_AG631007_VAL buffer=100000000 statistics=none

select * from dba_directories;

expdate=`date '+%d%m%Y'`
dat=`date '+%m%d%y %H:%M:%S'`
expdp MESOBLAST_AG631007_VAL/MESOBLAST_AG631007_VAL@AGIDEVDB DIRECTORY=BACKUP DUMPFILE=MESOBLAST_AG631007_VAL_$expdate.dmp logfile=MESOBLAST_AG631007_VAL_$expdate.log exclude=statistics


sqlfile=/oraback/dbbackup/dumpbackup/aerspd_exp_28022012.sql

 impdp system/sainath6@DEVDB  DIRECTORY=BACKUP DUMPFILE=aresprd_Jul182011.dmp SQLFILE=aresprd_Jul182011.sql


imp system/sainath6@DEVDB file=/oraback/dbbackup/dumpbackup/aerspd.exp log=/oraback/dbbackup/dumpbackup/aerspd_exp_28022012.log show=y full=y




##############################################################################


# Do not remove the following line, or various programs
# that require network functionality will fail.
127.0.0.1               TARGET.localdomain TARGET localhost.localdomain localhost
::1             localhost6.localdomain6 localhost6

##############################################################################


select OBJECT_TYPE,count(*) from user_objects where status='INVALID'  group by OBJECT_TYPE;

SELECT object_type,object_name,status FROM dba_objects WHERE status='INVALID' ORDER BY object_type;

SELECT owner,object_type,object_name,status FROM   dba_objects WHERE  status = 'INVALID' ORDER BY object_name



select owner,
count(object_type) "count", object_type
from ALL_OBJECTS
where owner = 'DISIMP'
group by owner, object_type;



EXEC DBMS_UTILITY.compile_schema(schema => 'SISMON');

##############################################################################


DATABASE REGISTRY AND COMPONENT VERSION :


set pages 100
set lines 120
column COMP_NAME format a35
column VERSION format a20
SELECT r.comp_name, r.version, r.status FROM dba_registry r;



set lines 150
col action_time format a30
col action format a30
col version format a10
col comments format a30
col host_name format a10
col bundle_series format a5
col instance_name format a20
select host_name, v$instance.instance_name, action_time, action, comments from v$instance, registry$history order by 3; 


select 
length(addr)*4 || '-bits' word_length 
from
v$process 
where
ROWNUM =1;


 
select * from sys.registry$history;
 
SET linesize 200 pagesize 200
col action_time FOR a28
col version FOR a10
col comments FOR a35
col action FOR a25
col namespace FOR a12
SELECT * FROM registry$history;


####################################################################################
 
 
$ORACLE_HOME/OPatch/opatch lsinventory







####################################################################################
scp filename......... mallika@192.168.111.171:/home/mallika
P@ssw0rd
Tue 4/3/2012 5:49 PM


#################################################################

create tablespace TEST_AUDIT 
     datafile '/oradata/CELPRDDB/TEST_AUDIT.dbf' size 6G 
     reuse autoextend on 
     next 100M maxsize unlimited extent management local segment 
     space management auto;

create table TEST_AUDIT_TBL
     tablespace USERS
     storage (initial     25
     next       500k
     minextents    1
     maxextents   10)
     as SELECT * FROM SYS.AUD$ WHERE TIMESTAMP# BETWEEN TO_DATE('01-JUL-2012','DD-Mon-YYYY') AND TO_DATE('04-JUL-2012','DD-Mon-YYYY');



SELECT count(*) FROM SYS.AUD$ WHERE LOGOFF$TIME BETWEEN TO_DATE('01-JUL-2012','DD-Mon-YYYY') AND TO_DATE('02-JUL-2012','DD-Mon-YYYY');

SELECT count(*) FROM SYS.AUD$ WHERE LOGOFF$TIME BETWEEN TO_DATE('&1','DD-Mon-YYYY') AND TO_DATE('&2','DD-Mon-YYYY');



###################################################################

CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT   '/oraback/dbbackup/sandrmanbkp/datafiles/backup_db_%d_S_%s_P_%p_T_%t_C_%c';

run
{
backup as compressed backupset
incremental level=1
device type disk
tag "FRIDAY_INCREMENTAL_BACKUP"
database;
}

run
{
sql 'alter system archive log current'
report obsolete;
delete force noprompt obsolete;
backup database plus archivelog;
}

BACKUP AS COMPRESSED BACKUPSET FULL DATABASE PLUS ARCHIVELOG;
#################################################################################
---------------------------------
PURGE RECYCLEBIN
---------------------------------
SELECT count(OBJECT_NAME),TYPE from DBA_RECYCLEBIN WHERE OWNER='JNJ_ADHOC_REPORT' group by TYPE ;

select sum(space*8)/1024 space_in_MB from dba_recyclebin;

begin
for rec in (select owner,object_name,type from dba_recyclebin where owner='JNJ_ADHOC_REPORT') loop
execute immediate 'PURGE '||rec.type||' '||rec.owner||'.'||'"'||rec.object_name||'"';
end loop;
end;


select owner, object_name,type from dba_recyclebin where owner='JNJ_ADHOC_REPORT';

select count(*) from dba_recyclebin where owner='JNJ_ADHOC_REPORT';


==================================================================================================
DATAFILE

select ddf.file_name,ddf.TABLESPACE_NAME, sum(ddf.bytes)/1024/1024 total_M, sum(dfs.bytes)/1024/1024 free_M
from dba_free_space dfs, dba_data_Files ddf
where dfs.TABLESPACE_NAME = ddf.TABLESPACE_NAME;
group by ddf.TABLESPACE_NAME;


SET lines 150
COL tablespace_name FORMAT a10;
COL file_name FORMAT a20

SELECT Substr(df.tablespace_name,1,20) "Tablespace Name",
Substr(df.file_name,1,50) "File Name",
Round(df.bytes/1024/1024,2) "Size (M)",
Round(e.used_bytes/1024/1024,2) "Used (M)",
Round(f.free_bytes/1024/1024,2) "Free (M)",
Rpad(' '|| Rpad ('X',Round(e.used_bytes*10/df.bytes,2), 'X'),11,'-') "% Used"
FROM DBA_DATA_FILES DF,
(SELECT file_id,
Sum(Decode(bytes,NULL,0,bytes)) used_bytes
FROM dba_extents
GROUP by file_id) E,
(SELECT Max(bytes) free_bytes,
file_id
FROM dba_free_space
GROUP BY file_id) f
WHERE e.file_id (+) = df.file_id
AND df.file_id = f.file_id (+)
ORDER BY df.tablespace_name,
df.file_name
/

column file_name format a50;
column tablespace_name format a15;
column highwater format 9999999999;
set pagesize 9999

select a.tablespace_name
,a.file_name
,(b.maximum+c.blocks-1)*d.db_block_size highwater
from dba_data_files a
,(select file_id,max(block_id) maximum
from dba_extents
group by file_id) b
,dba_extents c
,(select value db_block_size
from v$parameter
where name='db_block_size') d
where a.file_id = b.file_id
and c.file_id = b.file_id
and c.block_id = b.maximum
order by a.tablespace_name,a.file_name
/

select d.tablespace_name, d.file_id, d.file_name, d.bytes allocated, nvl(f.bytes,0) free
from (select tablespace_name, file_id, file_name, sum(bytes) bytes from dba_data_files
group by tablespace_name, file_id, file_name) d,
(select tablespace_name, file_id, sum(bytes) bytes from dba_free_space
group by tablespace_name, file_id) f
where d.tablespace_name in ('SYSTEM','SYSAUX')
and d.tablespace_name = f.tablespace_name(+)
and d.file_id = f.file_id(+)
order by tablespace_name, file_id;

set linesize 150
col TABLESPACE_NAME format a20
col FILE_NAME format a40
col PERCENT_USED format 999
SELECT  a.tablespace_name, a.file_name, a.bytes/1024/1024  allocated_bytes, 
b.free_bytes/1024/1024 free_bytes, 
round(  ((a.bytes/1024/1024-nvl(b.free_bytes/1024/1024,0))/(a.bytes/1024/1024) * 100),2) percent_used 
FROM  dba_data_files a,(SELECT file_id, SUM(bytes) free_bytes FROM dba_free_space b GROUP BY file_id) b 
WHERE a.file_id=b.file_id and a.tablespace_name like '%&1%';



spool create_synonym.sql
select 'create synonym '||table_name ||' for '||table_name||'.SYSTEM' from user_tables ;
spool off 

select s.sid, s.serial#, s.username, s.program, spid  thread from v$session s, v$process p where addr = paddr and s.username is not null;

ORION_AGCAPTURE41_PROD - source 
agcap_prod_readuser 
r_stop_*

=================== USER ACCOUNT LOCK ===========================================================
select machine,program from v$session where username='PPDI_AG65_SANDBOX ';

select to_char(sysdate,'DD-MM-YYYY:HH24:MI:SS') from dual;

alter user VANILLA_AG631003_PROD account lock;

alter user VANILLA_ARISG65_VAL account unlock;

select to_char(lock_date,'DD-MM-YYYY:HH24:MI:SS')from dba_users where username='VANILLA_ARISG65_VAL';

select to_char(lock_date,'DD:MM:YYYY:HH24:MI:SS')from dba_users where username='&1';



select username,account_status from dba_users where username='&1' and lock_date is not null;



==================================================================================================


11G alert monitoring :

adrci

show alert

adrci

set home diag/rdbms/ageudemo/AGEUDEMO

show alert -tail -f

ALTER SYSTEM SET local_listener='(ADDRESS=(PROTOCOL=tcp)(HOST=arisdrdb001.navisite.net)(PORT=1521)) ' SCOPE=SPFILE;

SELECT COUNT(*) "ACTIVE USERS" FROM v_$session where username like '%DUKE%';


----------------------------------------------
To display yesterday's date :
expdate=`date --date="-1 day" '+%Y%m%d'`
dat=`date '+%m%y%d %H:%M:%S'`



cat /proc/sys/fs/file-nr


through root :
/sbin/service vncserver status
/sbin/service vncserver start
/sbin/service vncserver stop

through oracle :
vncserver
On VNC:
startkde
Pls!!rESETME
vncserver -kill:1


SELECT TABLE_NAME,COLUMN_NAME from USER_TAB_columnS WHERE column_NAME='AER_NO';

select a.value, s.username, s.sid, s.serial#
from v$sesstat a, v$statname b, v$session s
where a.statistic# = b.statistic#  and s.sid=a.sid
and b.name = 'opened cursors current';

ALTER USER OPTUM_ARISG_SANDBOX QUOTA 100M ON AG_INDEX;
ALTER USER OPTUM_ARISG_SANDBOX QUOTA 100M ON USERS;
ALTER USER OPTUM_ARISG_SANDBOX QUOTA 100M ON AG_DATA;


EXEC DBMS_STATS.gather_database_stats;

exec dbms_stats.gather_dictionary_stats;
exec dbms_stats.gather_fixed_objects_stats;
conn  JNJ_IRT63_PROD/JNJ_IRT63_PROD
select count(*) from JNJ_IRT63_PROD.agx_wf_notes;
insert into agx_wf_notes_temp select * from agx_wf_notes;
commit;
delete from agx_wf_notes;
commit;
select count(*) from JNJ_IRT63_PROD.agx_wf_notes;

------------------------------------------------------------------------------------------
alter session set "_HASH_JOIN_ENABLED"=TRUE;
SELECT  s.username,s.machine,s.terminal,s.program, a.sql_text,a.sql_id  FROM   v$session s, v$sqlarea a, v$process p
WHERE  s.sql_hash_value = a.hash_value
AND    s.sql_address    = a.address
AND    s.paddr          = p.addr
and  p.spid=&1;


######################################################
@?/rdbms/admin/awrrpt.sql
@?/rdbms/admin/awrsqrpt.sql
@?/rdbms/admin/addmrpt.sql
@$ORACLE_HOME/rdbms/admin/awrddrpt.sql

EXEC dbms_workload_repository.create_snapshot;
#######################################################

set lines 200
set lines 200
col SNAP_INTERVAL format a20
col RETENTION format a20
select * from dba_hist_wr_control;

exec dbms_workload_repository.modify_snapshot_settings(interval => 30, retention => 300)

#######################################################

select * from dba_directories;

SELECT sum(bytes)/1024/1024 "free space in MB" FROM dba_free_space;


select unique(tablespace_name) from user_tables;
select unique(tablespace_name) from user_indexes;       


==============================================================================
NLS:



select DECODE(parameter, 'NLS_CHARACTERSET', 'CHARACTER SET','NLS_LANGUAGE','LANGUAGE',
'NLS_TERRITORY', 'TERRITORY') name, value from v$nls_parameters WHERE parameter IN 
('NLS_CHARACTERSET', 'NLS_LANGUAGE', 'NLS_TERRITORY');


SELECT name, value$ from SYS.PROPS$ where name in ('NLS_CHARACTERSET', 'NLS_NCHAR_CHARACTERSET');


export NLS_LANG=AMERICAN_AMERICA.US7ASCII

ITSUSMPL00534

===========================================================================================================
SELECT ' alter index ' || index_name || ' rebuild ; ' FROM user_indexes where TABLE_OWNER='JNJ_IRT63_PROD';


select username, count(*) from v$session where status='ACTIVE' and username not in('SYSTEM','SYS') group by username;


select username, count(*) from v$session where status='INACTIVE' and username not in('SYSTEM','SYS') group by username;

set pages 999
select 	sess.username
,	sess.sid
,	sess.serial#
,	stat.value cursors
from	v$sesstat stat
,	v$statname sn
,	v$session sess
where	sess.username is not null
and	sess.sid = stat.sid
and	stat.statistic# = sn.statistic#
and	sn.name = 'opened cursors current'
and        sess.username='&1'
order by value
/

SELECT SID, Serial#, UserName, Status, SchemaName, Logon_Time
FROM V$Session
WHERE
Status=‘ACTIVE’ AND
UserName IS NOT NULL;

SELECT NAME, SUM(BYTES) FROM V$SGASTAT WHERE POOL='SHARED POOL' GROUP BY ROLLUP (NAME);

SELECT NAME, SUM(BYTES) FROM V$SGASTAT WHERE POOL='streams pool' GROUP BY ROLLUP (NAME);

SELECT sum(bytes), pool
FROM v$sgastat
GROUP BY pool
/ 

alter system set streams_pool_size = 50M scope = both ; 

col OWNER_NAME format a30
col JOB_NAME format a30
col OPERATION format a20
col JOB_MODE format a20
col STATE format a20
select OWNER_NAME,JOB_NAME,OPERATION,JOB_MODE,STATE from dba_datapump_jobs where OWNER_NAME='&1';

SET lines 200
COL owner_name FORMAT a10;
COL job_name FORMAT a20
COL state FORMAT a11
COL operation LIKE state
COL job_mode LIKE state

-- locate Data Pump jobs:

SELECT owner_name, job_name, operation, job_mode,
state, attached_sessions
FROM dba_datapump_jobs
WHERE job_name NOT LIKE 'BIN$%' and OWNER_NAME='MESOBLAST_AG631007_VAL' and state<>'NOT RUNNING'
ORDER BY 1,2;



SET serveroutput on
SET lines 100
DECLARE
   h1 NUMBER;
BEGIN
  -- Format: DBMS_DATAPUMP.ATTACH('[job_name]','[owner_name]');
   h1:=DBMS_DATAPUMP.ATTACH('SYS_EXPORT_SCHEMA_02','BESINS_AG631004_VAL');
   DBMS_DATAPUMP.STOP_JOB (h1,1,0);
END;
/

or 

drop table MESOBLAST_AG631007_VAL.SYS_EXPORT_SCHEMA_01;
drop table MESOBLAST_AG631007_VAL.SYS_EXPORT_SCHEMA_02;
drop table MESOBLAST_AG631007_VAL.SYS_EXPORT_SCHEMA_03;
drop table MESOBLAST_AG631007_VAL.SYS_EXPORT_SCHEMA_04;

SET serveroutput on 
SET lines 100 
DECLARE 
h1 NUMBER; 
BEGIN 
h1 := DBMS_DATAPUMP.ATTACH('SYS_EXPORT_SCHEMA_02','BESINS_AG631004_VAL'); 
DBMS_DATAPUMP.STOP_JOB (h1); 
END; 
/
SET serveroutput on 
SET lines 100 
DECLARE 
   h1 NUMBER; 
BEGIN 
   h1 := DBMS_DATAPUMP.ATTACH('SYS_EXPORT_SCHEMA_02','BESINS_AG631004_VAL'); 
   DBMS_DATAPUMP.STOP_JOB (h1); 
END; 
/

SELECT o.status, o.object_id, o.object_type, 
o.owner||'.'||object_name "OWNER.OBJECT" 
FROM dba_objects o, dba_datapump_jobs j 
WHERE o.owner=j.owner_name AND o.object_name=j.job_name 
AND j.job_name NOT LIKE 'BIN$%' ORDER BY 4,2;



====================================================
column  TABLESPACE_NAME format a40;
column  SEGMENT_TYPE  format a20;
set lines 200
set pages 250
select tablespace_name,segment_type,
count(segment_name) from dba_segments
group by tablespace_name, segment_type where tablespace_name = '&1' ;

select count(segment_name)
from dba_extents
where tablespace_name = '&1';

##############################################################

RMAN BACKUP SIZE:
-----------------------


select ctime "Date"
  , decode(backup_type, 'L' 'Archive Log', 'D', 'Full', 'Incremental') backup_type
 , bsize "Size GB"
   from (select trunc(bp.completion_time) ctime
  , backup_type
  , round(sum(bp.bytes/1024/1024/1024),2) bsize
   from v$backup_set bs, v$backup_piece bp
  where bs.set_stamp = bp.set_stamp
 and bs.set_count  = bp.set_count
 and bp.status = 'A'
 group by trunc(bp.completion_time), backup_type)
order by 1, 2;
==================================================
RMAN Progress

==================================================
REM RMAN Progress

set lines 300 pages 300
alter session set nls_date_format='dd/mm/yy hh24:mi:ss'
/
select SID, START_TIME,TOTALWORK, sofar, (sofar/totalwork) * 100 "Percentage Completed",
sysdate + TIME_REMAINING/3600/24 end_at
from v$session_longops
where totalwork > sofar
AND opname NOT LIKE '%aggregate%'
AND opname like 'RMAN%'
/


 allocate channel c5 type disk format '/u03/remprd/rmanbkp/INC_remprd_&1_%Y_&2_%T_&3_%U.bk';
 allocate channel c6 type disk format '/u03/remprd/rmanbkp/INC_remprd_&1_%Y_&2_%T_&3_%U.bk';
 allocate channel c7 type disk format '/u03/remprd/rmanbkp/INC_remprd_&1_%Y_&2_%T_&3_%U.bk';
 allocate channel c8 type disk format '/u03/remprd/rmanbkp/INC_remprd_&1_%Y_&2_%T_&3_%U.bk';


===================================================

column message format a80 
select message, timestamp 
from v$dataguard_status 
where severity in ('Error','Fatal') 
order by timestamp;

===============================
through root :
/sbin/service vncserver status
/sbin/service vncserver start

through oracle :
vncserver
On VNC:
startkde
================================
column message format a80 
select message, timestamp 
from v$dataguard_status 
where severity in ('Error','Fatal','ORA') 
order by timestamp;


drop user JNJ_IRT63_READ_USER cascade;
drop tablespace  AWARE0955_AG622_PROD_LOCAL including  contents and datafiles ;


CONFIGURE RETENTION POLICY TO REDUNDANCY 1;
CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 1 DAYS;

@?/rdbms/admin/awrrpt.sql
@?/rdbms/admin/awrsqrpt.sql
@?/rdbms/admin/addmrpt.sql
@$ORACLE_HOME/rdbms/admin/awrddrpt.sql

EXEC dbms_workload_repository.create_snapshot;

@/u01/app/oracle/product/10.2.0/db_1/ctx/admin/defaults/dr0defin.sql



BACKUP AS COMPRESSED BACKUPSET FULL DATABASE PLUS ARCHIVELOG;

select count(*) from v$session where STATUS='INACTIVE';

select owner,count(*) from dba_segments where tablespace_name='&1' group by owner;

select username,created from dba_users order by created;

crosscheck backup completed before 'sysdate-3';

crosscheck archivelog all;

delete backup completed before 'sysdate-1';

delete archivelog all completed before 'sysdate-1';


delete force noprompt obsolete device type disk; [RMAN-06214: Datafile Copy ]

drop user NBI_AG631003_SANDBOX cascade;

drop tablespace AG_DAIICHI_US including Contents and Datafiles;

select OBJECT_TYPE,count(*) from user_objects where STATUS='INVALID' group by OBJECT_TYPE;

select OBJECT_TYPE,count(*) from dba_objects where STATUS='INVALID' group by OBJECT_TYPE;

------------------------------------------------------------------------------------------
alter session set "_HASH_JOIN_ENABLED"=TRUE;
SELECT  s.username,s.machine,s.terminal,s.program, a.sql_text  FROM   v$session s, v$sqlarea a, v$process p
WHERE  s.sql_hash_value = a.hash_value
AND    s.sql_address    = a.address
AND    s.paddr          = p.addr
and  p.spid=&1;

######################################################
HOW MANY ARCHIVELOG GENERATED PER DAY?
--------------------------------------
set pages 100
column DAY format a10;
SELECT A.*,
Round(A.Count#*B.AVG#/1024/1024/1024) Daily_Avg_GB
FROM(SELECT To_Char(First_Time,'YYYY-MM-DD') DAY,
Count(1) Count#,Min(RECID) Min#,Max(RECID) Max#
FROM v$log_history
GROUP BY To_Char(First_Time,'YYYY-MM-DD')
ORDER BY 1 DESC) A,
(SELECT Avg(BYTES) AVG#,Count(1) Count#,Max(BYTES) Max_Bytes,
Min(BYTES) Min_Bytes FROM v$log) B;

####################################################################


select OBJECT_TYPE,count(*) from user_objects where STATUS='INVALID' group by OBJECT_TYPE;


set lines 150
COLUMN TABLESPACE_NAME format a30;
COLUMN free_space_mb format 99999990.00;
COLUMN allocated_mb format 99999990.00;
COLUMN used_mb format 99999990.00;
COLUMN percent_used format 00.00;

SELECT  SUBSTR(df.tablespace_name,1,20) tablespace_name,
        (df.bytes) / 1024 / 1024 allocated_mb,
        ((df.bytes)-nvl(dfs.bytes,0))/1024/1024 used_mb,
        NVL ((dfs.bytes) / 1024 / 1024, 0) free_space_mb,
        round(  ((df.bytes-nvl(dfs.bytes,0))/df.bytes * 100),2) percent_used
FROM    ( select sum(bytes) bytes,tablespace_name from dba_data_files group by tablespace_name) df,
        ( select  sum(bytes) bytes , tablespace_name from dba_free_space group by tablespace_name) dfs
WHERE   df.tablespace_name = dfs.tablespace_name
and df.tablespace_name like '&1';



###########################################


SELECT TABLESPACE_NAME, STATUS, CONTENTS, SEGMENT_SPACE_MANAGEMENT FROM dba_tablespaces;

SELECT file_name FROM dba_data_files WHERE tablespace_name='&1';

SELECT FILE#, STATUS, ENABLED FROM  v$datafile;

##########################################
Tablespace with datafile :

-------------------------------


SET PAUSE ON
SET PAUSE 'Press Return to Continue'
SET PAGESIZE 60
SET LINESIZE 300
COLUMN "Tablespace Name" FORMAT 20
COLUMN "Data File Name " FORMAT A80
 
SELECT  Substr(df.tablespace_name,1,20) "Tablespace Name",
        Substr(df.file_name,1,80) " DataFile Name",
        Round(df.bytes/1024/1024,0) "Size (M)",
        decode(e.used_bytes,NULL,0,Round(e.used_bytes/1024/1024,0)) "Used (M)",
        decode(f.free_bytes,NULL,0,Round(f.free_bytes/1024/1024,0)) "Free (M)",
        decode(e.used_bytes,NULL,0,Round((e.used_bytes/df.bytes)*100,0)) "% Used"
FROM    DBA_DATA_FILES DF,
       (SELECT file_id,
               sum(bytes) used_bytes
        FROM dba_extents
        GROUP by file_id) E,
       (SELECT sum(bytes) free_bytes,
               file_id
        FROM dba_free_space
        GROUP BY file_id) f
WHERE    e.file_id (+) = df.file_id
AND      df.file_id  = f.file_id (+)
ORDER BY df.tablespace_name,
         df.file_name
/

====================================================


select object_type,count(*) from user_objects where status = 'INVALID' 
group by object_type;


select substr(owner,1,12) owner,
substr(object_name,1,30) object,
substr(object_type,1,30) type, status from
user_objects where status <> 'VALID';


select substr(object_name,1,30) object,
substr(object_type,1,30) type, status from
user_objects where status <> 'VALID';


SELECT SID, SERIAL# FROM V$SESSION WHERE PROGRAM LIKE 'exp%'; 
exec dbms_system.set_int_param_in_session( 120,12229,'db_file_multib
_read_count', 128);
exec dbms_system.set_bool_param_in_session( 120, 12229,'_serial_direct_read', true);

SELECT SUM(BYTES) FROM DBA_SEGMENTS WHERE SEGMENT_NAME = 'SYSTEM_AUDIT_TRAIL'
###############################################################################################

Long_running_operation_finding sql:


COLUMN sid FORMAT 999
COLUMN serial# FORMAT 9999999
COLUMN machine FORMAT A30
COLUMN progress_pct FORMAT 99999999.00
COLUMN elapsed FORMAT A10
COLUMN remaining FORMAT A10

SELECT s.sid,
       s.serial#,
       s.machine,
       TRUNC(sl.elapsed_seconds/60) || ':' || MOD(sl.elapsed_seconds,60) elapsed,
       TRUNC(sl.time_remaining/60) || ':' || MOD(sl.time_remaining,60) remaining,
       ROUND(sl.sofar/sl.totalwork*100, 2) progress_pct
FROM   v$session s,
       v$session_longops sl
WHERE  s.sid     = sl.sid
AND    s.serial# = sl.serial#;

######################################################

set linesize 120 
col opname format a20 
col target format a15 
col units format a10 
col time_remaining format 99990 heading Remaining[s] 
col bps format 9990.99 heading [Units/s] 
col fertig format 90.9900000 heading "complete[%]" 
select sid, 
       opname, 
       target, 
       sofar, 
       totalwork, 
       units, 
       (totalwork-sofar)/time_remaining bps, 
       time_remaining, 
       sofar/totalwork*100 fertig 
from   v$session_longops 
where  time_remaining > 0 and sid='&1'
/ 



COLUMN USERNAME FORMAT a20
COLUMN %DONE FORMAT a20
COLUMN Remaining[s] FORMAT A10
COLUMN remaining FORMAT A10

SELECT b.username, a.sid, b.opname, b.target,
            round(b.SOFAR*100/b.TOTALWORK,0) || '%' as "%DONE", b.TIME_REMAINING,
            to_char(b.start_time,'YYYY/MM/DD HH24:MI:SS') start_time
     FROM v$session_longops b, v$session a
     WHERE a.sid = b.sid      ORDER BY 6;
 

 
 

SELECT sl.sid, sl.serial#, sl.sofar, sl.totalwork, dp.owner_name, dp.state, dp.job_mode
     FROM v$session_longops sl, v$datapump_job dp
     WHERE sl.opname = dp.job_name
     AND sl.sofar != sl.totalwork;
 




########################################################################


SELECT table_name, COUNT(*)  FROM chained_rows GROUP BY table_name ORDER BY table_name;

SELECT table_name, num_rows FROM user_tables WHERE table_name IN (SELECT UNIQUE table_name FROM chained_rows) ORDER BY table_name;
************************************************************************************************
set sqlprompt 'CSISDB>'

after backup need to run

/home/oracle/analyze_sun.sh
#################################################################################################
CISIS_ANALYZE:

exec dbms_stats.gather_schema_stats('JNJ_IRT63_PROD',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =>'FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 50);

#################################################################################################
GBM_ANALYZE:

exec dbms_stats.gather_schema_stats('GBMRPT',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =>'FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 20);

exec dbms_stats.gather_schema_stats('PERFSTAT',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =>'FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 20);

exec dbms_stats.gather_schema_stats('GBM',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =>'FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 20);

################################################################################################
 more gather_schema_stats.sql
exec dbms_stats.gather_schema_stats('GBMRPT',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =>'
FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 20);


select decode(db_stat_code,'C','ISOLOP COMPLETED','A','ABH STARTED','B','ABH COMPLETED','F','CSOLOP STARTED','G','CSOLOP COMPLETED') SOL_STATUS,count(*) from sol where sol_id in (select sol_id from sst where set_id='ALL')  and del_flg<>'Y' group by db_stat_code order by db_stat_code;


select init_sol_id,substr(sol_desc,1,20) sol_desc, 
count(dtd.tran_id) txn_count from dtd,dth,sol where dtd.tran_id=dth.tran_id
and sol.sol_id=dth.init_sol_id
and
pstd_flg<>'Y'
and dtd.del_flg<>'Y'
group by init_sol_id,sol_desc
order by count(dtd.tran_id);



exec dbms_stats.gather_schema_stats('PERFSTAT',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =
>'FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 20);




exec dbms_stats.gather_schema_stats('GBM',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =
>'FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 20);




*********************************************************************************************


@?/rdbms/admin/awrrpt.sql
@?/rdbms/admin/awrsqrpt.sql

@/u01/app/oracle/product/10.2.0/db_1/rdbms/admin/awrrpt.sql
@/u01/app/oracle/product/10.2.0/db_1/rdbms/admin/awrsqrpt.sql

#############################################################################################
select
   to_char(round(sub1.sample_time, 'HH24'), 'YYYY-MM-DD HH24:MI') as sample_hour,
   round(avg(sub1.on_cpu),1) as cpu_avg,
   round(avg(sub1.waiting),1) as wait_avg,
   round(avg(sub1.active_sessions),1) as act_avg,
   round( (variance(sub1.active_sessions)/avg(sub1.active_sessions)),1) as act_var_mean
from
   ( -- sub1: one row per ASH/AWR sample observation
     select
        sample_id,
        sample_time,
        sum(decode(session_state, 'ON CPU', 1, 0))  as on_cpu,
        sum(decode(session_state, 'WAITING', 1, 0)) as waiting,
        count(*) as active_sessions
     from
        dba_hist_active_sess_history
     where
        sample_time > sysdate - (&hours/24)
     group by
        sample_id,
        sample_time
   ) sub1
group by
   round(sub1.sample_time, 'HH24')
order by
   round(sub1.sample_time, 'HH24')
;
###################################################################################################





alter index TBAADM.IDX_MEMO_PAD_TABLE storage (maxextents 4000);




export ORACLE_SID=GBMUCO
tail -f /gbmora1/ora10g/OraHome1/rdbms/log/bdump/alert_GBMUCO.log

UCODB
=====================================================
SQL> alter user system
  2  identified by managerdb;

User altered.
=======================================================


 @?/rdbms/admin/awrddrpt.sql


column segment_name format a30
 

alter session set "_HASH_JOIN_ENABLED"=TRUE;

select  substr(ds.owner,1,10) owner, substr(ds.segment_name,1,30) segment_name , ds.max_extents, de.no_extents  no_extents_reached,  round(de.no_extents/ds.max_extents*100,2) no_extents_reached_pct
from    dba_segments ds,
(select count(1) no_extents, owner,segment_name from dba_extents where owner in ('CUSTOM','SISADM','TBAADM','GBM','MIGRATION') group by owner,segment_name ) de
where   de.segment_name = ds.segment_name and
        de.owner = ds.owner and
        de.owner in ('CUSTOM','SISADM','TBAADM','GBM','MIGRATION') and
        de.no_extents/ds.max_extents*100 > 75;



COLUMN used_pct format 00.00;
COLUMN OWNER format a10;
COLUMN SEQUENCE_NAME format a15;
COLUMN MAX_VALUE format 99999990 ;

select  substr(sequence_owner,1,10) owner, substr(sequence_name,1,30) sequence_name, max_value, last_number, round(last_number/max_value*100,2) used_pct,cycle_flag
from    dba_sequences
where   last_number/max_value*100 > 75;



COLUMN used_pct format 00.00;
select  CYCLE_FLAG,substr(sequence_owner,1,10) owner, substr(sequence_name,1,30) sequence_name,
max_value, last_number, round(last_number/max_value*100,2) used_pct
from    dba_sequences
where   last_number/max_value*100 > 75 AND CYCLE_FLAG='Y';

==================================================================================================UNDO TBLSPC
set lines 150
COLUMN TABLESPACE_NAME format a35;
COLUMN free_space_mb format 99999990.00;
COLUMN allocated_mb format 99999990.00;
COLUMN used_mb format 99999990.00;
COLUMN percent_used format 00.00;

SELECT  SUBSTR(df.tablespace_name,1,20) tablespace_name,
        (df.bytes) / 1024 / 1024 allocated_mb,
        ((df.bytes)-nvl(dfs.bytes,0))/1024/1024 used_mb,
        NVL ((dfs.bytes) / 1024 / 1024, 0) free_space_mb,
        round(  ((df.bytes-nvl(dfs.bytes,0))/df.bytes * 100),2) percent_used
FROM    ( select sum(bytes) bytes,tablespace_name from dba_data_files group by tablespace_name) df,
        ( select  sum(bytes) bytes , tablespace_name from dba_free_space group by tablespace_name) dfs
WHERE   df.tablespace_name = dfs.tablespace_name
and df.tablespace_name like '%&1%';
========================================TEMP TBLSPC==============================

SELECT A.tablespace_name tablespace, D.mb_total,
SUM (A.used_blocks * D.block_size) / 1024 / 1024 mb_used,
D.mb_total - SUM (A.used_blocks * D.block_size) / 1024 / 1024 mb_free
FROM v$sort_segment A,
(
SELECT B.name, C.block_size, SUM (C.bytes) / 1024 / 1024 mb_total
FROM v$tablespace B, v$tempfile C
WHERE B.ts#= C.ts#
GROUP BY B.name, C.block_size
) D
WHERE A.tablespace_name = D.name
GROUP by A.tablespace_name, D.mb_total; 

==============================================================

select sum(BYTES/1024/1024/1024) from sm$ts_avail;

select ts.name "Tablespace_Name",df.name "Datafile_Name",(df.bytes)/1024/1024 BYTES,df.CREATION_TIME 
from v$tablespace ts, v$datafile df
where ts.ts#=df.ts#
ORDER BY ts.name ;
========================================================================================================================
select sum(BYTES_FREE/1024/1024),TABLESPACE_NAME from V$TEMP_SPACE_HEADER
group by TABLESPACE_NAME;
========================================================================================================================
TABLESPACE:


column TABLESPACE_NAME format a20
set linesize 130
COLUMN free_space_mb format 99999990.00;
COLUMN allocated_mb format 99999990.00;
COLUMN used_mb format 99999990.00;
COLUMN percent_used format 00000.00;

set pages 999

set linesize 150
col tablespace_name format a40
col "size MB" format 999,999,999
col "free MB" format 99,999,999
col "% Used" format 999

SELECT  SUBSTR(df.tablespace_name,1,20) tablespace_name,
        (df.bytes) / 1024 / 1024 allocated_mb,
        ((df.bytes)-nvl(dfs.bytes,0))/1024/1024 used_mb,
        NVL ((dfs.bytes) / 1024 / 1024, 0) free_space_mb,
        round(  ((df.bytes-nvl(dfs.bytes,0))/df.bytes * 100),2) percent_used
FROM    ( select sum(bytes) bytes,tablespace_name from dba_data_files group by tablespace_name) df,
        ( select  sum(bytes) bytes , tablespace_name from dba_free_space group by tablespace_name) dfs
WHERE   df.tablespace_name = dfs.tablespace_name
ORDER BY percent_used ;

drop user JJVALDOC cascade;


expdp system@PDDB0226 DIRECTORY=EXPDP_DIR DUMPFILE=PDDB0226_FULL_07012013.dmp logfile=PDDB0226_FULL_07012013.log FULL=y



exp ORION_AGENCODER201_PROD/ORION_AGENCODER201_PROD@PROSVR1 file=/oraback/dbbackup/dumpbackup/ORION_AGENCODER201_PROD_Normal_EXP_21032012.dmp log=/oraback/dbbackup/dumpbackup/ORION_AGENCODER201_PROD_Normal_EXP_21032012.log statistics=none

delete archivelog all completed before 'sysdate -2';

column TABLESPACE_NAME format a20
column FILE_NAME format a60
select distinct (TABLESPACE_NAME),FILE_NAME from dba_data_files order by TABLESPACE_NAME;
===================================================================================================
TABLESPACE_NAME      FILE_NAME
-------------------- ------------------------------------------------------------
 Segments approaching  max extents

column segment_name format a30
 

alter session set "_HASH_JOIN_ENABLED"=TRUE;

select  substr(ds.owner,1,10) owner, substr(ds.segment_name,1,30) segment_name , ds.max_extents, de.no_extents  no_extents_reached,  round(de.no_extents/ds.max_extents*100,2) no_extents_reached_pct
from    dba_segments ds,
(select count(1) no_extents, owner,segment_name from dba_extents where owner in ('CUSTOM','SISADM','TBAADM','GBM','MIGRATION') group by owner,segment_name ) de
where   de.segment_name = ds.segment_name and
        de.owner = ds.owner and
        de.owner in ('CUSTOM','SISADM','TBAADM','GBM','MIGRATION') and
        de.no_extents/ds.max_extents*100 > 75;


 Objects that cannot extend (No space in Tablespace). 

column owner format a12    heading 'Owner'
column segment_name format a30    heading 'Object Name'
column segment_type format a15    heading 'Object Type'
column tablespace_name format a12    heading 'Tablespace'
column next_extent format 999,999,999 heading 'Next'
column max_free_space format 999,999,999 heading 'Max Free space'

select owner, segment_name, segment_type, tablespace_name, next_extent, 
(select max(sum(dfs.bytes))-100 bytes from dba_free_space dfs where dfs.tablespace_name = ds.tablespace_name group by dfs.file_id) max_free_space
from   dba_segments ds
where  next_extent > 
	(select max(sum(dfs.bytes))-100 bytes from dba_free_space dfs where dfs.tablespace_name = ds.tablespace_name group by dfs.file_id) ;


======================================
select  substr(ds.owner,1,10) owner, substr(ds.segment_name,1,30) segment_name , ds.max_extents, de.no_extents  no_extents_reached,  round(de.no_extents/ds.max_extents*100,2) no_extents_reached_pct
from    dba_segments ds,
        (select count(1) no_extents, owner,segment_name from dba_extents where owner in ('CUSTOM','TBAADM','PERFSTAT') group by owner,segment_name ) de
where   de.segment_name = ds.segment_name and
        de.owner = ds.owner and
        de.owner in ('CUSTOM','TBAADM','PERFSTAT') and
        de.no_extents/ds.max_extents*100 > 75;
==============================================
select  substr(ds.owner,1,10) owner, substr(ds.segment_name,1,30) segment_name , ds.max_extents, de.no_extents  no_extents_reached,  round(de.no_extents/ds.max_extents*100,2) no_extents_reached_pct
from    dba_segments ds,
        (select count(1) no_extents, owner,segment_name from dba_extents where owner in ('SISADM','TBAADM','PERFSTAT') group by owner,segment_name ) de
where   de.segment_name = ds.segment_name and
        de.owner = ds.owner and
        de.owner in ('SISADM','TBAADM','PERFSTAT') and
        de.no_extents/ds.max_extents*100 > 75;
========================================
select  substr(ds.owner,1,10) owner, substr(ds.segment_name,1,30) segment_name , ds.max_extents, de.no_extents  no_extents_reached,  round(de.no_extents/ds.max_extents*100,2) no_extents_reached_pct
from    dba_segments ds,
        (select count(1) no_extents, owner,segment_name from dba_extents where owner in ('GBM','PERFSTAT') group by owner,segment_name ) de
where   de.segment_name = ds.segment_name and
        de.owner = ds.owner and
        de.owner in ('GBM','PERFSTAT') and
        de.no_extents/ds.max_extents*100 > 75;



Sequences approaching MAX value

COLUMN used_pct format 00.00;
COLUMN OWNER format a10;
COLUMN SEQUENCE_NAME format a15;
COLUMN MAX_VALUE format 99999990 ;

select  substr(sequence_owner,1,10) owner, substr(sequence_name,1,30) sequence_name, max_value, last_number, round(last_number/max_value*100,2) used_pct,cycle_flag
from    dba_sequences
where   last_number/max_value*100 > 75;


@/csisora1/ora10g/OraHome1/rdbms/admin/awrrpt.sql

@/csisora1/ora10g/OraHome1/rdbms/admin/awrddrpt.sql

select name,open_mode,database_role from v$database;

select max(sequence#) from v$loghist;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=2;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=3;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=4;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=5;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=5;

Alter session set "_HASH_JOIN_EBABLED"=TRUE
select count(*) from v$session;

select max(sequence#) from v$loghist;

 select  max(SEQUENCE#) from v$archived_log where APPLIED='YES';

!bdf|grep arch





============================redo latch contention ==========================================
select name,(sum(misses)/(sum(gets)+sum(misses)))*100  from  v$latch l where name like '%redo%'
and gets<>0
group by name;


========================================log wait========================================================
select TOTAL_WAITS,TIME_WAITED,EVENT from
V$SYSTEM_EVENT
where EVENT like '%log%' order by TOTAL_WAITS;


select TABLESPACE_NAME,TOTAL_EXTENTS,USED_EXTENTS,TOTAL_BLOCKS,USED_BLOCKS,FREE_EXTENTS from v$sort_segment;

==================statspack=========================================================================


exec statspack.snap(i_snap_level => 7 )


start /cbsora/OraHome1/rdbms/admin/spreport.sql


To get Snap ID

select SNAP_ID, to_char(SNAP_TIME,'dd-mm-yyyy hh24:mi:ss') from STATS$SNAPSHOT order by snap_id  
         

Put hash value

start /cbsora/OraHome1/rdbms/admin/sprepsql.sql 









============PID=====================================================================================
==========================================
a=`ps -ef|grep -i oracleREPORT|awk '{print $2}'`
echo $a
kill -9 $a
==========================================


alter session set "_HASH_JOIN_ENABLED"=TRUE;

select process,PIECE,SQL_TEXT,VALUE cpu_usage 
from (select s.process,s.sid, p.spid PID,st. PIECE,st.SQL_TEXT      from v$session s , 
v$process p,v$sqltext st where s.PADDR (+) =P.ADDR and 
s.sql_address = st.address order by st.PIECE) sq, v$sesstat ss, v$statname sn 
where sq.sid=ss.sid and  
ss.STATISTIC# = sn.STATISTIC# and 
sn.NAME like '%CPU used by this session%' 
and sq.PID=&1



24510
alter session set "_HASH_JOIN_ENABLED"=TRUE;
SELECT  s.username,s.machine,s.terminal,s.program, a.sql_text  FROM   v$session s, v$sqlarea a, v$process p
WHERE  s.sql_hash_value = a.hash_value
AND    s.sql_address    = a.address
AND    s.paddr          = p.addr
and  p.spid=&1;

select  HASH_VALUE,SQL_TEXT from v$sqltext where HASH_VALUE = 


==================================================================================
select sid,serial#,username,process,machine,program
from v$session
where paddr=(select addr from v$process
where spid=&1);



select s.sid,s.serial#,p.spid os_pid,s.status,
s.osuser,s.username,s.COMMAND,s.MACHINE,s.MODULE, s.SCHEMANAME,
s.LOCKWAIT,s.action
from v$session s, v$process p
WHERE s.paddr = p.addr
and s.sid = 72;

22hgvsk417ggw
==============Explain Plan==========================================================================
explain plan for  

@$ORACLE_HOME/rdbms/admin/utlxpls.sql  

explain plan for select count(*) from emp;
select * from table(dbms_xplan.display);

select * from lgi where pid = 



===========SESSION================================================================================



select count(*) from v$session;


select machine,count(*) from v$session group by machine


SELECT file_name, tablespace_name,bytes/1024/1024 MB FROM dba_data_files where tablespace_name='EXAMPLE' ORDER BY tablespace_name, file_name;

===================================================================================================

@$ORACLE_HOME/rdbms/admin/awrrpt.sql


tail -f alert* |grep -i ora*


cat aler*|tail -500|grep ORA

==================================================================================================


select s.sid, s.serial#, s.status, p.spid from v$session s, v$process p where s.username = '&1' and p.addr (+) = s.paddr;




Kill all  Inactive sessions together 
------------------------------------------------------

select ses.USERNAME,
    substr(MACHINE,1,10) as MACHINE, 
    substr(module,1,25) as module,
    status, 
    'alter system kill session '''||SID||','||ses.SERIAL#||''';' as kill
from v$session ses LEFT OUTER JOIN v$process p ON (ses.paddr=p.addr)
where schemaname <> 'SYS'
    and not exists
    (select 1 
        from DBA_ROLE_PRIVS 
        where GRANTED_ROLE='DBA' 
            and schemaname=grantee)
    and machine!='DB-TEST-SERVER1' 
order by LAST_CALL_ET desc;


Locked Object


SELECT b.session_id AS sid, NVL(b.oracle_username, '(oracle)') AS username, a.owner AS object_owner,
 a.object_name,Decode(b.locked_mode, 0, 'None', 1, 'Null (NULL)', 2, 'Row-S (SS)',3, 'Row-X (SX)', 4, 
'Share (S)', 5, 'S/Row-X (SSX)',6, 'Exclusive (X)',       b.locked_mode) locked_mode, b.os_user_name
 FROM   dba_objects a,v$locked_object b WHERE  a.object_id = b.object_id  ORDER BY 1, 2, 3, 4; 


select status,to_char(logon_time,'dd-mm-yyyy hh24:mi:ss') from v$session where status='INACTIVE' order by LAST_CALL_ET desc

select SYNONYM_NAME,TABLE_NAME from dba_synonyms where SYNONYM_NAME='&1';

select SERIAL# , sid from v$session where sid=&1


alter system kill session '3838,1264';

-------------------------------------------------------------------------------------------------------
select status,to_char(logon_time,'dd-mm-yyyy hh24:mi:ss') from v$session 
where sid=&1

=====================================
select sid,serial#,username,process,machine,program
from v$session
where paddr=(select addr from v$process
where spid=&1);




col object_name format a30
col OWNER format a15
col ORACLE_USERNAME format a15
set lines 200
SELECT o.owner, o.object_name,to_char(o.last_ddl_time,'dd-mm-yyyy hh24:mi:ss'),
l.session_id, l.oracle_username, l.locked_mode
FROM dba_objects o, gv$locked_object l
WHERE o.object_id = l.object_id; and object_name='GE_AG631004_PROD';

===========================================================
col object_name format a30
col ORACLE_USERNAME format a30
col object_type format a20
col PROCESS format a20
set linesize 130
select b.OBJECT_name,b.object_type,l.SESSION_ID,l.ORACLE_USERNAME,l.PROCESS 
from v$locked_object l, dba_objects b
where l.object_id=b.object_id;


alter session set "_HASH_JOIN_ENABLED"=TRUE;


select session_id from v$locked_object,dba_objects where 
dba_objects.object_id=v$locked_object.object_id  and 
owner='GE_AG631004_PROD' order by session_id;


alter session set "_HASH_JOIN_ENABLED"=TRUE;

select session_id from v$locked_object,dba_objects where 
dba_objects.object_id=v$locked_object.object_id  and 
object_name='AGX_IRT_MESSAGE'
order by session_id;

172.19.252.165

alter session set "_HASH_JOIN_ENABLED"=TRUE;

select session_id from v$locked_object,dba_objects where 
dba_objects.object_id=v$locked_object.object_id  and 
object_name='GENERAL_ACCT_MAST_TABLE' 
order by session_id;

alter session set "_HASH_JOIN_ENABLED"=TRUE;

select session_id from v$locked_object,dba_objects where 
dba_objects.object_id=v$locked_object.object_id  and 
object_name='DD_CREDITS_TABLE'
order by session_id;

alter session set "_HASH_JOIN_ENABLED"=TRUE;

select session_id from v$locked_object,dba_objects where 
dba_objects.object_id=v$locked_object.object_id  and 
object_name='INVENTORY_MASTER_TABLE'
order by session_id;


alter session set "_HASH_JOIN_ENABLED"=TRUE;

select session_id from v$locked_object,dba_objects where 
dba_objects.object_id=v$locked_object.object_id  and 
object_name='LIM_HISTORY_TABLE'
order by session_id;


LHT LIM_HISTORY_TABLE

LHD

======================================================**** ???????????

select s.sid,s.serial#,l.pid,l.current_option_id,l.host_name
from v$session s,lgi l  
where to_number(l.pid)=to_number(s.process)
and l.host_name=s.machine
and s.sid=&sid;


If out put comes no row selected then we have to check program and machine name by using that sid. 


col program format a40
col machine format a20
select program,machine from v$session
where sid=&sid;


program should not be any ORACLE Background process and MACHIN should not be bcobdb02
then we could kill that session.


=====================================================***** ??????????

select sid,type,id1,id2 ,request,lmode from gv$lock
 where (type,id1,id2) in(select type,id1,id2
 from gv$lock
 where request<>0);


select SERIAL# , sid from v$session where sid=&1;


alter system kill session '

alter session set "_HASH_JOIN_ENABLED"=TRUE;

select sid,type,id1,id2 ,request,lmode from gv$lock
 where (type,id1,id2) in(select type,id1,id2
 from gv$lock
 where request<>0) 
and LMODE=6;



select object_name from dba_objects a,gv$locked_object b
where a.object_id=b.object_id and b.session_id=&1;



select sid,event,state,SECONDS_IN_WAIT,WAIT_TIME
from v$session_wait
where sid=&1;




select sid,process,machine from v$session
where sid=&1;


select current_option_id,host_name from lgi
where pid=&1;

select SERIAL#,sid from v$session where sid=&1;

select SERIAL#,sid from v$session where sid in(


select TERMINAL,PROGRAM,status,osuser,username,serial# from v$session
where sid=&1;

select ‘ALTER SYSTEM KILL SESSION ‘’’||a.sid||’,’||a.serial#||’’’;’ 
from v$session a,lock_tmp b
where a.sid =b.sid
and  (b.type,b.id1,b.id2) in(select type,id1,id2
 from lock_tmp
 where request<>0);

select * from v$session a,lock_tmp b
where a.sid =b.sid
and  (b.type,b.id1,b.id2) in(select type,id1,id2
 from lock_tmp
 where request<>0);


where object_id in(select object_id from v$locked_object
where session_id=&1)

============================================================================================
select USERNAME,ACCOUNT_STATUS from dba_users where ACCOUNT_STATUS like '%LOCKED%' and to_date(CREATED,'DD-MON-YY') > '16-NOV-06';



select count (*) from UET$;
select count (*) from FET$;
select count (*) from V$transaction;


startup nomount

startup mount

ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL;

alter database mount standby database;

##alter database recover managed standby database disconnect from session;

ALTER DATABASE RECOVER MANAGED STANDBY DATABASE NODELAY DISCONNECT FROM SESSION;

select name,open_mode from v$database;

=========================================================
scp 1_355[0-8]* 10.6.0.21:/oradata/PROSVR1/ARCH1/

recover standby database parallel 10;

=====================================================

select scn_to_timestamp(8673923411002) from dual;

run {
allocate channel c1 type disk format '/ora_gpos_adm/DR_Build_GC/B2BSTAGE/B2BSTAGE_inc/%U.rmb';
backup incremental from scn 8673923411002 database;
}

alter database create standby controlfile as '/ora_gpos_adm/DR_Build_GC/B2BSTAGE/B2BSTAGE_inc/TARGET_standstandby.ctl';


export ORACLE_SID=CSISDB
tail -f /csisora1/ora10g/OraHome1/rdbms/log/bdump/alert_CSISDB.log

ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL;


ALTER DATABASE RECOVER MANAGED STANDBY DATABASE DISCONNECT FROM SESSION;

alter system set standby_archive_dest='+FRA_ESPM/ESPM_SW1/ARCHIVELOG';


LOCATION=USE_DB_RECOVERY_FILE_DEST VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=ESPM_SW1


+FRA_ESPM/ESPM_SW1/ARCHIVELOG
**************************************************************************************
#alter database recover managed standby database disconnect from session;
lsnrctl start listener_dr_fin1
lsnrctl start listener_dr_fin2
**************************************************************************************


select name,open_mode,database_role from v$database;
select max(sequence#) from v$loghist;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=2;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=3;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=4;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=5;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=6;




export ORACLE_SID=UCODB
tail -f /cbsora1/ora10g/OraHome1/rdbms/log/bdump/alert_UCODB.log
UCODB_183428_1_593571575.ARC.gz

mput UCODB_17313*ARC.gz
UCODB_17312[5-9]*ARC.gz


lsnrctl set log_status off
mv listener.log listener.log_july
touch listener.log
lsnrctl set log_status on

alter database recover managed standby database disconnect from session;

#alter database recover automatic standby database;

recover cencel

select count(1) from v$transaction;

select count(1) from v$transaction;

select count(1),username from
v$session where paddr not in
(select addr from v$process
where background=1) and status='ACTIVE'
group by username;

only For sys user ther should be 1 login.
For other count should be zero.

else kill the active session for user other then tbagen(non system user).
For tbagen check entry in lgi and then kill the session

select sid,serial#,machine,process from v$session where username='MULTITEN_D' and status='ACTIVE';

select sid,serial#,machine,process from v$session where username='&1' and status='ACTIVE';

select spid from v$process where addr in (select paddr from v$session where sid in (4184,4468,4833,5210,5834,6418,10595,11126,13390,14266));


exp file=/home/oracle/gobin_10/DTH.dmp log=/home/oracle/gobin_10/DTH.log tables=TBAADM.DAILY_TRAN_HEADER_TABLE  buffer=1000000

ALTER SYSTEM SET log_archive_dest_state_2='ENABLE' SCOPE=BOTH;
ALTER SYSTEM SET log_archive_dest_state_3='ENABLE' SCOPE=BOTH;

ALTER SYSTEM SET log_archive_dest_state_2='DEFER' SCOPE=BOTH;
ALTER SYSTEM SET log_archive_dest_state_3='DEFER' SCOPE=BOTH;


UCODB_191694_1_593571575.ARC

UCODB_DR/UCODB_184975_1_593571575.ARC
UCODB_190239_1_593571575.ARC

select name,open_mode from v$database;
select max(sequence#) from v$loghist;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=2;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=3;

SELECT MAX(R.SEQUENCE#) LAST_SEQ_RECD, MAX(L.SEQUENCE#) LAST_SEQ_SENT FROM V$ARCHIVED_LOG R, V$LOG L WHERE R.DEST_ID=2 AND L.ARCHIVED='YES';

select PROCESS,STATUS,SEQUENCE#,blocks,block# from v$managed_standby;




find . -name "Arch*.bk" -mtime +7 -exec rm {} \;

select max(sequence#) from v$loghist where THREAD#=1;
select max(sequence#) from v$loghist where THREAD#=2;

###############################################################
set pages 100
set lines 120
column NAME format a35

select ts.name,df.name,df.bytes,df.CREATION_TIME 
from v$tablespace ts, v$datafile df 
where ts.ts#=df.ts#
and ts.name='&1' order by CREATION_TIME;

======================================================
set linesize 120
set pagesize 100
column Datafile_Name format a50
column Tablespace_Name format a15
column CREATION_TIME format a15
select ts.name "Tablespace_Name",df.name "Datafile_Name",df.bytes,df.CREATION_TIME
from v$tablespace ts, v$datafile df
where ts.ts#=df.ts#
and ts.name='&1' order by CREATION_TIME
/

alter tablespace RSS_INDX01
add datafile '/oradata/ESPRDTRS/datafile/RSS_INDX02.dbf' size 8G;


alter tablespace RSS_DATA01
add datafile '/oradata/ESPRDTRS/datafile/RSS_DATA03.dbf' size 10G;  



alter tablespace UNDOTBS1
add datafile '/u02/DEVBIBW/datafiles/undotbs01.dbf' size 20G;

alter database datafile '/oradata/GEAGIPRD/GE_AG631004_PROD_02.dbf' resize 2048m;



########################################################################################


grant update (HEALTH_CODE) on LAM to MIG_GROUP;

 grant tablespace unlimited to SS00041;
SS00041, SG00040, MB00039,


SQL> grant unlimited tablespace to SS00041;

Grant succeeded.

SQL> grant unlimited tablespace to SG00040;

Grant succeeded.

SQL> grant unlimited tablespace to MB00039;

Grant succeeded.

########################################################################################



select file#,name from v$datafile where to_char(CREATION_TIME,'mm')='03' 
select file# from v$datafile where to_char(CREATION_TIME,'mm/yy')='03/10' and name like '%IDX%';

select sum(bytes)/1024/1024/1024 from v$datafile where to_char(CREATION_TIME,'mm/yy')='04/10';

select sum(bytes)/1024/1024/1024 from v$datafile where to_char(CREATION_TIME,'mm/yy')='04/10' and name not like '%IDX%';

select sum(bytes)/1024/1024/1024 from v$datafile where to_char(CREATION_TIME,'mm/yy')='04/10' and name like '%IDX%';







##############################################################################

more data_delete.sh
----------------------------------------------------------
#!/bin/bash
while true
do
sqlplus "/ as sysdba" <<EOF
start /home/oracle/datadelete.sql
EOF
sleep 60
done
----------------------------------------------------------

 more data_delete_temp.sh
------------------------------------------------------------------
#!/bin/bash
while true
do
sqlplus "/ as sysdba" <<EOF
start /home/oracle/datadelete_temp.sql
EOF
sleep 10
done
---------------------------------------------------------------------
 more datadelete.sql
---------------------------------------------------------------------------------------------
conn  JNJ_IRT63_PROD/JNJ_IRT63_PROD
select count(*) from JNJ_IRT63_PROD.agx_wf_notes;
insert into agx_wf_notes_temp select * from agx_wf_notes;
commit;
delete from agx_wf_notes;
commit;
select count(*) from JNJ_IRT63_PROD.agx_wf_notes;
---------------------------------------------------------------------------------------------------
crontab -l
--------------------------------
00 19 * * * /oraback/bkpscript/daily_rman.sh (Daily 19 PM)
*/5 * * * * /home/oracle/OLD/data_delete_temp.sh         (Every 1minute)

===============================================================================

export :

#!/bin/bash
expdate=`date '+%d%m%Y'`
dat=`date '+%m%d%y %H:%M:%S'`
echo "Expdp Backup is started......." $dat
expdp VANILLA_CONTINEO254_VAL/VANILLA_CONTINEO254_VAL@SANDDB DIRECTORY=exp_sanddb_dumps DUMPFILE=VANILLA_CONTINEO254_VAL_$expdate.dmp logfile=VANILLA_CONTINEO254_VAL_$expdate.log exclude=statistics
expdp VANILLA_UC227_VAL/VANILLA_UC227_VAL@SANDDB DIRECTORY=exp_sanddb_dumps DUMPFILE=VANILLA_UC227_VAL_$expdate.dmp logfile=VANILLA_UC227_VAL_$expdate.log exclude=statistics	   
expdp VANILLA_CCM12115_VAL/VANILLA_CCM12115_VAL@SANDDB DIRECTORY=exp_sanddb_dumps DUMPFILE=VANILLA_CCM12115_VAL_$expdate.dmp logfile=VANILLA_CCM12115_VAL_$expdate.log exclude=statistics	   
expdp VANILLA_IRT631_VAL/VANILLA_IRT631_VAL@SANDDB DIRECTORY=exp_sanddb_dumps DUMPFILE=VANILLA_IRT631_VAL_$expdate.dmp logfile=VANILLA_IRT631_VAL_$expdate.log exclude=statistics
dat=`date '+%m%d%y %H:%M:%S'`
echo "Expdp Backup is Completed......." $dat
cd /oraback/dbbackup/dumpbackup/
tar -zcvf D_backup_before_drop_$expdate.tar.gz *_$expdate*

===================================================================================================
 dd if=/dev/zero of=/mnt/swapfile bs=1M count=16384
/sbin/mkswap /mnt/swapfile
/sbin/swapon -v /mnt/swapfile
/sbin/swapon -s


3aa3a41f-ad46-4ba6-ba40-e80df3dc01fa


=========

 dd if=/dev/zero of=/mnt/swapfile bs=1024 count=2097152
 allocate --length 2GiB /mnt/swapfile
 chmod 600 /mnt/swapfile
  mkswap /mnt/swapfile
 swapon /mnt/swapfile
 free -h

############################################################################################################
set folder=%date:~10,4%%date:~4,2%%date:~7,2%
cd E:\DAILY_BACKUP_LOG
md JJDRT_%folder%
E:\pscp.exe -pw Re5etmEPlz1! oracle@10.5.2.21:/home/oracle/DAILY_BACKUP_LOG/DAILY_BACKUP_%folder%.rpt E:\DAILY_BACKUP_LOG\JJDRT_%folder%
E:\pscp.exe -pw oracle123 oracle@192.168.58.123:/Extra/soft/README.html E:\FILE
----E:\pscp.exe -pw Re5etmEPlz1! oracle@10.1.2.21:/home/oracle/DAILY_BACKUP_LOG/DAILY_BACKUP_20111025.ta.gz E:\FILE



====================================================================================================

select 'create tablespace ' || df.tablespace_name || chr(10)
 || ' datafile ''' || df.file_name || ''' size ' || df.bytes 
 || decode(autoextensible,'N',null, chr(10) || ' autoextend on maxsize ' 
 || maxbytes) 
 || chr(10) 
 || 'default storage ( initial ' || initial_extent 
 || decode (next_extent, null, null, ' next ' || next_extent )
 || ' minextents ' || min_extents
 || ' maxextents ' ||  decode(max_extents,'2147483645','unlimited',max_extents) 
 || ') ;' "Script To Recreate Tablespaces"
 from dba_data_files df, dba_tablespaces t
 where df.tablespace_name=t.tablespace_name and t.tablespace_name='&1';


set pagesize 0
set heading off
set long 999999999
set feedback off
set echo off

SELECT DBMS_METADATA.GET_DDL('USER', '&1') FROM DUAL;
SELECT DBMS_METADATA.GET_GRANTED_DDL('SYSTEM_GRANT','&1') FROM DUAL;
SELECT DBMS_METADATA.GET_GRANTED_DDL( 'ROLE_GRANT','&1') FROM DUAL;
SELECT 'GRANT ' || PRIVILEGE || ' ON ' || OWNER || '.' || TABLE_NAME || ' TO ' || GRANTEE || ';' FROM DBA_TAB_PRIVS WHERE GRANTEE = '&1';
SELECT 'ALTER USER '||USERNAME||' QUOTA UNLIMITED ON '||TABLESPACE_NAME||';' FROM DBA_TS_QUOTAS WHERE USERNAME='&1';


===================================================================================================

select distinct prev_hash_value, count(*) from v$session where machine='arisjjprddb01' 
and username='JNJ_AG633_PROD' group by prev_hash_value 

select sql_text from v$sqltext where hash_value =899157561 order by hash_value,piece
select sql_text from v$sqltext where hash_value =2355232783 order by hash_value,piece
select sql_text from v$sqltext where hash_value =3222541686 order by hash_value,piece
select sql_text from v$sqltext where hash_value =373050687 order by hash_value,piece
select sql_text from v$sqltext where hash_value =2513676246 order by hash_value,piece

#####################################################

SQL TUNING 

#####################################################

@?/rdbms/admin/ashrpt.sql
@?/rdbms/admin/awrrpt.sql
@?/rdbms/admin/awrsqrpt.sql
@?/rdbms/admin/addmrpt.sql
@$ORACLE_HOME/rdbms/admin/awrddrpt.sql

====================================================

select b.sid, b.serial#, a.spid processid, b.process clientpid from v$process a, v$session b
where a.addr = b.paddr
and b.audsid = userenv('sessionid');



0qmkuwm7m0tdq

alter session set "_HASH_JOIN_ENABLED"=TRUE;
SELECT  s.username,s.machine,s.terminal,s.program, a.sql_text,a.sql_id  FROM   v$session s, v$sqlarea a, v$process p
WHERE  s.sql_hash_value = a.hash_value
AND    s.sql_address    = a.address
AND    s.paddr          = p.addr
and  p.spid=&1;



Chnge the Begin and End Snap value 
Also SQL ID
---------------------------------------
SET SERVEROUTPUT ON

-- Tuning task created for specific a statement from the AWR.
DECLARE
  l_sql_tune_task_id  VARCHAR2(100);
BEGIN
  l_sql_tune_task_id := DBMS_SQLTUNE.create_tuning_task (
                          sql_id      => '0qmkuwm7m0tdq',
                          scope       => DBMS_SQLTUNE.scope_comprehensive,
                          time_limit  => 3000,
                          task_name   => '0qmkuwm7m0tdq_AWR_tuning_task',
                          description => 'Tuning task for statement 0qmkuwm7m0tdq in AWR.');
  DBMS_OUTPUT.put_line('l_sql_tune_task_id: ' || l_sql_tune_task_id);
END;
/



EXEC DBMS_SQLTUNE.execute_tuning_task(task_name => '0qmkuwm7m0tdq_AWR_tuning_task');

spool 0qmkuwm7m0tdq_AWR_tuning_task.rpt
SET LONG 100000;
SET PAGESIZE 1000
SET LINESIZE 2000
SELECT DBMS_SQLTUNE.report_tuning_task('0qmkuwm7m0tdq_AWR_tuning_task') AS recommendations FROM dual;
SET PAGESIZE 24
spool off


exec DBMS_SQLTUNE.DROP_TUNING_TASK('0qmkuwm7m0tdq_AWR_tuning_task');


########################################################################################
execute dbms_sqltune.accept_sql_profile(task_name => '0qmkuwm7m0tdq_AWR_tuning_task', task_owner => 'SYS', replace => TRUE, profile_type => DBMS_SQLTUNE.PX_PROFILE);

		

SELECT * FROM TABLE(DBMS_SQLTUNE.SELECT_SQLSET(SQLSET_NAME => '0qmkuwm7m0tdq'));		
			
col category for a15
col sql_text for a70 trunc
select name, category, status, sql_text
from dba_sql_profiles
where name like nvl('&name',name)
order by last_modified
/

SYS_SQLPROF%



BEGIN
  DBMS_SQLTUNE.drop_sql_profile (
    name   => 'SYS_SQLPROF_014c4f0925c98001',
    ignore => TRUE);
END;
/


create index JNJ_IRT63_PROD.AGX_ACTIVITY_LOG_IDX on JNJ_IRT63_PROD.AGX_ACTIVITY_LOG('FK_RECORDID','LOG_TYPE')
  tablespace JNJ_IRT63_PROD
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    minextents 1
    maxextents unlimited
  );


############################################################################################
sftp:

oracle@sl07416:/oracle> sftp G19637@sl07113
The authenticity of host 'sl07113 (10.236.1.35)' can't be established.
ECDSA key fingerprint is 16:4b:52:ac:b1:d7:de:e1:89:79:0d:d7:5e:31:95:ab [MD5].
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'sl07113,10.236.1.35' (ECDSA) to the list of known hosts.
Password:
Connected to sl07113.
sftp> cd /oracle
sftp> mget 12.1.0.2.1.DB.tar.gz
Fetching /oracle/12.1.0.2.1.DB.tar.gz to 12.1.0.2.1.DB.tar.gz
/oracle/12.1.0.2.1.DB.tar.gz                                             100% 3424MB  83.5MB/s   00:41
sftp>
oracle@sl07416:/oracle>



###########################################################################


lsnrctl

set current_listener listener_orcl

set trc_level admin  /  set trc_level off /  set trc_level 10 / etc.....

save_config

-------------------------------------

http://www.cattsolutions.com/enable-admin-tracing-on-oracle-listener/

###########################################################################


Putty login
===========

@echo off
set /p servername= Server Name Please...
start C:\Users\G19636\Desktop\putty.exe  -ssh G19637@%servername% -pw Start123

with popup box:
================
@echo off
> usermessage.vbs ECHO WScript.Echo InputBox( "Put Server Name", "servername", "sample" )
FOR /F "tokens=*" %%A IN ('CSCRIPT.EXE //NoLogo usermessage.vbs') DO SET servername=%%A
ECHO Put Server Name in %servername%
DEL usermessage.vbs
start C:\Users\G19636\Desktop\putty.exe  -ssh G19637@%servername% -pw Start123



###########################################################################
COMPILE:
=============
select name,open_mode,database_role from v$database;

set pages 100
set lines 120
column OWNER format a35
column OBJECT_NAME format a40

select OWNER,OBJECT_NAME,PROCEDURE_NAME from dba_procedures where OWNER='DISIMP';

SELECT object_type,object_name,status FROM dba_objects WHERE OBJECT_NAME='UPD_INV_CUST2_PR';


SELECT object_type,object_name,status FROM dba_objects WHERE OBJECT_NAME like 'SCNP%' and object_type='PROCEDURE';

SELECT object_type,object_name,status FROM dba_objects WHERE OBJECT_NAME like '%OSP%' and object_type='PACKAGE';


select OBJECT_NAME
from all_objects
where object_type = 'PACKAGE BODY' and OWNER='DISIMP';

select OBJECT_NAME
from all_objects
where OWNER='DISIMP';

select owner,
count(object_type) "count", object_type
from ALL_OBJECTS
where owner = 'DISIMP'
group by owner, object_type;

select count (*), object_type from dba_objects where owner = 'DISIMP' group by object_type;


ALTER PROCEDURE DISIMP.UPD_INV_CUST2_PR COMPILE;


EXEC DBMS_DDL.alter_compile('PROCEDURE', 'DISIMP', 'UPD_INV_CUST2_PR');


COMPILE  Full Schema :
=====================

EXEC DBMS_UTILITY.compile_schema(schema => 'SCOTT');


###########################################################################


EXEC DBMS_STATS.gather_table_stats('SCOTT', 'EMPLOYEES', estimate_percent => 15, cascade => TRUE);


select sum(bytes)/1024/1024/1024 from dba_segments;
select sum(bytes)/1024/1024/1024 from dba_segments where OWNER='&1';

select username,default_tablespace from dba_users where username='&1';

Set user for cuee==rrent session :
==========================================
alter session set current_schema='&1';

select sys_context('USERENV','SESSION_USER') current_user,sys_context('USERENV','SESSION_SCHEMA') current_schema from dual;

FULL=N 
IGNORE=Y 
FILE=/oracle/kna/prd/export/oneprod/exp_oneprd_oneprd_01.dmp
LOG=/oracle/kna/prd/export/oneprod/imp_oneprd_oneprd_
FROM USER=ISDBA,ONEPRD,RAFAEL_RODRIGUES,SCOTT,SISMON  
TOUSER=ISDBA,ONEPRD,RAFAEL_RODRIGUES,SCOTT,SISMON

p98i0.world


set linesize 120
set pagesize 100
column username format a30
column created format a20

select username,created from dba_users order by created;


select username,created from dba_users where username like '%&1%' order by created;

execute dbms_stats.gather_schema_stats(ownname => 'AVUSER',estimate_percent => 50,DEGREE => 4,cascade => TRUE);


EXEC DBMS_STATS.gather_table_stats('SCPOMGR', 'PROCESSSKU', estimate_percent => 50, cascade => TRUE);

EXEC DBMS_STATS.gather_table_stats('SCPOMGR', 'PROCESSDFU', estimate_percent => 50, cascade => TRUE);


====================================================================
Redo Logs :

=======================

set linesize 200
set pagesize 1000
column member format a80

select group#,member from v$logfile;


select group#,bytes from v$LOG;

select group#,bytes from v$STANDBY_LOG;

select group#,member from v$logfile;


REDOLOG ADD / DELETE  (Normal) :
=================================


ALTER DATABASE ADD LOGFILE 
GROUP 5 ('/oracle/OASIST/recovery_area/OASIST/onlinelog/redo05.log') SIZE 500m,
GROUP 6 ('/oracle/OASIST/recovery_area/OASIST/onlinelog/redo06.log') SIZE 500m,
GROUP 7 ('/oracle/OASIST/recovery_area/OASIST/onlinelog/redo07.log') SIZE 500m;


alter system switch logfile;


alter system archive log all;


GROUP 2 ('/oracle/OASIST/recovery_area/OASIST/onlinelog/redo02.log') SIZE 100m,
GROUP 3 ('/oracle/OASIST/recovery_area/OASIST/onlinelog/redo03.log') SIZE 100m;


REDOLOG ADD / DELETE  (RAC) :
=================================
Check the REDOLOG status :

column REDOLOG_FILE_NAME format a50;
set lines 1000

SELECT a.GROUP#, a.THREAD#, a.SEQUENCE#,
a.ARCHIVED, a.STATUS, b.MEMBER AS REDOLOG_FILE_NAME,
(a.BYTES/1024/1024) AS SIZE_MB FROM v$log a
JOIN v$logfile b ON a.Group#=b.Group#
ORDER BY a.GROUP#;

Add group  as per existing / available :
------------------------------------------

ALTER DATABASE ADD LOGFILE THREAD 1
GROUP 1 ('+DATA7/pncccgws/redologs/redo01a.log','+DATA7/pncccgws/redologs/redo01b.log') SIZE 256m,
GROUP 2 ('+DATA7/pncccgws/redologs/redo02a.log','+DATA7/pncccgws/redologs/redo02b.log') SIZE 256m;


ALTER DATABASE ADD LOGFILE THREAD 2
GROUP 3 ('+DATA7/pncccgws/redologs/redo03a.log','+DATA7/pncccgws/redologs/redo03b.log') SIZE 256m,
GROUP 4 ('+DATA7/pncccgws/redologs/redo04a.log','+DATA7/pncccgws/redologs/redo04b.log') SIZE 256m;

Check the REDOLOG status :
-------------------------

While dropping redo log group status should be INACTIVE or UNUSED.

select group#,thread#,members,status from v$log;

Alter database drop logfile group 1;

====================================================================

IN GB
=======
set linesize 120
set pagesize 100
column DATAFILE format a50
column TABLESPACE format a20
column CREATION_TIME format a15
select ts.name "TABLESPACE",df.name "DATAFILE",(df.bytes)/1024/1024/1024 IN_GB,df.CREATION_TIME TIME
from v$tablespace ts, v$datafile df
where ts.ts#=df.ts#
and ts.name='&1' order by CREATION_TIME
/

IN MB
=======
set linesize 120
set pagesize 100
column DATAFILE format a50
column TABLESPACE format a20
column CREATION_TIME format a15
select ts.name "TABLESPACE",df.name "DATAFILE",(df.bytes)/1024/1024 IN_MB,df.CREATION_TIME TIME
from v$tablespace ts, v$datafile df
where ts.ts#=df.ts#
and ts.name='&1' order by CREATION_TIME
/

========================================SPC TBLSPC==============================

set lines 150
COLUMN TABLESPACE_NAME format a35;
COLUMN free_space_mb format 99999990.00;
COLUMN allocated_mb format 99999990.00;
COLUMN used_mb format 99999990.00;
COLUMN percent_used format 00.00;

SELECT  SUBSTR(df.tablespace_name,1,20) tablespace_name,
        (df.bytes) / 1024 / 1024 allocated_mb,
        ((df.bytes)-nvl(dfs.bytes,0))/1024/1024 used_mb,
        NVL ((dfs.bytes) / 1024 / 1024, 0) free_space_mb,
        round(  ((df.bytes-nvl(dfs.bytes,0))/df.bytes * 100),2) percent_used
FROM    ( select sum(bytes) bytes,tablespace_name from dba_data_files group by tablespace_name) df,
        ( select  sum(bytes) bytes , tablespace_name from dba_free_space group by tablespace_name) dfs
WHERE   df.tablespace_name = dfs.tablespace_name
and df.tablespace_name like '%&1%';


========================================ALL TBLSPC==============================

set pages 999

set linesize 150
col tablespace_name format a40
col "size MB" format 999,999,999
col "free MB" format 99,999,999
col "% Used" format 999

SELECT  SUBSTR(df.tablespace_name,1,20) tablespace_name,
        (df.bytes) / 1024 / 1024 allocated_mb,
        ((df.bytes)-nvl(dfs.bytes,0))/1024/1024 used_mb,
        NVL ((dfs.bytes) / 1024 / 1024, 0) free_space_mb,
        round(  ((df.bytes-nvl(dfs.bytes,0))/df.bytes * 100),2) percent_used
FROM    ( select sum(bytes) bytes,tablespace_name from dba_data_files group by tablespace_name) df,
        ( select  sum(bytes) bytes , tablespace_name from dba_free_space group by tablespace_name) dfs
WHERE   df.tablespace_name = dfs.tablespace_name
ORDER BY percent_used ;


========================================TEMP TBLSPC==============================

SELECT A.tablespace_name tablespace, D.mb_total,
SUM (A.used_blocks * D.block_size) / 1024 / 1024 mb_used,
D.mb_total - SUM (A.used_blocks * D.block_size) / 1024 / 1024 mb_free
FROM v$sort_segment A,
(
SELECT B.name, C.block_size, SUM (C.bytes) / 1024 / 1024 mb_total
FROM v$tablespace B, v$tempfile C
WHERE B.ts#= C.ts#
GROUP BY B.name, C.block_size
) D
WHERE A.tablespace_name = D.name
GROUP by A.tablespace_name, D.mb_total; 

AUTO EXTENDED :
=========================
set pages 999
set linesize 150
col tablespace_name format a25
col file_name format a50
col AUTOEXTENSIBLE format a15
col "MAXBYTES" format 9999999999999999
col "INCREMENT_BY" format 99,999,999

select tablespace_name, file_name ,AUTOEXTENSIBLE,MAXBYTES,INCREMENT_BY from dba_data_files order by 1,2;

#####################################################
DATAFILE:

set linesize 150
col TABLESPACE_NAME format a20
col FILE_NAME format a40
col PERCENT_USED format 999
SELECT  a.tablespace_name, a.file_name, a.bytes/1024/1024  allocated_bytes, 
b.free_bytes/1024/1024 free_bytes, 
round(  ((a.bytes/1024/1024-nvl(b.free_bytes/1024/1024,0))/(a.bytes/1024/1024) * 100),2) percent_used 
FROM  dba_data_files a,(SELECT file_id, SUM(bytes) free_bytes FROM dba_free_space b GROUP BY file_id) b 
WHERE a.file_id=b.file_id and a.tablespace_name like '%&1%';

Tablespace  Creation Scripts :
=========================

select 'create tablespace ' || df.tablespace_name || chr(10)
 || ' datafile ''' || df.file_name || ''' size ' || df.bytes 
 || decode(autoextensible,'N',null, chr(10) || ' autoextend on maxsize ' 
 || maxbytes) 
 || chr(10) 
 || 'default storage ( initial ' || initial_extent 
 || decode (next_extent, null, null, ' next ' || next_extent )
 || ' minextents ' || min_extents
 || ' maxextents ' ||  decode(max_extents,'2147483645','unlimited',max_extents) 
 || ') ;'
 from dba_data_files df, dba_tablespaces t
 where df.tablespace_name=t.tablespace_name 
/

###########################################################
set pages 999
set linesize 150
col NAME format a50
col VALUE format a50
select NAME,VALUE from v$parameter;

Save an Oracle user password  :
============================
select 
'alter user "'||username||'" identified by values '''||extract(xmltype(dbms_metadata.get_xml('USER',username)),'//USER_T/PASSWORD/text()').getStringVal()||''';'  old_password 
from 
   dba_users
where
username = '&1';


alter user OASIS identified by OASIS123;

connect OASIS/OASIS123;

Show user; 


alter user "FRED" identified by values '15EC3EC6EAF863C';

OASIS 

User creation scripts:
=====================
set pagesize 0
set escape on
select 'create user ' || U.username || ' identified ' || 
DECODE(password, 
      NULL, 'EXTERNALLY', 
      ' by values ' || '''' || password || ''''
      ) 
|| chr(10) ||
'default tablespace ' || default_tablespace || chr(10) ||
'temporary tablespace ' || temporary_Tablespace || chr(10) ||
' profile ' || profile || chr(10) ||
'quota ' ||
decode ( Q.max_bytes, -1, 'UNLIMITED', NULL, 'UNLIMITED', Q.max_bytes) ||
' on ' || default_tablespace || 
decode (account_status,'LOCKED', ' account lock',
			'EXPIRED', ' password expire',
			'EXPIRED \& LOCKED', ' account lock password expire',
			null)
||
';'
from dba_users U, dba_ts_quotas Q
-- Comment this clause out to include system & default users
where U.username not in ('ABC')
and U.username=Q.username(+) and U.default_tablespace=Q.tablespace_name(+)
;
set pagesize 100
set escape off

###############################################################################


SELECT LPAD(' ', 2*level) || granted_role "USER PRIVS"
FROM (
  SELECT NULL grantee,  username granted_role
  FROM dba_users
  WHERE username LIKE UPPER('%&uname%')
  UNION
  SELECT grantee, granted_role
  FROM dba_role_privs
  UNION
  SELECT grantee, privilege
  FROM dba_sys_privs)
START WITH grantee IS NULL
CONNECT BY grantee = prior granted_role;

Set pages 9990;
set long 900000; 
SELECT DBMS_METADATA.GET_GRANTED_DDL('ROLE_GRANT','LX_READONLY') from dual;
SELECT DBMS_METADATA.GET_GRANTED_DDL('OBJECT_GRANT','LX_READONLY') from dual;
SELECT DBMS_METADATA.GET_GRANTED_DDL('SYSTEM_GRANT','LX_READONLY') from dual;


GRANT EXECUTE ANY PROCEDURE TO "LX_DEVELOPER";
GRANT CREATE ANY PROCEDURE TO "LX_DEVELOPER";
GRANT DELETE ANY TABLE TO "LX_DEVELOPER";
GRANT UPDATE ANY TABLE TO "LX_DEVELOPER";
GRANT INSERT ANY TABLE TO "LX_DEVELOPER";
GRANT SELECT ANY TABLE TO "LX_DEVELOPER";
GRANT CREATE SESSION TO "LX_DEVELOPER";

=====================================================
select '(object priv) '||privilege||' on '||owner||'.'||table_name||decode(grantable,'YES',' WITH GRANT OPTION','') priv , 'Granted directly ' role_name from dba_tab_privs where grantee in (upper('admin')) 
union all 
select '(object priv) '||privilege||' on '||owner||'.'||table_name||decode(grantable,'YES',' WITH GRANT OPTION','') priv , grantee role_name from dba_tab_privs where grantee in (select granted_role from dba_role_privs start with grantee=upper('admin') connect by prior granted_role=grantee) 
union all 
select '(system priv) '||privilege priv , 'Granted directly' role_name from dba_sys_privs where grantee in (upper('admin')) 
union all 
select '(system priv) '||privilege priv , grantee role_name from dba_sys_privs where grantee in (select granted_role from dba_role_privs start with grantee=upper('admin') connect by prior granted_role=grantee) 
union all 
select '(role without privs)' priv, granted_role from (select granted_role from dba_role_privs start with grantee=upper('admin') connect by prior granted_role=grantee) where granted_role not in (select grantee from dba_tab_privs union all select grantee from dba_sys_privs) 
/


############################################################

mkdir /tmp/LinuxDVD
mount /oraback/rhel-server-6.3-x86_64-dvd.iso /tmp/LinuxDVD -o ro,loop -t iso9660
umount -t /oraback/rhel-server-5.8-x86_64-dvd.iso /tmp/LinuxDVD

#####################################################

Time Zone change :

mv /etc/localtime  /etc/localtime-old
cd /usr/share/zoneinfo/
ln -sf /usr/share/zoneinfo/EST5EDT /etc/localtime

vi /etc/sysconfig/clock

ZONE="Asia/Kolkata"   >  ZONE="America/Los_Angeles"

/sbin/hwclock --systohc

Copy tz.bash to server :
bash tz.bash

bash tz.bash -z 13:00 EDT
bash tz.bash -z 10:00 UTC
bash tz.bash -z 10:00 EDT


[root@ARISPRDDB005 ~]# bash tz.bash -z 13:00 IST
Mon Oct 15 03:30:00 EDT 2012
[root@ARISPRDDB005 ~]# bash tz.bash -z 14:00 IST
Mon Oct 15 04:30:00 EDT 2012
[root@ARISPRDDB005 ~]# bash tz.bash -z 15:00 IST
Mon Oct 15 05:30:00 EDT 2012
[root@ARISPRDDB005 ~]#

########################################################

imp \"/ as sysdba\" file=/oracle/kna/prd/export/oneprod/exp_oneprd_oneprd_01.dmp SQLFILE=/oracle/kna/prd/export/oneprod/imp_2601.sql 

create or replace directory MIGRATION as '/u02/EMREP_BKP';

grant read,write on directory MIGRATION to public;

expdp  \"/ as sysdba\" DIRECTORY=DEMODP1 DUMPFILE=EMREP_$expdate.dmp logfile=EMREP_$expdate.log full=y 

impdp \"/ as sysdba\" DIRECTORY=MIGRATION DUMPFILE=  logfile=MGMT_VIEW_impdp.log  SCHEMAS=MGMT_VIEW  TABLE_EXISTS_ACTION=REPLACE

expdate=`date '+%d%m%Y'`
dat=`date '+%m%d%y %H:%M:%S'`

expdp SEIKAGAKU_ARISG65_VAL/SEIKAGAKU_ARISG65_VAL@AGEUVLDB DIRECTORY=DATA_PUMP_DIR DUMPFILE=AGEUVLDB_SEIKAGAKU_ARISG65_VAL_$expdate.dmp LOGFILE=AGEUVLDB_SEIKAGAKU_ARISG65_VAL_$expdate.log exclude=statistics
expdp SEIKAGAKU_CCM65_VAL/SEIKAGAKU_CCM65_VAL@AGEUVLDB DIRECTORY=DATA_PUMP_DIR DUMPFILE=AGEUVLDB_SEIKAGAKU_CCM65_VAL_$expdate.dmp LOGFILE=AGEUVLDB_SEIKAGAKU_CCM65_VAL_$expdate.log exclude=statistics


expdp VERIUS_AG631007_PROD/VERIUS_AG631007_PROD@AGEUPRDB schemas=VERIUS_AG631007_PROD DIRECTORY=DATA_PUMP_DIR DUMPFILE=AGEUPRDB_VERIUS_AG631007_PROD_06092012.dmp LOGFILE=AGEUPRDB_VERIUS_AG631007_PROD_06092012.log EXCLUDE=TABLE:"IN('ARIS_DOCUMENT_FILE')"

expdp VERIUS_AG631007_PROD/VERIUS_AG631007_PROD@AGEUPRDB DIRECTORY=DATA_PUMP_DIR DUMPFILE=AGEUPRDB_VERIUS_AG631007_PROD_TBL_06092012.dmp LOGFILE=AGEUPRDB_VERIUS_AG631007_PROD_TBL_06092012.log TABLES=ARIS_DOCUMENT_FILE

expdp VERIUS_AG631007_PROD/VERIUS_AG631007_PROD@AGEUPRDB DIRECTORY=DATA_PUMP_DIR DUMPFILE=AGEUPRDB_VERIUS_ARIS_DOCUMENT_FILE_06092012.dmp LOGFILE=AGEUPRDB_VERIUS_ARIS_DOCUMENT_FILE_06092012.log TABLES=ARIS_DOCUMENT_FILE content=metadata_only

expdate=`date '+%d%m%Y'`
dat=`date '+%m%d%y %H:%M:%S'`

expdp PPDI_AG65_SANDBOX03/PPDI_AG65_SANDBOX03@AGEUSNDB DIRECTORY=BACKUP DUMPFILE=PPDI_AG65_SANDBOX03_$expdate.dmp LOGFILE=PPDI_AG65_SANDBOX03_expdp_$expdate.log 
expdp JNJ_ADHOC_REPORT/JNJ_ADHOC_REPORT@JJIRTDRS ESTIMATE_ONLY=Y

expdp JNJ_IRT63_PROD/JNJ_IRT63_PROD@JJIRTPRD DIRECTORY=DUMPBKP DUMPFILE=JNJ_AG_AT_TRAIL_table_$expdate.dmp LOGFILE=JNJ_AG_AT_TRAIL_table_$expdate.log tables=AG_AT_TRAIL query=\"where fk_at_session_rec_id in '(select record_id from ag_at_session where trunc(date_time)= trunc(sysdate)-180)'\"

impdp system/manager@JJIRTDRs REMAP_SCHEMA=JNJ_IRT63_PROD:JNJ_ADHOC_REPORT REMAP_TABLESPACE=JNJ_IRT63_PROD:JNJ_IRT63_PROD DIRECTORY=BACKUP tables=AG_AT_TRAIL DUMPFILE=JNJ_AG_AT_TRAIL_table_$expdate.dmp LOGFILE=JNJ_AG_AT_TRAIL_table_impdp_$expdate.log  TABLE_EXISTS_ACTION=REPLACE

expdp \"/ as sysdba\" FILE=/oraback/dbbackup/dumpbkp/AUD_TABLE.dmp log=/oraback/dbbackup/dumpbkp/AUD_TABLE.log statistics=none tables=SYS.AUD$ 


expdp \"/ as sysdba\"  DIRECTORY=BACKUP2018 DUMPFILE=B2BDEMO_ORAWEB.dmp LOGFILE=B2BDEMO_ORAWEB.log SCHEMAS=ORAWEB compression=all



expdate=`date '+%d%m%Y'`
dat=`date '+%m%d%y %H:%M:%S'`
sh ALCONPRD_checklist.sh > /home/oracle/Checklist/DAILY_CHECKLIST.rpt

expdp AGINQ3013_NEW/AGINQ3013_NEW@TESTPRDB DIRECTORY=BACKUP DUMPFILE=AGINQ3013_NEW_$expdate.dmp logfile=AGINQ3013_NEW_EXPDP_$expdate.log exclude=statistics version=10.2

imp system/sainath6@EUDEVDB file=/oraback/dbbackup/dumpbackup/TRGORION08022012.DMP log=/oraback/dbbackup/dumpbackup/TRGORION08022012_imp.log show=y full=y

ArisGlobal Software Pvt. Ltd., #19/2, 15th Cross, Dollars Colony, J.P.Nagar, 4th Phase. Bangalore 560 078, India. 


expdp ORION_AG631003_VAL/ORION_AG631003_VAL@sanddb DIRECTORY=EXP_SANDDB_DUMPS DUMPFILE=ORION_AG631003_VAL_18052011.dmp logfile=ORION_AG631003_VAL_18052011.log exclude=statistics

 expdp \'sys/sys as sysdba\' full=y DIRECTORY=DATA_PUMP_DIR JOB_NAME=test dumpfile=TEST_full_timestamp_%u.dmp logfile=TEST_full_timestamp_%u.log PARALLEL=8


 expdp full=y DIRECTORY=DATA_PUMP_DIR  dumpfile=
.dmp logfile=.log 

delete archivelog all completed before 'sysdate -2';

 export NLS_LANG=AMERICAN_AMERICA.WE8ISO8859P1

 exp ENDO_AG622_PROD/ENDO_AG622_PROD@PROSVR1 file=/oraback/dbbackup/dumpbackup/ENDO_AG622_PROD_02042011_exp.dmp log=/oraback/dbbackup/dumpbackup/ENDO_AG622_PROD_02042011_exp.log statistics=none


imp \'sys/sys as sysdba\' full=y FILE=/u01/app/oracle/my_dir/TEST.dmp log=/u01/app/oracle/my_dir/TEST_imp.log ignore=y

##############################################################################


# Do not remove the following line, or various programs
# that require network functionality will fail.
127.0.0.1               TARGET.localdomain TARGET localhost.localdomain localhost
::1             localhost6.localdomain6 localhost6

##############################################################################


select OBJECT_TYPE,count(*) from user_objects where status='INVALID'  group by OBJECT_TYPE;

SELECT object_type,object_name,status FROM dba_objects WHERE status='INVALID' ORDER BY object_type;

SELECT owner,object_type,object_name,status FROM   dba_objects WHERE  status = 'INVALID' ORDER BY object_name



select owner,
count(object_type) "count", object_type
from ALL_OBJECTS
where owner = 'DISIMP'
group by owner, object_type;



EXEC DBMS_UTILITY.compile_schema(schema => 'SISMON');

set pages 100
set lines 120
column COMP_NAME format a35
column VERSION format a20
SELECT r.comp_name, r.version, r.status FROM dba_registry r;



set lines 150
col action_time format a30
col action format a30
col version format a10
col comments format a30
col host_name format a10
col bundle_series format a5
col instance_name format a20
select host_name, v$instance.instance_name, action_time, action, comments from v$instance, registry$history order by 3; 



alter system set log_archive_dest_1='LOCATION=/oracle/kna/prd/oneprod/archiveredo' scope=spfile;



select 
length(addr)*4 || '-bits' word_length 
from
v$process 
where
ROWNUM =1;

####################################################################################
 
 
$ORACLE_HOME/OPatch/opatch lsinventory

 
select * from sys.registry$history;
 
SET linesize 200 pagesize 200
col action_time FOR a28
col version FOR a10
col comments FOR a35
col action FOR a25
col namespace FOR a12
SELECT * FROM registry$history;






####################################################################################
scp filename......... mallika@192.168.111.171:/home/mallika
P@ssw0rd
Tue 4/3/2012 5:49 PM


#################################################################

create tablespace TEST_AUDIT ;

     datafile '+DATA/DEVDB_IAD1X2/DATAFILE/users.274.1010777911' size 1G 
     reuse autoextend on 
     next 100M maxsize unlimited extent management local segment 
     space management auto;

create table TEST_AUDIT_TBL
     tablespace USERS
     storage (initial     25
     next       500k
     minextents    1
     maxextents   10)
     as SELECT * FROM SYS.AUD$ WHERE TIMESTAMP# BETWEEN TO_DATE('01-JUL-2012','DD-Mon-YYYY') AND TO_DATE('04-JUL-2012','DD-Mon-YYYY');



SELECT count(*) FROM SYS.AUD$ WHERE LOGOFF$TIME BETWEEN TO_DATE('01-JUL-2012','DD-Mon-YYYY') AND TO_DATE('02-JUL-2012','DD-Mon-YYYY');

SELECT count(*) FROM SYS.AUD$ WHERE LOGOFF$TIME BETWEEN TO_DATE('&1','DD-Mon-YYYY') AND TO_DATE('&2','DD-Mon-YYYY');



###################################################################

CONFIGURE CHANNEL DEVICE TYPE DISK FORMAT   '/oraback/dbbackup/sandrmanbkp/datafiles/backup_db_%d_S_%s_P_%p_T_%t_C_%c';

run
{
backup as compressed backupset
incremental level=1
device type disk
tag "FRIDAY_INCREMENTAL_BACKUP"
database;
}



egrep '(JNJ_IRT63_PROD_COMM)' DAILY_BACKUP_20120406.rpt



tail /u01/app/oracle/admin/GEAGIPRD/bdump/alert_GEAGIPRD.log -n 1000 | grep ORA
tail /u01/app/oracle/admin/GEAGIPRD/bdump/alert_GEAGIPRD.log -n 1000 | grep redo011


egrep '(GE)' /oraback/bkpscript/cronjobdailyrun_for_rman_or_expdp_script.sh

egrep '(ASPENPHARMA|ORION_AGCAPTURE41_PROD)' /oraback/bkpscript/cronjobdailyrun_for_rman_or_expdp_script.sh

find /home/oracle/DAILY_BACKUP_LOG -type f -cmin -6000 -exec grep ORA- {} \;

find /u01/app/oracle/admin/GEAGIPRD/bdump/alert_GEAGIPRD.log -type f -cmin -100 -exec grep ORA- {} \;


############################################################
Find and replace word in linux folder 
############################################################

find /home/oracle/scripts  -type f -exec sed -i.bak 's/sunprd/sundev/g' {} \;
find /home/oracle/scripts  -type f -name "*.bak" -exec rm -f {} \;
find /home/oracle/scripts  -type f -exec sed -i.bak 's/SUNPRD/SUNDEV/g' {} \;
find /home/oracle/scripts  -type f -name "*.bak" -exec rm -f {} \;


for file in *sunprd*
do
    mv -i "${file}" "${file/sunprd/sundev}"
done

egrep '(SUNPRD|sunprd)' *.cmd

egrep '(SUNDEV|sundev)' *.cmd


##############################################################



tar -ztvf MIPROD_2052011.tar.gz 
tar -xzf MIPROD_2052011.tar.gz MIPROD_2052011.dmp


Sanjose sFTP Server details 
IP address 10.5.18.101 
User Name database 
Password pass4db!
sftp database@10.5.18.101
password

put

:%s/old-text/new-text/g

===================
SFTP steps:
sftp akos@213.198.99.157
password - pass@akos1
put  
=======================
sftp database@10.5.18.101
password - pass@akos1
put  

#################################################################################
---------------------------------
Purge Recyclebin
---------------------------------
SELECT count(OBJECT_NAME),TYPE from DBA_RECYCLEBIN WHERE OWNER='JNJ_ADHOC_REPORT' group by TYPE ;

select sum(space*8)/1024 space_in_MB from dba_recyclebin;

begin
for rec in (select owner,object_name,type from dba_recyclebin where owner='JNJ_ADHOC_REPORT') loop
execute immediate 'PURGE '||rec.type||' '||rec.owner||'.'||'"'||rec.object_name||'"';
end loop;
end;


select owner, object_name,type from dba_recyclebin where owner='JNJ_ADHOC_REPORT';

select count(*) from dba_recyclebin where owner='JNJ_ADHOC_REPORT';


==================================================================================================
datafile

select ddf.file_name,ddf.TABLESPACE_NAME, sum(ddf.bytes)/1024/1024 total_M, sum(dfs.bytes)/1024/1024 free_M
from dba_free_space dfs, dba_data_Files ddf
where dfs.TABLESPACE_NAME = ddf.TABLESPACE_NAME;
group by ddf.TABLESPACE_NAME;


SET lines 150
COL tablespace_name FORMAT a10;
COL file_name FORMAT a20

SELECT Substr(df.tablespace_name,1,20) "Tablespace Name",
Substr(df.file_name,1,50) "File Name",
Round(df.bytes/1024/1024,2) "Size (M)",
Round(e.used_bytes/1024/1024,2) "Used (M)",
Round(f.free_bytes/1024/1024,2) "Free (M)",
Rpad(' '|| Rpad ('X',Round(e.used_bytes*10/df.bytes,2), 'X'),11,'-') "% Used"
FROM DBA_DATA_FILES DF,
(SELECT file_id,
Sum(Decode(bytes,NULL,0,bytes)) used_bytes
FROM dba_extents
GROUP by file_id) E,
(SELECT Max(bytes) free_bytes,
file_id
FROM dba_free_space
GROUP BY file_id) f
WHERE e.file_id (+) = df.file_id
AND df.file_id = f.file_id (+)
ORDER BY df.tablespace_name,
df.file_name
/

column file_name format a50;
column tablespace_name format a15;
column highwater format 9999999999;
set pagesize 9999

select a.tablespace_name
,a.file_name
,(b.maximum+c.blocks-1)*d.db_block_size highwater
from dba_data_files a
,(select file_id,max(block_id) maximum
from dba_extents
group by file_id) b
,dba_extents c
,(select value db_block_size
from v$parameter
where name='db_block_size') d
where a.file_id = b.file_id
and c.file_id = b.file_id
and c.block_id = b.maximum
order by a.tablespace_name,a.file_name
/

select d.tablespace_name, d.file_id, d.file_name, d.bytes allocated, nvl(f.bytes,0) free
from (select tablespace_name, file_id, file_name, sum(bytes) bytes from dba_data_files
group by tablespace_name, file_id, file_name) d,
(select tablespace_name, file_id, sum(bytes) bytes from dba_free_space
group by tablespace_name, file_id) f
where d.tablespace_name in ('SYSTEM','SYSAUX')
and d.tablespace_name = f.tablespace_name(+)
and d.file_id = f.file_id(+)
order by tablespace_name, file_id;

set linesize 150
col TABLESPACE_NAME format a20
col FILE_NAME format a40
col PERCENT_USED format 999
SELECT  a.tablespace_name, a.file_name, a.bytes/1024/1024  allocated_bytes, 
b.free_bytes/1024/1024 free_bytes, 
round(  ((a.bytes/1024/1024-nvl(b.free_bytes/1024/1024,0))/(a.bytes/1024/1024) * 100),2) percent_used 
FROM  dba_data_files a,(SELECT file_id, SUM(bytes) free_bytes FROM dba_free_space b GROUP BY file_id) b 
WHERE a.file_id=b.file_id and a.tablespace_name like '%&1%';



spool create_synonym.sql
select 'create synonym '||table_name ||' for '||table_name||'.SYSTEM' from user_tables ;
spool off 

select s.sid, s.serial#, s.username, s.program, spid  thread from v$session s, v$process p where addr = paddr and s.username is not null;

ORION_AGCAPTURE41_PROD - source 
agcap_prod_readuser 
r_stop_*

=================== USER ACCOUNT LOCK ===========================================================
select machine,program from v$session where username='PPDI_AG65_SANDBOX ';

select to_char(sysdate,'DD-MM-YYYY:HH24:MI:SS') from dual;

alter user VANILLA_AG631003_PROD account lock;

alter user VANILLA_ARISG65_VAL account unlock;

select to_char(lock_date,'DD-MM-YYYY:HH24:MI:SS')from dba_users where username='VANILLA_ARISG65_VAL';

select to_char(lock_date,'DD:MM:YYYY:HH24:MI:SS')from dba_users where username='&1';



select username,account_status from dba_users where username='&1' and lock_date is not null;


set pagesize 500
set linesize 200
set trimspool on
column "EXPIRE DATE" format a15

select username as "USER NAME", expiry_date as "EXPIRE DATE", account_status
from dba_users
where account_status IN ( 'OPEN', 'EXPIRED' )
order by account_status, expiry_date, username;


==================================================================================================


11G alert monitoring :

adrci

show alert

adrci

set home diag/rdbms/ageudemo/AGEUDEMO

show alert -tail -f

ALTER SYSTEM SET local_listener='(ADDRESS=(PROTOCOL=tcp)(HOST=x0579.srv.skf.net)(PORT=1422)) ' SCOPE=SPFILE;

SELECT COUNT(*) "ACTIVE USERS" FROM v_$session where username like '%DUKE%';


----------------------------------------------
To display yesterday's date :
expdate=`date --date="-1 day" '+%Y%m%d'`
dat=`date '+%m%y%d %H:%M:%S'`



cat /proc/sys/fs/file-nr


through root :
/sbin/service vncserver status
/sbin/service vncserver start
/sbin/service vncserver stop

through oracle :
vncserver
On VNC:
startkde
Pls!!rESETME
vncserver -kill:1


SELECT TABLE_NAME,COLUMN_NAME from USER_TAB_columnS WHERE column_NAME='AER_NO';

select a.value, s.username, s.sid, s.serial#
from v$sesstat a, v$statname b, v$session s
where a.statistic# = b.statistic#  and s.sid=a.sid
and b.name = 'opened cursors current';

ALTER USER OPTUM_ARISG_SANDBOX QUOTA 100M ON AG_INDEX;
ALTER USER OPTUM_ARISG_SANDBOX QUOTA 100M ON USERS;
ALTER USER OPTUM_ARISG_SANDBOX QUOTA 100M ON AG_DATA;

exec dbms_stats.gather_dictionary_stats;
exec dbms_stats.gather_fixed_objects_stats;
conn  JNJ_IRT63_PROD/JNJ_IRT63_PROD
select count(*) from JNJ_IRT63_PROD.agx_wf_notes;
insert into agx_wf_notes_temp select * from agx_wf_notes;
commit;
delete from agx_wf_notes;
commit;
select count(*) from JNJ_IRT63_PROD.agx_wf_notes;

------------------------------------------------------------------------------------------
alter session set "_HASH_JOIN_ENABLED"=TRUE;
SELECT  s.username,s.machine,s.terminal,s.program, a.sql_text,a.sql_id  FROM   v$session s, v$sqlarea a, v$process p
WHERE  s.sql_hash_value = a.hash_value
AND    s.sql_address    = a.address
AND    s.paddr          = p.addr
and  p.spid=&1;


######################################################
@?/rdbms/admin/awrrpt.sql
@?/rdbms/admin/awrsqrpt.sql
@?/rdbms/admin/addmrpt.sql
@$ORACLE_HOME/rdbms/admin/awrddrpt.sql

EXEC dbms_workload_repository.create_snapshot;
#######################################################


select * from dba_directories;

SELECT sum(bytes)/1024/1024 "free space in MB" FROM dba_free_space;


select unique(tablespace_name) from user_tables;
select unique(tablespace_name) from user_indexes;       


==============================================================================
NLS:



select DECODE(parameter, 'NLS_CHARACTERSET', 'CHARACTER SET','NLS_LANGUAGE','LANGUAGE',
'NLS_TERRITORY', 'TERRITORY') name, value from v$nls_parameters WHERE parameter IN 
('NLS_CHARACTERSET', 'NLS_LANGUAGE', 'NLS_TERRITORY');


SELECT name, value$ from SYS.PROPS$ where name in ('NLS_CHARACTERSET', 'NLS_NCHAR_CHARACTERSET');


export NLS_LANG=AMERICAN_AMERICA.US7ASCII

ITSUSMPL00534

===========================================================================================================
SELECT ' alter index ' || index_name || ' rebuild ; ' FROM user_indexes where TABLE_OWNER='JNJ_IRT63_PROD';


select username, count(*) from v$session where status='ACTIVE' and username not in('SYSTEM','SYS') group by username;


select username, count(*) from v$session where status='INACTIVE' and username not in('SYSTEM','SYS') group by username;

set pages 999
select 	sess.username
,	sess.sid
,	sess.serial#
,	stat.value cursors
from	v$sesstat stat
,	v$statname sn
,	v$session sess
where	sess.username is not null
and	sess.sid = stat.sid
and	stat.statistic# = sn.statistic#
and	sn.name = 'opened cursors current'
and        sess.username='&1'
order by value
/

SELECT NAME, SUM(BYTES) FROM V$SGASTAT WHERE POOL='SHARED POOL' GROUP BY ROLLUP (NAME);

SELECT NAME, SUM(BYTES) FROM V$SGASTAT WHERE POOL='streams pool' GROUP BY ROLLUP (NAME);

SELECT sum(bytes), pool
FROM v$sgastat
GROUP BY pool
/ 

alter system set streams_pool_size = 50M scope = both ; 

col OWNER_NAME format a30
col JOB_NAME format a30
col OPERATION format a20
col JOB_MODE format a20
col STATE format a20
select OWNER_NAME,JOB_NAME,OPERATION,JOB_MODE,STATE from dba_datapump_jobs where OWNER_NAME='&1';

SET lines 200
COL owner_name FORMAT a10;
COL job_name FORMAT a20
COL state FORMAT a11
COL operation LIKE state
COL job_mode LIKE state

-- locate Data Pump jobs:

SELECT owner_name, job_name, operation, job_mode,
state, attached_sessions
FROM dba_datapump_jobs
WHERE job_name NOT LIKE 'BIN$%' and OWNER_NAME='SYS' and state<>'NOT RUNNING'
ORDER BY 1,2;



SET serveroutput on
SET lines 100
DECLARE
   h1 NUMBER;
BEGIN
  -- Format: DBMS_DATAPUMP.ATTACH('[job_name]','[owner_name]');
   h1:=DBMS_DATAPUMP.ATTACH('SYS_EXPORT_FULL_02','SYS');
   DBMS_DATAPUMP.STOP_JOB (h1,1,0);
END;
/

or 

drop table MESOBLAST_AG631007_VAL.SYS_EXPORT_SCHEMA_01;
drop table MESOBLAST_AG631007_VAL.SYS_EXPORT_SCHEMA_02;
drop table MESOBLAST_AG631007_VAL.SYS_EXPORT_SCHEMA_03;
drop table MESOBLAST_AG631007_VAL.SYS_EXPORT_SCHEMA_04;

SET serveroutput on 
SET lines 100 
DECLARE 
h1 NUMBER; 
BEGIN 
h1 := DBMS_DATAPUMP.ATTACH('SYS_EXPORT_SCHEMA_02','BESINS_AG631004_VAL'); 
DBMS_DATAPUMP.STOP_JOB (h1); 
END; 
/
SET serveroutput on 
SET lines 100 
DECLARE 
   h1 NUMBER; 
BEGIN 
   h1 := DBMS_DATAPUMP.ATTACH('SYS_EXPORT_SCHEMA_02','BESINS_AG631004_VAL'); 
   DBMS_DATAPUMP.STOP_JOB (h1); 
END; 
/

SELECT o.status, o.object_id, o.object_type, 
o.owner||'.'||object_name "OWNER.OBJECT" 
FROM dba_objects o, dba_datapump_jobs j 
WHERE o.owner=j.owner_name AND o.object_name=j.job_name 
AND j.job_name NOT LIKE 'BIN$%' ORDER BY 4,2;

run
{
sql 'alter system archive log current'
report obsolete;
delete force noprompt obsolete;
backup database plus archivelog;
}

BACKUP AS COMPRESSED BACKUPSET FULL DATABASE PLUS ARCHIVELOG;

====================================================
column  TABLESPACE_NAME format a40;
column  SEGMENT_TYPE  format a20;
set lines 200
set pages 250
select tablespace_name,segment_type,
count(segment_name) from dba_segments
group by tablespace_name, segment_type where tablespace_name = '&1' ;

select count(segment_name)
from dba_extents
where tablespace_name = '&1';

Rman backup size:
-----------------------


select ctime "Date"
  , decode(backup_type, 'L', 'Archive Log', 'D', 'Full', 'Incremental') backup_type
 , bsize "Size GB"
   from (select trunc(bp.completion_time) ctime
  , backup_type
  , round(sum(bp.bytes/1024/1024/1024),2) bsize
   from v$backup_set bs, v$backup_piece bp
  where bs.set_stamp = bp.set_stamp
 and bs.set_count  = bp.set_count
 and bp.status = 'A'
 group by trunc(bp.completion_time), backup_type)
order by 1, 2;
==================================================


imp system/manager@ASMDB file=/Extra/soft/aris.dmp sql=/Extra/soft/aris_exp_20032012.sql

expdp AGINQDOMPEBO/AGINQDOMPEBO@SANDDB DIRECTORY=exp_sanddb_dumps DUMPFILE=AGINQDOMPEBO_$expdate.dmp logfile=AGINQDOMPEBO_$expdate.log

exp AGI_AGCAPTURE_POC2/AGI_AGCAPTURE_POC2@sanddb  file=/oraback/dbbackup/dumpbackup/AGI_AGCAPTURE_POC2_exp_14062011.dmp log=/oraback/dbbackup/dumpbackup/AGI_AGCAPTURE_POC2_exp_14062011.log statistics=none

impdp system/sainathsainathsainath6@PROSVR1  tables=COMPANY_UNIT DIRECTORY=exp_poiprod_dumps  REMAP_SCHEMA=ORION_AG631003_VAL:ORION_AG631005_PROD REMAP_TABLESPACE=ORION_AG631003_VAL:ORION_AG631005_PROD DUMPFILE=ORION_AG631003_VAL_COMPANY_UNIT.dmp logfile=ORION_AG631003_VAL_COMPANY_UNIT_impdp.log exclude=statistics TABLE_EXISTS_ACTION=REPLACE

impdp system/manager@ORAPRD DIRECTORY=BACKUP DUMPFILE=POI_AG622_PROD_09022012.dmp SQLFILE=POI_AG622_PROD_09022012.sql

imp system/Oracle123@ONEPRD file=/oracle/kna/prd/export/oneprod/exp_oneprd_oneprd_01.dmp show=y log=/oracle/kna/prd/export/oneprod/imponeprd_2601.log show=y full=y

imp system/manager@TESTPRDB file=/oraback/datapump/POI_AG622_PROD_09022012.dmp log=/oraback/datapump/POI_AG622_PROD_09022012.log show=y full=y

imp system@AGIDEVDB file=/oraback/datapump/backup/MESOBLAST_AG631007_VAL_NORMAL_EXP_28062012.dmp log=/backup/MESOBLAST_AG631007_VAL_NORMAL_IMP_28062012.log fromuser=MESOBLAST_AG631007_VAL touser=MESOBLAST_AG631007_VAL buffer=100000000 statistics=none

select * from dba_directories;

expdate=`date '+%d%m%Y'`
dat=`date '+%m%d%y %H:%M:%S'`
expdp MESOBLAST_AG631007_VAL/MESOBLAST_AG631007_VAL@AGIDEVDB DIRECTORY=BACKUP DUMPFILE=MESOBLAST_AG631007_VAL_$expdate.dmp logfile=MESOBLAST_AG631007_VAL_$expdate.log exclude=statistics


sqlfile=/oraback/dbbackup/dumpbackup/aerspd_exp_28022012.sql

 impdp system/sainath6@DEVDB  DIRECTORY=BACKUP DUMPFILE=aresprd_Jul182011.dmp SQLFILE=aresprd_Jul182011.sql


imp system/sainath6@DEVDB file=/oraback/dbbackup/dumpbackup/aerspd.exp log=/oraback/dbbackup/dumpbackup/aerspd_exp_28022012.log show=y full=y



column message format a80 
select message, timestamp 
from v$dataguard_status 
where severity in ('Error','Fatal') 
order by timestamp;

===============================
through root :
/sbin/service vncserver status
/sbin/service vncserver start

through oracle :
vncserver
On VNC:
startkde
================================
column message format a80 
select message, timestamp 
from v$dataguard_status 
where severity in ('Error','Fatal','ORA') 
order by timestamp;


drop user JNJ_IRT63_READ_USER cascade;
drop tablespace  AWARE0955_AG622_PROD_LOCAL including  contents and datafiles ;


CONFIGURE RETENTION POLICY TO REDUNDANCY 1;
CONFIGURE RETENTION POLICY TO RECOVERY WINDOW OF 1 DAYS;

@?/rdbms/admin/awrrpt.sql
@?/rdbms/admin/awrsqrpt.sql
@?/rdbms/admin/addmrpt.sql
@$ORACLE_HOME/rdbms/admin/awrddrpt.sql

EXEC dbms_workload_repository.create_snapshot;

@/u01/app/oracle/product/10.2.0/db_1/ctx/admin/defaults/dr0defin.sql



BACKUP AS COMPRESSED BACKUPSET FULL DATABASE PLUS ARCHIVELOG;

select count(*) from v$session where STATUS='INACTIVE';

select owner,count(*) from dba_segments where tablespace_name='&1' group by owner;

select username,created from dba_users order by created;

crosscheck backup completed before 'sysdate-3';
crosscheck archivelog all;
delete backup completed before 'sysdate-1';
delete archivelog all completed before 'sysdate-1';

delete force noprompt obsolete device type disk; [RMAN-06214: Datafile Copy ]

drop user NBI_AG631003_SANDBOX cascade;

drop tablespace AG_DAIICHI_US including Contents and Datafiles;

select OBJECT_TYPE,count(*) from user_objects where STATUS='INVALID' group by OBJECT_TYPE;

select OBJECT_TYPE,count(*) from dba_objects where STATUS='INVALID' group by OBJECT_TYPE;

------------------------------------------------------------------------------------------
alter session set "_HASH_JOIN_ENABLED"=TRUE;
SELECT  s.username,s.machine,s.terminal,s.program, a.sql_text  FROM   v$session s, v$sqlarea a, v$process p
WHERE  s.sql_hash_value = a.hash_value
AND    s.sql_address    = a.address
AND    s.paddr          = p.addr
and  p.spid=&1;

######################################################
HOW MANY ARCHIVELOG GENERATED PER DAY?
--------------------------------------
set pages 100
column DAY format a10;
SELECT A.*,
Round(A.Count#*B.AVG#/1024/1024/1024) Daily_Avg_GB
FROM(SELECT To_Char(First_Time,'YYYY-MM-DD') DAY,
Count(1) Count#,Min(RECID) Min#,Max(RECID) Max#
FROM v$log_history
GROUP BY To_Char(First_Time,'YYYY-MM-DD')
ORDER BY 1 DESC) A,
(SELECT Avg(BYTES) AVG#,Count(1) Count#,Max(BYTES) Max_Bytes,
Min(BYTES) Min_Bytes FROM v$log) B;

####################################################################


select OBJECT_TYPE,count(*) from user_objects where STATUS='INVALID' group by OBJECT_TYPE;


set lines 150
COLUMN TABLESPACE_NAME format a30;
COLUMN free_space_mb format 99999990.00;
COLUMN allocated_mb format 99999990.00;
COLUMN used_mb format 99999990.00;
COLUMN percent_used format 00.00;

SELECT  SUBSTR(df.tablespace_name,1,20) tablespace_name,
        (df.bytes) / 1024 / 1024 allocated_mb,
        ((df.bytes)-nvl(dfs.bytes,0))/1024/1024 used_mb,
        NVL ((dfs.bytes) / 1024 / 1024, 0) free_space_mb,
        round(  ((df.bytes-nvl(dfs.bytes,0))/df.bytes * 100),2) percent_used
FROM    ( select sum(bytes) bytes,tablespace_name from dba_data_files group by tablespace_name) df,
        ( select  sum(bytes) bytes , tablespace_name from dba_free_space group by tablespace_name) dfs
WHERE   df.tablespace_name = dfs.tablespace_name
and df.tablespace_name like '&1';

##########################################


select object_type,count(*) from user_objects where status = 'INVALID' 
group by object_type;


select substr(owner,1,12) owner,
substr(object_name,1,30) object,
substr(object_type,1,30) type, status from
user_objects where status <> 'VALID';


select substr(object_name,1,30) object,
substr(object_type,1,30) type, status from
user_objects where status <> 'VALID';


SELECT SID, SERIAL# FROM V$SESSION WHERE PROGRAM LIKE 'exp%'; 
exec dbms_system.set_int_param_in_session( 120,12229,'db_file_multib
_read_count', 128);
exec dbms_system.set_bool_param_in_session( 120, 12229,'_serial_direct_read', true);

SELECT SUM(BYTES) FROM DBA_SEGMENTS WHERE SEGMENT_NAME = 'SYSTEM_AUDIT_TRAIL'
###############################################################################################

Long_running_operation_finding sql:


COLUMN sid FORMAT 999
COLUMN serial# FORMAT 9999999
COLUMN machine FORMAT A30
COLUMN progress_pct FORMAT 99999999.00
COLUMN elapsed FORMAT A10
COLUMN remaining FORMAT A10

SELECT s.sid,
       s.serial#,
       s.machine,
       TRUNC(sl.elapsed_seconds/60) || ':' || MOD(sl.elapsed_seconds,60) elapsed,
       TRUNC(sl.time_remaining/60) || ':' || MOD(sl.time_remaining,60) remaining,
       ROUND(sl.sofar/sl.totalwork*100, 2) progress_pct
FROM   v$session s,
       v$session_longops sl
WHERE  s.sid     = sl.sid
AND    s.serial# = sl.serial#;

######################################################

set linesize 120 
col opname format a20 
col target format a15 
col units format a10 
col time_remaining format 99990 heading Remaining[s] 
col bps format 9990.99 heading [Units/s] 
col fertig format 90.999999 heading "complete[%]" 
select sid, 
       opname, 
       target, 
       sofar, 
       totalwork, 
       units, 
       (totalwork-sofar)/time_remaining bps, 
       time_remaining, 
       sofar/totalwork*100 fertig 
from   v$session_longops 
where  time_remaining  > 0 and sid='&1'
/ 

########################################################################


SELECT table_name, COUNT(*)  FROM chained_rows GROUP BY table_name ORDER BY table_name;

SELECT table_name, num_rows FROM user_tables WHERE table_name IN (SELECT UNIQUE table_name FROM chained_rows) ORDER BY table_name;
************************************************************************************************
set sqlprompt 'CSISDB>'

after backup need to run

/home/oracle/analyze_sun.sh
#################################################################################################
CISIS_ANALYZE:

exec dbms_stats.gather_schema_stats('JNJ_IRT63_PROD',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =>'FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 50);

#################################################################################################
GBM_ANALYZE:

exec dbms_stats.gather_schema_stats('GBMRPT',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =>'FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 20);

exec dbms_stats.gather_schema_stats('PERFSTAT',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =>'FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 20);

exec dbms_stats.gather_schema_stats('GBM',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =>'FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 20);

################################################################################################
 more gather_schema_stats.sql
exec dbms_stats.gather_schema_stats('GBMRPT',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =>'
FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 20);


select decode(db_stat_code,'C','ISOLOP COMPLETED','A','ABH STARTED','B','ABH COMPLETED','F','CSOLOP STARTED','G','CSOLOP COMPLETED') SOL_STATUS,count(*) from sol where sol_id in (select sol_id from sst where set_id='ALL')  and del_flg<>'Y' group by db_stat_code order by db_stat_code;


select init_sol_id,substr(sol_desc,1,20) sol_desc, 
count(dtd.tran_id) txn_count from dtd,dth,sol where dtd.tran_id=dth.tran_id
and sol.sol_id=dth.init_sol_id
and
pstd_flg<>'Y'
and dtd.del_flg<>'Y'
group by init_sol_id,sol_desc
order by count(dtd.tran_id);



exec dbms_stats.gather_schema_stats('PERFSTAT',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =
>'FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 20);




exec dbms_stats.gather_schema_stats('GBM',options=>'GATHER',estimate_percent => DBMS_STATS.AUTO_SAMPLE_SIZE,method_opt =
>'FOR ALL COLUMNS SIZE 1',cascade => TRUE ,degree=> 20);




*********************************************************************************************


@?/rdbms/admin/awrrpt.sql
@?/rdbms/admin/awrsqrpt.sql

@/u01/app/oracle/product/10.2.0/db_1/rdbms/admin/awrrpt.sql
@/u01/app/oracle/product/10.2.0/db_1/rdbms/admin/awrsqrpt.sql

#############################################################################################
select
   to_char(round(sub1.sample_time, 'HH24'), 'YYYY-MM-DD HH24:MI') as sample_hour,
   round(avg(sub1.on_cpu),1) as cpu_avg,
   round(avg(sub1.waiting),1) as wait_avg,
   round(avg(sub1.active_sessions),1) as act_avg,
   round( (variance(sub1.active_sessions)/avg(sub1.active_sessions)),1) as act_var_mean
from
   ( -- sub1: one row per ASH/AWR sample observation
     select
        sample_id,
        sample_time,
        sum(decode(session_state, 'ON CPU', 1, 0))  as on_cpu,
        sum(decode(session_state, 'WAITING', 1, 0)) as waiting,
        count(*) as active_sessions
     from
        dba_hist_active_sess_history
     where
        sample_time > sysdate - (&hours/24)
     group by
        sample_id,
        sample_time
   ) sub1
group by
   round(sub1.sample_time, 'HH24')
order by
   round(sub1.sample_time, 'HH24')
;
###################################################################################################





alter index TBAADM.IDX_MEMO_PAD_TABLE storage (maxextents 4000);




export ORACLE_SID=GBMUCO
tail -f /gbmora1/ora10g/OraHome1/rdbms/log/bdump/alert_GBMUCO.log

UCODB
=====================================================
SQL> alter user system
  2  identified by managerdb;

User altered.
=======================================================


 @?/rdbms/admin/awrddrpt.sql


column segment_name format a30
 

alter session set "_HASH_JOIN_ENABLED"=TRUE;

select  substr(ds.owner,1,10) owner, substr(ds.segment_name,1,30) segment_name , ds.max_extents, de.no_extents  no_extents_reached,  round(de.no_extents/ds.max_extents*100,2) no_extents_reached_pct
from    dba_segments ds,
(select count(1) no_extents, owner,segment_name from dba_extents where owner in ('CUSTOM','SISADM','TBAADM','GBM','MIGRATION') group by owner,segment_name ) de
where   de.segment_name = ds.segment_name and
        de.owner = ds.owner and
        de.owner in ('CUSTOM','SISADM','TBAADM','GBM','MIGRATION') and
        de.no_extents/ds.max_extents*100 > 75;



COLUMN used_pct format 00.00;
COLUMN OWNER format a10;
COLUMN SEQUENCE_NAME format a15;
COLUMN MAX_VALUE format 99999990 ;

select  substr(sequence_owner,1,10) owner, substr(sequence_name,1,30) sequence_name, max_value, last_number, round(last_number/max_value*100,2) used_pct,cycle_flag
from    dba_sequences
where   last_number/max_value*100 > 75;



COLUMN used_pct format 00.00;
select  CYCLE_FLAG,substr(sequence_owner,1,10) owner, substr(sequence_name,1,30) sequence_name,
max_value, last_number, round(last_number/max_value*100,2) used_pct
from    dba_sequences
where   last_number/max_value*100 > 75 AND CYCLE_FLAG='Y';

==================================================================================================UNDO TBLSPC
set lines 150
COLUMN TABLESPACE_NAME format a35;
COLUMN free_space_mb format 99999990.00;
COLUMN allocated_mb format 99999990.00;
COLUMN used_mb format 99999990.00;
COLUMN percent_used format 00.00;

SELECT  SUBSTR(df.tablespace_name,1,20) tablespace_name,
        (df.bytes) / 1024 / 1024 allocated_mb,
        ((df.bytes)-nvl(dfs.bytes,0))/1024/1024 used_mb,
        NVL ((dfs.bytes) / 1024 / 1024, 0) free_space_mb,
        round(  ((df.bytes-nvl(dfs.bytes,0))/df.bytes * 100),2) percent_used
FROM    ( select sum(bytes) bytes,tablespace_name from dba_data_files group by tablespace_name) df,
        ( select  sum(bytes) bytes , tablespace_name from dba_free_space group by tablespace_name) dfs
WHERE   df.tablespace_name = dfs.tablespace_name
and df.tablespace_name like '%&1%';
========================================TEMP TBLSPC==============================

SELECT A.tablespace_name tablespace, D.mb_total,
SUM (A.used_blocks * D.block_size) / 1024 / 1024 mb_used,
D.mb_total - SUM (A.used_blocks * D.block_size) / 1024 / 1024 mb_free
FROM v$sort_segment A,
(
SELECT B.name, C.block_size, SUM (C.bytes) / 1024 / 1024 mb_total
FROM v$tablespace B, v$tempfile C
WHERE B.ts#= C.ts#
GROUP BY B.name, C.block_size
) D
WHERE A.tablespace_name = D.name
GROUP by A.tablespace_name, D.mb_total; 

==============================================================

select sum(BYTES/1024/1024/1024) from sm$ts_avail;

select ts.name "Tablespace_Name",df.name "Datafile_Name",(df.bytes)/1024/1024 BYTES,df.CREATION_TIME 
from v$tablespace ts, v$datafile df
where ts.ts#=df.ts#
ORDER BY ts.name ;
========================================================================================================================
select sum(BYTES_FREE/1024/1024),TABLESPACE_NAME from V$TEMP_SPACE_HEADER
group by TABLESPACE_NAME;
========================================================================================================================
TABLESPACE:


column TABLESPACE_NAME format a20
set linesize 130
COLUMN free_space_mb format 99999990.00;
COLUMN allocated_mb format 99999990.00;
COLUMN used_mb format 99999990.00;
COLUMN percent_used format 00000.00;

set pages 999

set linesize 150
col tablespace_name format a40
col "size MB" format 999,999,999
col "free MB" format 99,999,999
col "% Used" format 999

SELECT  SUBSTR(df.tablespace_name,1,20) tablespace_name,
        (df.bytes) / 1024 / 1024 allocated_mb,
        ((df.bytes)-nvl(dfs.bytes,0))/1024/1024 used_mb,
        NVL ((dfs.bytes) / 1024 / 1024, 0) free_space_mb,
        round(  ((df.bytes-nvl(dfs.bytes,0))/df.bytes * 100),2) percent_used
FROM    ( select sum(bytes) bytes,tablespace_name from dba_data_files group by tablespace_name) df,
        ( select  sum(bytes) bytes , tablespace_name from dba_free_space group by tablespace_name) dfs
WHERE   df.tablespace_name = dfs.tablespace_name
ORDER BY percent_used ;

drop user JJVALDOC cascade;


expdp system@PDDB0226 DIRECTORY=EXPDP_DIR DUMPFILE=PDDB0226_FULL_07012013.dmp logfile=PDDB0226_FULL_07012013.log FULL=y



exp ORION_AGENCODER201_PROD/ORION_AGENCODER201_PROD@PROSVR1 file=/oraback/dbbackup/dumpbackup/ORION_AGENCODER201_PROD_Normal_EXP_21032012.dmp log=/oraback/dbbackup/dumpbackup/ORION_AGENCODER201_PROD_Normal_EXP_21032012.log statistics=none

delete archivelog all completed before 'sysdate -2';

column TABLESPACE_NAME format a20
column FILE_NAME format a60
select distinct (TABLESPACE_NAME),FILE_NAME from dba_data_files order by TABLESPACE_NAME;
===================================================================================================
TABLESPACE_NAME      FILE_NAME
-------------------- ------------------------------------------------------------
 Segments approaching  max extents

column segment_name format a30
 

alter session set "_HASH_JOIN_ENABLED"=TRUE;

select  substr(ds.owner,1,10) owner, substr(ds.segment_name,1,30) segment_name , ds.max_extents, de.no_extents  no_extents_reached,  round(de.no_extents/ds.max_extents*100,2) no_extents_reached_pct
from    dba_segments ds,
(select count(1) no_extents, owner,segment_name from dba_extents where owner in ('CUSTOM','SISADM','TBAADM','GBM','MIGRATION') group by owner,segment_name ) de
where   de.segment_name = ds.segment_name and
        de.owner = ds.owner and
        de.owner in ('CUSTOM','SISADM','TBAADM','GBM','MIGRATION') and
        de.no_extents/ds.max_extents*100 > 75;


 Objects that cannot extend (No space in Tablespace). 

column owner format a12    heading 'Owner'
column segment_name format a30    heading 'Object Name'
column segment_type format a15    heading 'Object Type'
column tablespace_name format a12    heading 'Tablespace'
column next_extent format 999,999,999 heading 'Next'
column max_free_space format 999,999,999 heading 'Max Free space'

select owner, segment_name, segment_type, tablespace_name, next_extent, 
(select max(sum(dfs.bytes))-100 bytes from dba_free_space dfs where dfs.tablespace_name = ds.tablespace_name group by dfs.file_id) max_free_space
from   dba_segments ds
where  next_extent > 
	(select max(sum(dfs.bytes))-100 bytes from dba_free_space dfs where dfs.tablespace_name = ds.tablespace_name group by dfs.file_id) ;


======================================
select  substr(ds.owner,1,10) owner, substr(ds.segment_name,1,30) segment_name , ds.max_extents, de.no_extents  no_extents_reached,  round(de.no_extents/ds.max_extents*100,2) no_extents_reached_pct
from    dba_segments ds,
        (select count(1) no_extents, owner,segment_name from dba_extents where owner in ('CUSTOM','TBAADM','PERFSTAT') group by owner,segment_name ) de
where   de.segment_name = ds.segment_name and
        de.owner = ds.owner and
        de.owner in ('CUSTOM','TBAADM','PERFSTAT') and
        de.no_extents/ds.max_extents*100 > 75;
==============================================
select  substr(ds.owner,1,10) owner, substr(ds.segment_name,1,30) segment_name , ds.max_extents, de.no_extents  no_extents_reached,  round(de.no_extents/ds.max_extents*100,2) no_extents_reached_pct
from    dba_segments ds,
        (select count(1) no_extents, owner,segment_name from dba_extents where owner in ('SISADM','TBAADM','PERFSTAT') group by owner,segment_name ) de
where   de.segment_name = ds.segment_name and
        de.owner = ds.owner and
        de.owner in ('SISADM','TBAADM','PERFSTAT') and
        de.no_extents/ds.max_extents*100 > 75;
========================================
select  substr(ds.owner,1,10) owner, substr(ds.segment_name,1,30) segment_name , ds.max_extents, de.no_extents  no_extents_reached,  round(de.no_extents/ds.max_extents*100,2) no_extents_reached_pct
from    dba_segments ds,
        (select count(1) no_extents, owner,segment_name from dba_extents where owner in ('GBM','PERFSTAT') group by owner,segment_name ) de
where   de.segment_name = ds.segment_name and
        de.owner = ds.owner and
        de.owner in ('GBM','PERFSTAT') and
        de.no_extents/ds.max_extents*100 > 75;



Sequences approaching MAX value

COLUMN used_pct format 00.00;
COLUMN OWNER format a10;
COLUMN SEQUENCE_NAME format a15;
COLUMN MAX_VALUE format 99999990 ;

select  substr(sequence_owner,1,10) owner, substr(sequence_name,1,30) sequence_name, max_value, last_number, round(last_number/max_value*100,2) used_pct,cycle_flag
from    dba_sequences
where   last_number/max_value*100 > 75;


@/csisora1/ora10g/OraHome1/rdbms/admin/awrrpt.sql

@/csisora1/ora10g/OraHome1/rdbms/admin/awrddrpt.sql

select name,open_mode,database_role from v$database;

select max(sequence#) from v$loghist;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=2;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=3;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=4;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=5;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=6;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=3;

Alter session set "_HASH_JOIN_EBABLED"=TRUE
Alter session set "_HASH_JOIN_EBABLED"=TRUE
select count(*) from v$session;

select max(ca#) from v$loghist;

 select  max(SEQUENCE#) from v$archived_log where APPLIED='YES';

!bdf|grep arch





============================redo latch contention ==========================================
select name,(sum(misses)/(sum(gets)+sum(misses)))*100  from  v$latch l where name like '%redo%'
and gets<>0
group by name;


========================================log wait========================================================
select TOTAL_WAITS,TIME_WAITED,EVENT from
V$SYSTEM_EVENT
where EVENT like '%log%' order by TOTAL_WAITS;


select TABLESPACE_NAME,TOTAL_EXTENTS,USED_EXTENTS,TOTAL_BLOCKS,USED_BLOCKS,FREE_EXTENTS from v$sort_segment;

==================statspack=========================================================================


exec statspack.snap(i_snap_level => 7 )


start /cbsora/OraHome1/rdbms/admin/spreport.sql


To get Snap ID

select SNAP_ID, to_char(SNAP_TIME,'dd-mm-yyyy hh24:mi:ss') from STATS$SNAPSHOT order by snap_id  
         

Put hash value

start /cbsora/OraHome1/rdbms/admin/sprepsql.sql 









============PID=====================================================================================
==========================================
a=`ps -ef|grep -i oracleREPORT|awk '{print $2}'`
echo $a
kill -9 $a
==========================================


alter session set "_HASH_JOIN_ENABLED"=TRUE;

select process,PIECE,SQL_TEXT,VALUE cpu_usage 
from (select s.process,s.sid, p.spid PID,st. PIECE,st.SQL_TEXT      from v$session s , 
v$process p,v$sqltext st where s.PADDR (+) =P.ADDR and 
s.sql_address = st.address order by st.PIECE) sq, v$sesstat ss, v$statname sn 
where sq.sid=ss.sid and  
ss.STATISTIC# = sn.STATISTIC# and 
sn.NAME like '%CPU used by this session%' 
and sq.PID=&1



24510
alter session set "_HASH_JOIN_ENABLED"=TRUE;
SELECT  s.username,s.machine,s.terminal,s.program, a.sql_text  FROM   v$session s, v$sqlarea a, v$process p
WHERE  s.sql_hash_value = a.hash_value
AND    s.sql_address    = a.address
AND    s.paddr          = p.addr
and  p.spid=&1;

select  HASH_VALUE,SQL_TEXT from v$sqltext where HASH_VALUE = 


==================================================================================
select sid,serial#,username,process,machine,program
from v$session
where paddr=(select addr from v$process
where spid=&1);



select s.sid,s.serial#,p.spid os_pid,s.status,
s.osuser,s.username,s.COMMAND,s.MACHINE,s.MODULE, s.SCHEMANAME,
s.LOCKWAIT,s.action
from v$session s, v$process p
WHERE s.paddr = p.addr
and s.sid = 72;

22hgvsk417ggw
==============Explain Plan==========================================================================
explain plan for  

@$ORACLE_HOME/rdbms/admin/utlxpls.sql  

explain plan for select count(*) from emp;
select * from table(dbms_xplan.display);

select * from lgi where pid = 



===========SESSION================================================================================



select count(*) from v$session;


select machine,count(*) from v$session group by machine


SELECT file_name, tablespace_name,bytes/1024/1024 MB FROM dba_data_files where tablespace_name='EXAMPLE' ORDER BY tablespace_name, file_name;

===================================================================================================

@$ORACLE_HOME/rdbms/admin/awrrpt.sql


tail -f alert* |grep -i ora*


cat aler*|tail -500|grep ORA

==================================================================================================

select s.sid, s.serial#, s.status, p.spid from v$session s, v$process p where s.username = '&1' and p.addr (+) = s.paddr;




select 'alter system kill session ''' || sid || ',' || serial# || '''  immediate;' from v$session where username = '&1';





Kill all  Inactive sessions together 
------------------------------------------------------

select ses.USERNAME,
    substr(MACHINE,1,10) as MACHINE, 
    substr(module,1,25) as module,
    status, 
    'alter system kill session '''||SID||','||ses.SERIAL#||''';' as kill
from v$session ses LEFT OUTER JOIN v$process p ON (ses.paddr=p.addr)
where schemaname <> 'SYS'
    and not exists
    (select 1 
        from DBA_ROLE_PRIVS 
        where GRANTED_ROLE='DBA' 
            and schemaname=grantee)
    and machine!='DB-TEST-SERVER1' 
order by LAST_CALL_ET desc;


Locked Object


SELECT b.session_id AS sid, NVL(b.oracle_username, '(oracle)') AS username, a.owner AS object_owner,
 a.object_name,Decode(b.locked_mode, 0, 'None', 1, 'Null (NULL)', 2, 'Row-S (SS)',3, 'Row-X (SX)', 4, 
'Share (S)', 5, 'S/Row-X (SSX)',6, 'Exclusive (X)',       b.locked_mode) locked_mode, b.os_user_name
 FROM   dba_objects a,v$locked_object b WHERE  a.object_id = b.object_id  ORDER BY 1, 2, 3, 4; 


select status,to_char(logon_time,'dd-mm-yyyy hh24:mi:ss') from v$session where status='INACTIVE' order by LAST_CALL_ET desc

select SYNONYM_NAME,TABLE_NAME from dba_synonyms where SYNONYM_NAME='&1';

select SERIAL# , sid from v$session where sid=&1


alter system kill session '933,1264';

-------------------------------------------------------------------------------------------------------
select status,to_char(logon_time,'dd-mm-yyyy hh24:mi:ss') from v$session 
where sid=&1

=====================================
select sid,serial#,username,process,machine,program
from v$session
where paddr=(select addr from v$process
where spid=&1);




col object_name format a30
col OWNER format a15
col ORACLE_USERNAME format a15
set lines 200
SELECT o.owner, o.object_name,to_char(o.last_ddl_time,'dd-mm-yyyy hh24:mi:ss'),
l.session_id, l.oracle_username, l.locked_mode
FROM dba_objects o, gv$locked_object l
WHERE o.object_id = l.object_id; and object_name='GE_AG631004_PROD';

===========================================================
col object_name format a30
col ORACLE_USERNAME format a30
col object_type format a20
col PROCESS format a20
set linesize 130
select b.OBJECT_name,b.object_type,l.SESSION_ID,l.ORACLE_USERNAME,l.PROCESS 
from v$locked_object l, dba_objects b
where l.object_id=b.object_id;


alter session set "_HASH_JOIN_ENABLED"=TRUE;


select session_id from v$locked_object,dba_objects where 
dba_objects.object_id=v$locked_object.object_id  and 
owner='CAT_SALES_ORDER' order by session_id;


alter session set "_HASH_JOIN_ENABLED"=TRUE;

select session_id from v$locked_object,dba_objects where 
dba_objects.object_id=v$locked_object.object_id  and 
object_name='AGX_IRT_MESSAGE'
order by session_id;

172.19.252.165

alter session set "_HASH_JOIN_ENABLED"=TRUE;

select session_id from v$locked_object,dba_objects where 
dba_objects.object_id=v$locked_object.object_id  and 
object_name='GENERAL_ACCT_MAST_TABLE' 
order by session_id;

alter session set "_HASH_JOIN_ENABLED"=TRUE;

select session_id from v$locked_object,dba_objects where 
dba_objects.object_id=v$locked_object.object_id  and 
object_name='DD_CREDITS_TABLE'
order by session_id;

alter session set "_HASH_JOIN_ENABLED"=TRUE;

select session_id from v$locked_object,dba_objects where 
dba_objects.object_id=v$locked_object.object_id  and 
object_name='INVENTORY_MASTER_TABLE'
order by session_id;


alter session set "_HASH_JOIN_ENABLED"=TRUE;

select session_id from v$locked_object,dba_objects where 
dba_objects.object_id=v$locked_object.object_id  and 
object_name='SELLIN.CAT_SALES_ORDER'
order by session_id;


LHT LIM_HISTORY_TABLE

LHD

======================================================**** ???????????

select s.sid,s.serial#,l.pid,l.current_option_id,l.host_name
from v$session s,lgi l  
where to_number(l.pid)=to_number(s.process)
and l.host_name=s.machine
and s.sid=&sid;


If out put comes no row selected then we have to check program and machine name by using that sid. 


col program format a40
col machine format a20
select program,machine from v$session
where sid=&sid;


program should not be any ORACLE Background process and MACHIN should not be bcobdb02
then we could kill that session.


=====================================================***** ??????????

select sid,type,id1,id2 ,request,lmode from gv$lock
 where (type,id1,id2) in(select type,id1,id2
 from gv$lock
 where request<>0);


select SERIAL# , sid from v$session where sid=&1;


alter system kill session '

alter session set "_HASH_JOIN_ENABLED"=TRUE;

select sid,type,id1,id2 ,request,lmode from gv$lock
 where (type,id1,id2) in(select type,id1,id2
 from gv$lock
 where request<>0) 
and LMODE=6;



select object_name from dba_objects a,gv$locked_object b
where a.object_id=b.object_id and b.session_id=&1;



select sid,event,state,SECONDS_IN_WAIT,WAIT_TIME
from v$session_wait
where sid=&1;




select sid,process,machine from v$session
where sid=&1;


select current_option_id,host_name from lgi
where pid=&1;

select SERIAL#,sid from v$session where sid=&1;

select SERIAL#,sid from v$session where sid in(


select TERMINAL,PROGRAM,status,osuser,username,serial# from v$session
where sid=&1;

select ‘ALTER SYSTEM KILL SESSION ‘’’||a.sid||’,’||a.serial#||’’’;’ 
from v$session a,lock_tmp b
where a.sid =b.sid
and  (b.type,b.id1,b.id2) in(select type,id1,id2
 from lock_tmp
 where request<>0);

select * from v$session a,lock_tmp b
where a.sid =b.sid
and  (b.type,b.id1,b.id2) in(select type,id1,id2
 from lock_tmp
 where request<>0);


where object_id in(select object_id from v$locked_object
where session_id=&1)

============================================================================================
select USERNAME,ACCOUNT_STATUS from dba_users where ACCOUNT_STATUS like '%LOCKED%' and to_date(CREATED,'DD-MON-YY') > '16-NOV-06';



select count (*) from UET$;
select count (*) from FET$;
select count (*) from V$transaction;


startup nomount

alter database mount standby database;

##alter database recover managed standby database disconnect from session;

select name,open_mode from v$database;

=========================================================
scp 1_355[0-8]* 10.6.0.21:/oradata/PROSVR1/ARCH1/

recover standby database parallel 10;

=====================================================

perl /oracle/product/12.1/db_1/clone/bin/clone.pl ORACLE_HOME="/oracle/product/12.1/db_1" ORACLE_HOME_NAME="12C_HOME"



Check FRA :
==============


http://www.oracle-scripts.net/flash-recovery-area-fra/

export ORACLE_SID=CSISDB
tail -f /csisora1/ora10g/OraHome1/rdbms/log/bdump/alert_CSISDB.log

ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL;


ALTER DATABASE RECOVER MANAGED STANDBY DATABASE DISCONNECT FROM SESSION;

alter system set standby_archive_dest='+FRA_ESPM/ESPM_SW1/ARCHIVELOG';


LOCATION=USE_DB_RECOVERY_FILE_DEST VALID_FOR=(ALL_LOGFILES,ALL_ROLES) DB_UNIQUE_NAME=ESPM_SW1


+FRA_ESPM/ESPM_SW1/ARCHIVELOG
**************************************************************************************
#alter database recover managed standby database disconnect from session;
lsnrctl start listener_dr_fin1
lsnrctl start listener_dr_fin2
**************************************************************************************


select name,open_mode from v$database;

select max(sequence#) from v$loghist;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=2;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=3;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=4;




export ORACLE_SID=UCODB
tail -f /cbsora1/ora10g/OraHome1/rdbms/log/bdump/alert_UCODB.log
UCODB_183428_1_593571575.ARC.gz

mput UCODB_17313*ARC.gz
UCODB_17312[5-9]*ARC.gz


lsnrctl set log_status off
mv listener.log listener.log_july
touch listener.log
lsnrctl set log_status on

alter database recover managed standby database disconnect from session;

#alter database recover automatic standby database;

recover cencel

select count(1) from v$transaction;

select count(1) from v$transaction;

select count(1),username from
v$session where paddr not in
(select addr from v$process
where background=1) and status='ACTIVE'
group by username;

only For sys user ther should be 1 login.
For other count should be zero.

else kill the active session for user other then tbagen(non system user).
For tbagen check entry in lgi and then kill the session

select sid,serial#,machine,process from v$session where username='MULTITEN_D' and status='ACTIVE';

select sid,serial#,machine,process from v$session where username='&1' and status='ACTIVE';

select spid from v$process where addr in (select paddr from v$session where sid in (4184,4468,4833,5210,5834,6418,10595,11126,13390,14266));


exp file=/home/oracle/gobin_10/DTH.dmp log=/home/oracle/gobin_10/DTH.log tables=TBAADM.DAILY_TRAN_HEADER_TABLE  buffer=1000000

ALTER SYSTEM SET log_archive_dest_state_2='ENABLE' SCOPE=BOTH;
ALTER SYSTEM SET log_archive_dest_state_3='ENABLE' SCOPE=BOTH;

ALTER SYSTEM SET log_archive_dest_state_2='DEFER' SCOPE=BOTH;
ALTER SYSTEM SET log_archive_dest_state_3='DEFER' SCOPE=BOTH;


UCODB_191694_1_593571575.ARC

UCODB_DR/UCODB_184975_1_593571575.ARC
UCODB_190239_1_593571575.ARC

select name,open_mode from v$database;
select max(sequence#) from v$loghist;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=2;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=3;
select  max(SEQUENCE#) from v$archived_log where APPLIED='YES' and dest_id=4;


SELECT MAX(R.SEQUENCE#) LAST_SEQ_RECD, MAX(L.SEQUENCE#) LAST_SEQ_SENT FROM V$ARCHIVED_LOG R, V$LOG L WHERE R.DEST_ID=2 AND L.ARCHIVED='YES';

select PROCESS,STATUS,SEQUENCE#,blocks,block# from v$managed_standby;




find . -name "*.ARC" -mtime +0 -exec rm {} \;


find / -type f -name "*.conf"


###############################################################
set pages 100
set lines 120
column NAME format a35

select ts.name,df.name,df.bytes,df.CREATION_TIME 
from v$tablespace ts, v$datafile df 
where ts.ts#=df.ts#
and ts.name='&1' order by CREATION_TIME;

======================================================
set linesize 120
set pagesize 100
column Datafile_Name format a50
column Tablespace_Name format a15
column CREATION_TIME format a15
select ts.name "Tablespace_Name",df.name "Datafile_Name",df.bytes,df.CREATION_TIME
from v$tablespace ts, v$datafile df
where ts.ts#=df.ts#
and ts.name='&1' order by CREATION_TIME
/

alter tablespace RSS_DATA01 add datafile 'D:\APP\ADMINISTRATOR\ORADATA\ESPRODTRS4X\DATAFILE\RSS_DATA02.DBF' 32G;



D:\APP\ADMINISTRATOR\ORADATA\ESPRODTRS4X\DATAFILE\RSS_INDX02.DBF





alter database datafile '/oradata/GEAGIPRD/GE_AG631004_PROD_02.dbf' resize 2048m;

alter tablespace RSS_INDX01 add datafile 'D:\APP\ADMINISTRATOR\ORADATA\ESPRODTRS4X\DATAFILE\RSS_INDX02.DBF' size 30G;


########################################################################################


grant update (HEALTH_CODE) on LAM to MIG_GROUP;

 grant tablespace unlimited to SS00041;
SS00041, SG00040, MB00039,


SQL> grant unlimited tablespace to SS00041;

Grant succeeded.

SQL> grant unlimited tablespace to SG00040;

Grant succeeded.

SQL> grant unlimited tablespace to MB00039;

Grant succeeded.

########################################################################################



select file#,name from v$datafile where to_char(CREATION_TIME,'mm')='03' 
select file# from v$datafile where to_char(CREATION_TIME,'mm/yy')='03/10' and name like '%IDX%';

select sum(bytes)/1024/1024/1024 from v$datafile where to_char(CREATION_TIME,'mm/yy')='04/10';

select sum(bytes)/1024/1024/1024 from v$datafile where to_char(CREATION_TIME,'mm/yy')='04/10' and name not like '%IDX%';

select sum(bytes)/1024/1024/1024 from v$datafile where to_char(CREATION_TIME,'mm/yy')='04/10' and name like '%IDX%';







##############################################################################

more data_delete.sh
----------------------------------------------------------
#!/bin/bash
while true
do
sqlplus "/ as sysdba" <<EOF
start /home/oracle/datadelete.sql
EOF
sleep 60
done
----------------------------------------------------------

 more data_delete_temp.sh
------------------------------------------------------------------
#!/bin/bash
while true
do
sqlplus "/ as sysdba" <<EOF
start /home/oracle/datadelete_temp.sql
EOF
sleep 10
done
---------------------------------------------------------------------
 more datadelete.sql
---------------------------------------------------------------------------------------------
conn  JNJ_IRT63_PROD/JNJ_IRT63_PROD
select count(*) from JNJ_IRT63_PROD.agx_wf_notes;
insert into agx_wf_notes_temp select * from agx_wf_notes;
commit;
delete from agx_wf_notes;
commit;
select count(*) from JNJ_IRT63_PROD.agx_wf_notes;
---------------------------------------------------------------------------------------------------
crontab -l
--------------------------------
00 19 * * * /oraback/bkpscript/daily_rman.sh (Daily 19 PM)
*/5 * * * * /home/oracle/OLD/data_delete_temp.sh         (Every 1minute)

===============================================================================

export :

#!/bin/bash
expdate=`date '+%d%m%Y'`
dat=`date '+%m%d%y %H:%M:%S'`
echo "Expdp Backup is started......." $dat
expdp VANILLA_CONTINEO254_VAL/VANILLA_CONTINEO254_VAL@SANDDB DIRECTORY=exp_sanddb_dumps DUMPFILE=VANILLA_CONTINEO254_VAL_$expdate.dmp logfile=VANILLA_CONTINEO254_VAL_$expdate.log exclude=statistics
expdp VANILLA_UC227_VAL/VANILLA_UC227_VAL@SANDDB DIRECTORY=exp_sanddb_dumps DUMPFILE=VANILLA_UC227_VAL_$expdate.dmp logfile=VANILLA_UC227_VAL_$expdate.log exclude=statistics	   
expdp VANILLA_CCM12115_VAL/VANILLA_CCM12115_VAL@SANDDB DIRECTORY=exp_sanddb_dumps DUMPFILE=VANILLA_CCM12115_VAL_$expdate.dmp logfile=VANILLA_CCM12115_VAL_$expdate.log exclude=statistics	   
expdp VANILLA_IRT631_VAL/VANILLA_IRT631_VAL@SANDDB DIRECTORY=exp_sanddb_dumps DUMPFILE=VANILLA_IRT631_VAL_$expdate.dmp logfile=VANILLA_IRT631_VAL_$expdate.log exclude=statistics
dat=`date '+%m%d%y %H:%M:%S'`
echo "Expdp Backup is Completed......." $dat
cd /oraback/dbbackup/dumpbackup/
tar -zcvf D_backup_before_drop_$expdate.tar.gz *_$expdate*

===================================================================================================
dd if=/dev/zero of=/.swapfile bs=1M count=1024; chmod 600 /.swapfile; mkswap /.swapfile; swapon /.swapfile


change count=1024  if want more like count=2048

############################################################################################################
set folder=%date:~10,4%%date:~4,2%%date:~7,2%
cd E:\DAILY_BACKUP_LOG
md JJDRT_%folder%
E:\pscp.exe -pw Re5etmEPlz1! oracle@10.5.2.21:/home/oracle/DAILY_BACKUP_LOG/DAILY_BACKUP_%folder%.rpt E:\DAILY_BACKUP_LOG\JJDRT_%folder%
E:\pscp.exe -pw oracle123 oracle@192.168.58.123:/Extra/soft/README.html E:\FILE
----E:\pscp.exe -pw Re5etmEPlz1! oracle@10.1.2.21:/home/oracle/DAILY_BACKUP_LOG/DAILY_BACKUP_20111025.ta.gz E:\FILE



====================================================================================================

select 'create tablespace ' || df.tablespace_name || chr(10)
 || ' datafile ''' || df.file_name || ''' size ' || df.bytes 
 || decode(autoextensible,'N',null, chr(10) || ' autoextend on maxsize ' 
 || maxbytes) 
 || chr(10) 
 || 'default storage ( initial ' || initial_extent 
 || decode (next_extent, null, null, ' next ' || next_extent )
 || ' minextents ' || min_extents
 || ' maxextents ' ||  decode(max_extents,'2147483645','unlimited',max_extents) 
 || ') ;' "Script To Recreate Tablespaces"
 from dba_data_files df, dba_tablespaces t
 where df.tablespace_name=t.tablespace_name and t.tablespace_name='&1';


set pagesize 0
set heading off
set long 999999999
set feedback off
set echo off

SELECT DBMS_METADATA.GET_DDL('USER', '&1') FROM DUAL;
SELECT DBMS_METADATA.GET_GRANTED_DDL('SYSTEM_GRANT','&1') FROM DUAL;
SELECT DBMS_METADATA.GET_GRANTED_DDL( 'ROLE_GRANT','&1') FROM DUAL;
SELECT 'GRANT ' || PRIVILEGE || ' ON ' || OWNER || '.' || TABLE_NAME || ' TO ' || GRANTEE || ';' FROM DBA_TAB_PRIVS WHERE GRANTEE = '&1';
SELECT 'ALTER USER '||USERNAME||' QUOTA UNLIMITED ON '||TABLESPACE_NAME||';' FROM DBA_TS_QUOTAS WHERE USERNAME='&1';


===================================================================================================

select distinct prev_hash_value, count(*) from v$session where machine='arisjjprddb01' 
and username='JNJ_AG633_PROD' group by prev_hash_value 

select sql_text from v$sqltext where hash_value =899157561 order by hash_value,piece
select sql_text from v$sqltext where hash_value =2355232783 order by hash_value,piece
select sql_text from v$sqltext where hash_value =3222541686 order by hash_value,piece
select sql_text from v$sqltext where hash_value =373050687 order by hash_value,piece
select sql_text from v$sqltext where hash_value =2513676246 order by hash_value,piece

#####################################################

SQL TUNING 

#####################################################

@?/rdbms/admin/ashrpt.sql
@?/rdbms/admin/awrrpt.sql
@?/rdbms/admin/awrsqrpt.sql
@?/rdbms/admin/addmrpt.sql
@$ORACLE_HOME/rdbms/admin/awrddrpt.sql

====================================================
0qmkuwm7m0tdq

alter session set "_HASH_JOIN_ENABLED"=TRUE;
SELECT  s.username,s.machine,s.terminal,s.program, a.sql_text,a.sql_id  FROM   v$session session s, v$sqlarea a, v$process p
WHERE  s.sql_hash_value = a.hash_value
AND    s.sql_address    = a.address
AND    s.paddr          = p.addr
and  p.spid=&1;



select a.sid,a.program,b.sql_text
from v$session a, v$sqltext b
where a.sql_hash_value = b.hash_value
and a.sid='&1'
order by a.sid,hash_value,piece; 



Chnge the Begin and End Snap value 
Also SQL ID
---------------------------------------
SET SERVEROUTPUT ON

-- Tuning task created for specific a statement from the AWR.
DECLARE
  l_sql_tune_task_id  VARCHAR2(100);
BEGIN
  l_sql_tune_task_id := DBMS_SQLTUNE.create_tuning_task (
                          sql_id      => '0qmkuwm7m0tdq',
                          scope       => DBMS_SQLTUNE.scope_comprehensive,
                          time_limit  => 3000,
                          task_name   => '0qmkuwm7m0tdq_AWR_tuning_task',
                          description => 'Tuning task for statement 0qmkuwm7m0tdq in AWR.');
  DBMS_OUTPUT.put_line('l_sql_tune_task_id: ' || l_sql_tune_task_id);
END;
/



EXEC DBMS_SQLTUNE.execute_tuning_task(task_name => '0qmkuwm7m0tdq_AWR_tuning_task');

spool 0qmkuwm7m0tdq_AWR_tuning_task.rpt
SET LONG 100000;
SET PAGESIZE 1000
SET LINESIZE 2000
SELECT DBMS_SQLTUNE.report_tuning_task('0qmkuwm7m0tdq_AWR_tuning_task') AS recommendations FROM dual;
SET PAGESIZE 24
spool off


exec DBMS_SQLTUNE.DROP_TUNING_TASK('0qmkuwm7m0tdq_AWR_tuning_task');


########################################################################################

col category for a15
col sql_text for a70 trunc
select name, category, status, sql_text
from dba_sql_profiles
where name like nvl('&name',name)
order by last_modified
/

SYS_SQLPROF%



BEGIN
  DBMS_SQLTUNE.drop_sql_profile (
    name   => 'SYS_SQLPROF_014c4f0925c98001',
    ignore => TRUE);
END;
/


create index JNJ_IRT63_PROD.AGX_ACTIVITY_LOG_IDX on JNJ_IRT63_PROD.AGX_ACTIVITY_LOG('FK_RECORDID','LOG_TYPE')
  tablespace JNJ_IRT63_PROD
  pctfree 10
  initrans 2
  maxtrans 255
  storage
  (
    initial 64K
    minextents 1
    maxextents unlimited
  );


############################################################################################
sftp:

oracle@sl07416:/oracle> sftp G19637@sl07113
The authenticity of host 'sl07113 (10.236.1.35)' can't be established.
ECDSA key fingerprint is 16:4b:52:ac:b1:d7:de:e1:89:79:0d:d7:5e:31:95:ab [MD5].
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added 'sl07113,10.236.1.35' (ECDSA) to the list of known hosts.
Password:
Connected to sl07113.
sftp> cd /oracle
sftp> mget 12.1.0.2.1.DB.tar.gz
Fetching /oracle/12.1.0.2.1.DB.tar.gz to 12.1.0.2.1.DB.tar.gz
/oracle/12.1.0.2.1.DB.tar.gz                                             100% 3424MB  83.5MB/s   00:41
sftp>
oracle@sl07416:/oracle>



###########################################################################


lsnrctl

set current_listener listener_orcl

set trc_level admin  /  set trc_level off /  set trc_level 10 / etc.....

save_config

-------------------------------------

http://www.cattsolutions.com/enable-admin-tracing-on-oracle-listener/

###########################################################################


Putty login
===========

@echo off
set /p servername= Server Name Please...
start C:\Users\G19636\Desktop\putty.exe  -ssh G19637@%servername% -pw Start123

with popup box:
================
@echo off
> usermessage.vbs ECHO WScript.Echo InputBox( "Put Server Name", "servername", "sample" )
FOR /F "tokens=*" %%A IN ('CSCRIPT.EXE //NoLogo usermessage.vbs') DO SET servername=%%A
ECHO Put Server Name in %servername%
DEL usermessage.vbs
start C:\Users\G19636\Desktop\putty.exe  -ssh G19637@%servername% -pw Start123



###########################################################################
COMPILE:
=============
select name,open_mode,database_role from v$database;

set pages 100
set lines 120
column OWNER format a35
column OBJECT_NAME format a40

select OWNER,OBJECT_NAME,PROCEDURE_NAME from dba_procedures where OWNER='DISIMP';

SELECT object_type,object_name,status FROM dba_objects WHERE OBJECT_NAME='UPD_INV_CUST2_PR';


SELECT object_type,object_name,status FROM dba_objects WHERE OBJECT_NAME like 'SCNP%' and object_type='PROCEDURE';

SELECT object_type,object_name,status FROM dba_objects WHERE OBJECT_NAME like '%OSP%' and object_type='PACKAGE';


select OBJECT_NAME
from all_objects
where object_type = 'PACKAGE BODY' and OWNER='DISIMP';

select OBJECT_NAME
from all_objects
where OWNER='DISIMP';

select owner,
count(object_type) "count", object_type
from ALL_OBJECTS
where owner = 'DISIMP'
group by owner, object_type;

select count (*), object_type from dba_objects where owner = 'DISIMP' group by object_type;


ALTER PROCEDURE DISIMP.UPD_INV_CUST2_PR COMPILE;


EXEC DBMS_DDL.alter_compile('PROCEDURE', 'DISIMP', 'UPD_INV_CUST2_PR');


COMPILE  Full Schema :
=====================

EXEC DBMS_UTILITY.compile_schema(schema => 'SCOTT');


###########################################################################

sudo yum install xorg-x11-xauth xterm


G19637@sl05510:/home/G19637> echo $DISPLAY
localhost:10.0
G19637@sl05510:/home/G19637> xauth list
sl05510/unix:10  MIT-MAGIC-COOKIE-1  7ed7e1e9b7bb45e699428228712dd47f
G19637@sl05510:/home/G19637> sudo su - oracle

##############################################################
#                  Set Enviroment Databases                  #
##############################################################
==============================================================
NR   |ORACLE_SID       |VERSION   |ONLINE
==============================================================
TYPE mm to get Enviroment !
oracle@sl05510:/oracle/home/oracle> 
oracle@sl05510:/oracle/home/oracle> xauth add sl05510/unix:10  MIT-MAGIC-COOKIE-1  7ed7e1e9b7bb45e699428228712dd47f
oracle@sl05510:/oracle/home/oracle> export DISPLAY=localhost:10.0
oracle@sl05510:/oracle/home/oracle>
oracle@sl05510:/oracle/home/oracle>

-------------===================================================

From the Logged User to identify the xauth details:

$ xauth list

$ env|grep DISPLAY

$ xauth list | grep unix`echo $DISPLAY | cut -c10-12` > /tmp/xauth

Switch to the user where you want to run GUI-based installation or tools:

$ sudo su - oracle

$ xauth add `cat /tmp/xauth`xauth add `cat /tmp/xauth`

$ xauth list

$ env|grep DISPLAY

$ export DISPLAY=localhost:10.0

$ xclock

==================================================================

run 
{
allocate channel c1 type disk;
allocate channel c2 type disk;
backup database plus archivelog tag full_bkp_2206 format '/oraclebackup/PRD2HVQ/rmanbkp/2206/full_%d_%s_%p_%t';
}


-----------------------------
run 
{
allocate channel c1 type disk;
allocate channel c2 type disk;
backup database plus archivelog tag full_bkp_2206 format '/oraclebackup/PRD1HVQ/rmanbkp/2206/full_%d_%s_%p_%t';
}





# dbca -silent -createDatabase -templateName ORCL.dbt -gdbname ORCL -sid ORCL -datafileJarLocation /oracle/kna/dev/u14/ORCL -responseFile NO_VALUE -characterset WE8ISO8859P1


After 2 day .... still  "Waiting Courier Pickup"   . This vendor not good . Really Worthless
===============================================================

ASM size:


cat asmdu.sh

#!/bin/bash
#
# du of each subdirectory in a directory for ASM
#
D=$1
 
if [[ -z $D ]]
then
 echo "Please provide a directory !"
 exit 1
fi
 
(for DIR in `asmcmd ls ${D}`
 do
     echo ${DIR} `asmcmd du ${D}/${DIR} | tail -1`
 done) | awk -v D="$D" ' BEGIN {  printf("\n\t\t%40s\n\n", D " subdirectories size")           ;
                                  printf("%25s%16s%16s\n", "Subdir", "Used MB", "Mirror MB")   ;
                                  printf("%25s%16s%16s\n", "------", "-------", "---------")   ;}
                               {
                                  printf("%25s%16s%16s\n", $1, $2, $3)                         ;
                                  use += $2                                                    ;
                                  mir += $3                                                    ;
                               }
                         END   { printf("\n\n%25s%16s%16s\n", "------", "-------", "---------");
                                 printf("%25s%16s%16s\n\n", "Total", use, mir)                 ;} '

								 
								 
								 
								 
								 
								 
===================================

You can book your efforts on this WBS: DE1-EO200.12.68


cd /u01/app/oracle/product/11.2.0/clone/bin

perl clone.pl ORACLE_HOME="/oracle/12.1.0.2.1.DB_170418"  ORACLE_HOME_NAME="oracle_12c" ORACLE_BASE="/oracle"



perl clone.pl ORACLE_HOME="/oracle/12.1.0.2.170418" ORACLE_HOME_NAME="Oracle_home12C" ORACLE_BASE="/oracle"


perl clone.pl ORACLE_HOME="/u01/app/oracle/product/11.2.0/db_1" ORACLE_HOME_NAME="Oracle_home11G" ORACLE_BASE="/u01/app/oracle"
								 
		 -ignoreSysPrereqs			

perl /oracle/product/12.1/db_1/clone/bin/clone.pl ORACLE_HOME="/oracle/product/12.1/db_1" ORACLE_HOME_NAME="12C_HOME" ORACLE_BASE="/oracle"
	


perl /u01/app/oracle/product/12.1.0/db_home1/clone/bin/clone.pl ORACLE_HOME="/u01/app/oracle/product/12.1.0/db_home1" ORACLE_HOME_NAME="12C_HOME" ORACLE_BASE="/u01/app/oracle"
	
perl /u00/app/12.1.0/grid/clone/bin/clone.pl ORACLE_HOME="/u00/app/12.1.0/grid" ORACLE_HOME_NAME="12C_GI_HOME" ORACLE_BASE="//u00/app"
								 
===========================================================

alter session set current_schema=OASIS


select sys_context('USERENV','SESSION_USER') current_user,sys_context('USERENV','SESSION_SCHEMA') current_schema from dual; 


	


exec sys.dbms_scheduler.STOP_JOB(job_name=>'OASIS.OASIS_START_NETTO_3', force=>true);

exec dbms_scheduler.disable('OASIS.OASIS_START_NETTO_1');
	
select job_name, enabled from DBA_SCHEDULER_JOBS WHERE job_name ='OASIS.OASIS_START_NETTO_1';

========================================================

Oracle session level trace  for a schema:



CREATE OR REPLACE TRIGGER MYTEST_SCHEMA_LOGIN
AFTER LOGON ON DATABASE
WHEN ( USER = 'MYTEST' )
BEGIN
execute immediate 'alter session set events ''10046 trace name context forever, level 12''';
EXCEPTION
EXCEPTION
WHEN OTHERS THEN
NULL;
END;
/


ALTER SESSION SET EVENTS '10046 trace name context off';


======================================

set ORACLE_HOME=F:\app\oracle\product\12.1.0\dbhome_1
set PATH=%ORACLE_HOME%\bin;%PATH%
set ORACLE_SID=PRISSM7
echo %ORACLE_SID%

sqlplus "/as sysdba"
sqlplus "/as sysasm"


set pages 999
set linesize 150
select name,open_mode,log_mode,database_role,FORCE_LOGGING,DBID from v$database; 

oracle.assistants.dbca.driver.DBConfigDriver setup
Total time taken for DBCA operation 
oracle.install.commons.util.ExitStatusSet add
Adding ExitStatus FAILURE to the exit status set





usahsmfld106:
================


alias ot='cat /etc/oratab'
alias p1='tail -f /u01/app/oracle/diag/rdbms/nmoalfa/nmoalfa/trace/alert_nmoalfa.log'
alias s1='tail -f /u01/app/oracle/diag/rdbms/nmostg1/nmostg1/trace/alert_nmostg1.log'
alias s2='tail -f /u01/app/oracle/diag/rdbms/nmostg2/nmostg2/trace/alert_nmostg2.log'
alias t6='sh /home/oracle/tblspc.sh'


usahsmfld105:
================
alias ot='cat /etc/oratab'
alias p2='tail -f /u01/app/oracle/diag/rdbms/nmoalfa_st/nmoalfa_st/trace/alert_nmoalfa_st.log'
alias s3='tail -f /u01/app/oracle/diag/rdbms/nmostg3/nmostg3/trace/alert_nmostg3.log'
alias s4='tail -f /u01/app/oracle/diag/rdbms/nmostg4/nmostg4/trace/alert_nmostg4.log'




I will perform the below :

1.	Will drop current 12C database.
2.	Restore the 11G database from old backup ( after OASIS.WIN 17.1)
3.	All VARCHAR2 table columns in the source database whose length is set in bytes must be converted to CHAR. With this command,(as per step 2 > Oracle12c_including_character_set_NKK.docx)
4.	export back up from 11 G database 
5.	Drop the 11G database
6.	Create the 12 C database as per Oracle12c_including_character_set_NKK.docx
7.	Import the backup .


AutoTextList "word" \s NoStyle \t "This is a test window"

ctrl + f9

alt + f9




E-C01268876   CR


run
{
allocate channel c1 type disk;
allocate channel c2 type disk;
allocate channel c3 type disk;
allocate channel c4 type disk;
backup database plus archivelog tag full_bkp format '/oracle/rman_bkp/full_%d_%s_%p_%t';
}


===========================================================================================

set linesize 120
set pagesize 100
column DISK_FILE_PATH format a30
column DISK_GROUP_NAME format a20

SELECT
    NVL(a.name, '[CANDIDATE]')      disk_group_name
  , b.path                          disk_file_path
  , b.name                          disk_file_name
  , b.failgroup                     disk_file_fail_group
FROM
    v$asm_diskgroup a RIGHT OUTER JOIN v$asm_disk b USING (group_number)
ORDER BY
    a.name;
	
=====asm disk  =============================

/etc/init.d/oracleasm querydisk -d `/etc/init.d/oracleasm listdisks -d` |
cut -f2,10,11 -d" " | perl -pe 's/"(.*)".*\[(.*), *(.*)\]/$1 $2 $3/g;' |
while read v_asmdisk v_minor v_major
do
v_device=`ls -la /dev | grep " $v_minor, *$v_major " | awk '{print $10}'`
echo "ASM disk $v_asmdisk based on /dev/$v_device [$v_minor, $v_major]"
done

==============================================================

ORACLEASM=/etc/init.d/oracleasm
 
echo "ASM Disk Mappings"
echo "----------------------------------------------------"
for f in `$ORACLEASM listdisks`
do
dp=`$ORACLEASM querydisk -p  $f | grep /dev/mapper | awk -F: '{print $1}'`
pat=`$ORACLEASM querydisk -p  $f | grep /dev/sd | awk -F: '{print $1}'`
echo "$f: $dp : $pat"
done  


===============================================
diskgroup
=============
set linesize 120
set pagesize 100
column DISK_FILE_PATH format a30
column DISK_GROUP_NAME format a10

select name, group_number, name, type, state, total_mb, free_mb from v$asm_diskgroup;


================================================

#/bin/sh
/u00/app/12.1.0/grid/bin/kfed read /dev/sdj4 2> /dev/null
if [ $? -eq 0 ]
then
  /bin/echo "Successfully created file"
else
   /bin/echo "Could not create file" >&2
fi

===============================================
	
select name,state,total_mb/1024 "total in GB",free_mb/1024 "free in GB" from v$asm_diskgroup where name='&1';



	
===========    grep    =====================================
grep 1 word with next 2 line from a file:
	
grep -A 2 "I AM BACK" test.txt 

grep 1 word with next 2 or before 2 line from a file:

grep -A 2 -B 2 "I AM BACK" test.txt




=====================================================

select s.sid, s.serial#, s.status, p.spid 
from v$session s, v$process p 
where s.username = 'ORAWEB' 
and p.addr (+) = s.paddr;

-- alter system kill session '<sid>,<serial#>';

Also, check that the user is not associated with any active jobs:

select job from dba_jobs where log_user='myuser';

select 'alter system kill session ''' || sid || ',' || serial# || '''  immediate;' from v$session where username = 'ORAWEB';

===============================================================

kill datapump job:
====================
SET lines 200

SELECT owner_name, job_name, operation, job_mode,
state, attached_sessions
FROM dba_datapump_jobs
ORDER BY 1,2;

SELECT owner_name, job_name, operation, job_mode, state FROM dba_datapump_jobs;

SELECT o.status, o.object_id, o.object_type,
       o.owner||'.'||object_name "SYS.SYS_EXPORT_SCHEMA_06"
  FROM dba_objects o, dba_datapump_jobs j
 WHERE o.owner=j.owner_name AND o.object_name=j.job_name
   AND j.job_name NOT LIKE 'BIN$%' ORDER BY 4,2;
   
  

DECLARE
   h1 NUMBER;
BEGIN
   h1 := DBMS_DATAPUMP.ATTACH('SYS_EXPORT_SCHEMA_01','SYS');
   DBMS_DATAPUMP.STOP_JOB (h1,1,0);
END;
/
  
DECLARE
           h1 NUMBER;
      BEGIN
           h1:=DBMS_DATAPUMP.ATTACH('SYS_EXPORT_SCHEMA_06','SYS');
           DBMS_DATAPUMP.STOP_JOB (h1, 1, 0);
       END;
/   
   
SQL> DROP TABLE SYSTEM.SYS_EXPORT_FULL_01;
SQL> DROP TABLE SCOTT.SYS_EXPORT_TABLE_02 ;
SQL> DROP TABLE SCOTT.EXPDP_20051121;


col username format a10
set linesize 150
col job_name format a20
col program format a25
SELECT TO_CHAR (SYSDATE, 'YYYY-MM-DD HH24:MI:SS') "DATE",
     s.program,
     s.sid,
     s.status,
     s.username,
     d.job_name,
     p.spid,
     s.serial#,
     p.pid
FROM V$SESSION s, V$PROCESS p, DBA_DATAPUMP_SESSIONS d
WHERE p.addr = s.paddr AND s.saddr = d.saddr;

Some imp points:

1. Datapump jobs that are not running doesn’t have any impact on currently executing ones.
2. When any datapump job (either export or import) is initiated, master and worker processes will be created.
3. When we terminate export datapump job, master and worker processes will get killed and it doesn’t lead to data courrption.
4. But when import datapump job is terminated, complete import might not have done as processes(master & worker)  will be killed.

================================================



RMAN BACKUP :

view your incremental Backup Details :

select  incremental_level,
        incremental_change#,
        checkpoint_change#,
        blocks
from    v$backup_datafile;


cat rman.sh
==============
#!/bin/ksh
export ORACLE_HOME=/u01/app/oracle/product/11.2.0/db_1
export PATH=/u01/app/oracle/product/11.2.0/db_1/bin:$PATH
export ORACLE_SID=PRDDB01
expdate=`date '+%d%m%Y'`
dat=`date '+%m%d%y %H:%M:%S'`
mkdir -p /oraback/rman_bkp/$expdate/
rman target / nocatalog log=/oraback/rman_bkp/logs/rmanl.log << EOF1
CROSSCHECK BACKUP DEVICE TYPE DISK;
CROSSCHECK ARCHIVELOG ALL;
run
{
allocate channel c1 type disk;
allocate channel c2 type disk;
allocate channel c3 type disk;
allocate channel c4 type disk;
DELETE NOPROMPT OBSOLETE;
}
EXIT;
EOF1

LIST BACKUP OF ARCHIVELOG FROM TIME "SYSDATE-1";

LIST BACKUP OF ARCHIVELOG FROM SEQUENCE 50 UNTIL 60;

LIST BACKUP OF ARCHIVELOG 
  FROM TIME "TO_DATE('08/06/2017 18:00:00', 'MM/DD/YYYY hh24:mi:ss')" 
  UNTIL TIME "TO_DATE('08/06/2017 20:10:00', 'MM/DD/YYYY hh24:mi:ss')";
  
  
  
LVM
=========

step:1   
fdisk -l | grep ^Disk  -> compare with pvs & df -h
step:2   
pvcreate /dev/sdb1
step:3   
pvdisplay -v
step:4   
vgcreate /dev/vg01 /dev/sdb1
step:5   
vgdisplay -v

step:6   
lvcreate -L 100G -n /dev/vg01/u01lv
lvcreate -L 101G -n /dev/vg01/oradatalv
lvcreate -L 280G -n /dev/vg01/orabacklv

step:7   
mkdir /u01 /oradata  /orabackup
mkdir /backup

step:8   
mkfs.ext3 /dev/vg01/oradatalv
mkfs.ext3 /dev/vg01/orabacklv

step:9   
mount -t ext3 /dev/vg01/oradatalv /oradata
mount -t ext3 /dev/vg01/orabacklv /oraback

mount -t ext3 /dev/sdb /oradata

step:10  
df -k
step:11  add entry on /etc/fstab
         like 
         
vi /etc/fstab

/dev/sdc1 /oracle ext4 defaults 1 2

/dev/vg01/oradatalv /oradata ext3 defaults 1 2
/dev/vg01/orabacklv /oraback ext3 defaults 1 2

/dev/sdb /oradata ext3 defaults 1 2
/dev/sdc /oraback ext3 defaults 1 2


/dev/sdb1 /data ext4 defaults 1 2
/dev/sdc1 /backup ext4 defaults 1 2


/dev/sdb1 /u01  ext4   defaults 1 2
/dev/sdc1 /oradata ext4  defaults 1 2
/dev/sdd1 /oraback ext4  defaults 1 2

step:12  Same steps 6-11 should be done for every mountpoint.


CAMKTAVIV001\szsvh9  Nzwinter2017# 
============================================


Introduction to Amazon API Gateway
Introduction to Amazon DynamoDB
Introduction to Amazon CloudFront
Introduction to AWS Lambda
Introduction to AWS Internet-of-Things (IoT)
Introduction to AWS Identity and Access Management (IAM)
Creating an Amazon Virtual Private Cloud (VPC) with AWS CloudFormation


==================


set ORACLE_HOME=E:\oracle\product\10.2.0.4
set PATH=%ORACLE_HOME%\bin;%PATH%
set ORACLE_SID=P6085

========================

#!/bin/bash
export ORACLE_HOME=/u01/app/oracle/product/12.1.0/db_home
export PATH=/u01/app/oracle/product/12.1.0/db_home/bin:$PATH
export ORACLE_SID=dv2alfa
sqlplus -s /nolog << EOF
connect / as sysdba
@/oracle/DWRT/product/12.1.0.2/rdbms/admin/utlrp.sql
exit
EOF

=================================================

cat /home/oracle/mailcheck.txt | mailx -r alfaoper@daimler.com -a /home/oracle/mailcheck_2.txt -s "MBFS:`hostname`-Staging2_snapshot_Standby Started : UAT " $MAIL_ID



==============



yum install glibc.i686
yum install libXtst.i686
yum install gtk2.i686

=======================


####yum install --downloadonly --downloaddir=/home/oracle/Desktop/rpm libXtst.i686 


if want to download during yum install :  update keepcache=1  in /etc/yum.conf 
cachedir=/var/cache/yum/$basearch/$releasever  is  the location ;


========================

yum install yum-utils

yumdownloader 

yumdownloader gcc-4* --downloaddir=/u02/orasoft


==========================

alter system set *.db_file_name_convert='+DATA1/PRDGWS/datafile/','+DATA7/TBTA1GWS/datafile/','+DATA2/PRDGWS/datafile/','+DATA7/TBTA1GWS/datafile/' scope=spfile;

alter system set *.log_file_name_convert='+DATA6/PRDGWS/','+DATA7/TBTA1GWS/','+DATA3/PRDGWS/','+DATA7/TBTA1GWS/' scope=spfile;

========================


set heading off;
set echo off;
Set pages 999;
set long 90000;
  
select dbms_metadata.get_ddl('TRIGGER','MANAGE_SERVICE','SYS') from dual; 

=====================================


000.800.100.7534 (Metalink Toll Free) 

1.800.223.1711 

=======================================

GAP DG SYNC CHECK , FROM STANDBY :
==============================

SELECT ARCH.THREAD# "Thread", ARCH.SEQUENCE# "Last Sequence Received",
APPL.SEQUENCE# "Last Sequence Applied", (ARCH.SEQUENCE# - APPL.SEQUENCE#) "Difference" FROM
(SELECT THREAD# ,SEQUENCE# FROM V$ARCHIVED_LOG WHERE (THREAD#,FIRST_TIME ) IN
(SELECT THREAD#,MAX(FIRST_TIME) FROM V$ARCHIVED_LOG GROUP BY THREAD#)) ARCH,
(SELECT THREAD# ,SEQUENCE# FROM V$LOG_HISTORY WHERE (THREAD#,FIRST_TIME ) IN
(SELECT THREAD#,MAX(FIRST_TIME) FROM V$LOG_HISTORY GROUP BY THREAD#)) APPL
WHERE
ARCH.THREAD# = APPL.THREAD#
ORDER BY 1;


==============================================

crsctl stop crs 
crsctl start crs 
crsctl status resource -t

===============================================



srvctl start instance -d GTSGCPRD -i GTSGCPRD1

srvctl stop instance -d VAMWEBT -i VAMWEBT1

srvctl status instance -d SMART11P -i SMART11P_2


srvctl status database -d  

srvctl status  instance -d GTSGCPRD -i GTSGCPRD1


srvctl add listener

srvctl stop listener
srvctl start  listener
srvctl status listener


 srvctl status instance -d SMART11P -i SMART11P_2

 srvctl status database -d SMART11P

 
 srvctl status instance -d SMART11P -i SMART11P_2

 
 srvctl status database -d GPORTDEV


=======================


 srvctl status database -d GTSGCPRD
 srvctl add database -d GTSGCPRD -o /u01/app/oracle/product/12.2.0.1/dbhome_1.

 srvctl config database -d GTSGCPRD
 
 srvctl status database -d GTSGCPRD
 
 ps -ef |grep pmon

 srvctl add instance -d GTSGCPRD -i GTSGCPRD1 -n myGTSGCPRD01
 srvctl add instance -d GTSGCPRD -i GTSGCPRD2 -n myGTSGCPRD02
 
 srvctl status database -d GTSGCPRD
 
 srvctl stop database -d GTSGCPRD

 srvctl start database -d GTSGCPRD
 
 srvctl status database -d GTSGCPRD

================================================

column status           format a120 wrap             heading "Status"
Select status_01 ||'    | '||status_02 status
  From
       (Select '   Database_Name     '||Lpad(Name,12) Status_01 from V$Database)
     , (Select '   Instance_Name     '||Lpad(Instance_Name,14) Status_02 from gV$Instance)
Union
Select status_01||'    | '||status_02 status
  From
       (Select '   Host_Name     '||Lpad(Host_Name,18) status_02 from gV$Instance)
     , (Select '   Cpu_Count             '||Lpad(value,8) status_01 from V$PARAMETER where name='cpu_count' and value is not null)
Union
Select status_01||'    | '||status_02 status
  From
       (Select '   Startup_Time    '||To_Char(Startup_Time, 'DD-MM-YYYY HH24:MI') Status_02 from gV$Instance)
     , (Select '   Instance_Status     '||Lpad(Database_Status,10) Status_01 from gV$Instance)
Union
Select status_01||'    | '||status_02 status
  From
       (Select '   Instance_Logins '||Lpad(logins,14) Status_01 from gV$Instance)
     , (Select '   Database_Open_Mode   '||Lpad(open_mode,11) Status_02 from V$database)
Union
Select status_01||'    | '||status_02 status
  From
       (Select '   Version           '||Lpad(Version,12) Status_01 from gV$Instance)
     , (Select '   Instance_Role   '||Lpad(Instance_Role,16) Status_02 from gV$Instance)
; 


=====================================================

https://valehagayev.wordpress.com/2016/04/16/useful-oracle-rac-commands/

RAC command

=====================================================

•        E-mail: eon.servicedesk@hpe.com 
•        Phone:
 
Country	Toll Free	International
UK	0800 02 60259	+44 1793 795368

+918000260259 

=========================================

Najeeb aviva password is  >    Gulab00123#

Zaiwelcome2018


========================================
###########################################################

select * from dba_directories;


create or replace directory migration as '/oraclestage/migration';



grant read,write on directory migration to public;


========================================================================

create or replace directory Rollback as '/u03/rollback';



grant read,write on directory Rollback to public;

expdp \"/ as sysdba\" full=y DIRECTORY=Rollback  dumpfile=Final_BKP_BO2ADPRD_$expdate.dmp logfile=Final_BKP_BO2ADPRD_$expdate.log VERSION=11.2.0

expdp \"/ as sysdba\" full=y DIRECTORY=Rollback  dumpfile=Final_BKP_BO2ADPRD_$expdate.dmp logfile=Final_BKP_BO2ADPRD_$expdate.log VERSION=11.2.0

=================================================================
expdate=`date '+%d%m%Y'`
dat=`date '+%m%d%y %H:%M:%S'`

nohup expdp \"/ as sysdba\" full=y DIRECTORY=Rollback  dumpfile=Final_BKP_BO2PRD_$expdate_%u.dmpdmp logfile=Final_BKP_EONNGP_$expdate.log filesize=20G parallel=4 &

userid='/ as sysdba'
full=y 
DIRECTORY=EXP_DIR1 
compression=all 
dumpfile=ORAWEB_$expdate_%u.dmp 
logfile=ORAWEB_$expdate.log 
filesize=20G 
parallel=4 

no

nohup expdp parfile=EXPDP_ORAWEB_200318.par &

userid='/ as sysdba' DIRECTORY=Expdp_200318 DUMPFILE=Expdp_200318:Expdp_ORAWEB_%U.dmp FILESIZE=20G LOGFILE=Expdp_200318:Expdp_ORAWEB_1.log SCHEMAS=ORAWEB  PARALLEL=4 exclude=statistics


nohup expdp \"/ as sysdba\" full=y dumpfile=DP:Final_BKP_EONNGP_DP_%U.dmp,DP1:Final_BKP_EONNGP_DP1_%U.dmp logfile=DP:Final_BKP_EONNGP.log compression=all parallel=2 filesize=10g &




ls -lrt /oracle/EONNGP/oradata/rman_bkp/expdp
ls -lrt /oracle/EONNGP/oradata1/rman_bkp/expdp


Drop all object from an oracle user/schema :
=============================================


select 'drop '||object_type||' &owner..'|| object_name || ';' from dba_objects WHERE OWNER=UPPER('&owner')                                                          and object_type in ('TABLE','VIEW','PACKAGE','SEQUENCE', 'PROCEDURE', 'FUNCTION', 'INDEX')
/ 
 

PURGE DBA_RECYCLEBIN
/   
 

============================================================================
vi rman.cmd

connect target
RUN
{
ALLOCATE CHANNEL d1 DEVICE TYPE DISK FORMAT '/oracle/EONNGP/oradata/rman_bkp/%U'; 
ALLOCATE CHANNEL d2 DEVICE TYPE DISK FORMAT '/oracle/EONNGP/oradata1/rman_bkp/%U'; 
BACKUP DATABASE PLUS ARCHIVELOG;
}


nohup rman @/oracle/home/oracle/rman.cmd &


https://www.msregistration.com/sap-azure/content/eventschedule.aspx
ls -lrt /oracle/EONNGP/oradata/rman_bkp
ls -lrt /oracle/EONNGP/oradata1/rman_bkp


du -sh /oracle/EONNGP/oradata/rman_bkp/*
du -sh /oracle/EONNGP/oradata1/rman_bkp/*
du -sh /oracle/EONNGP/oraarch/rman_bkp/*
du -sh /oracle/EONNGP/recovery_area/rman_bkp/*



################################################################################


set lines 120
col RMAN_Status FORMAT A20 heading "Status"
col INPUT_TYPE  FORMAT A15 heading "Backup Type"
col Hrs         FORMAT 999.99 heading "Backup Time"
col Start_Time  FORMAT A20 heading "Backup Start Time"
col Start_Time  FORMAT A20 heading "Backup End Time"

SELECT SESSION_KEY "Backup Session ID", INPUT_TYPE, 
       STATUS 				      RMAN_Status,
       TO_CHAR(START_TIME,'DY mm/dd hh24:mi') Start_Time,
       TO_CHAR(END_TIME,'DY mm/dd hh24:mi')   Start_Time,
       ELAPSED_SECONDS/3600                   Hrs
FROM V$RMAN_BACKUP_JOB_DETAILS WHERE Status='RUNNING';

ORDER BY SESSION_KEY desc;




col STATUS format a9
col hrs format 999.99
select SESSION_KEY, INPUT_TYPE, STATUS,
 to_char(START_TIME,'mm/dd/yy hh24:mi') start_time,
 to_char(END_TIME,'mm/dd/yy hh24:mi') end_time,
 elapsed_seconds/3600 hrs
 from V$RMAN_BACKUP_JOB_DETAILS
 order by session_key;
 
 
 
 =====================
 
 
 krft\A-YOI0075 
ThURsKFT@6703   >  Welcome2018#
ERM ID ; hpvmsuny
pass : Daya9Kiss33$   >      SaDaKi9$Vel


Audit Report Server :
------------------------
MDZUSPAWBAUTL01.krft.net

=====================================
wget https://www.dropbox.com/s/ugxgpd77bo25qju/countstarTSTZ.zip

UPGRADE DST TIME ZONE:

$ unzip DBMS_DST_scriptsV1.9.zip
Archive:  DBMS_DST_scriptsV1.9.zip
   creating: DBMS_DST_scriptsV1.9/
  inflating: DBMS_DST_scriptsV1.9/countstarTSTZ.sql
  inflating: DBMS_DST_scriptsV1.9/countstatsTSTZ.sql
  inflating: DBMS_DST_scriptsV1.9/upg_tzv_apply.sql
  inflating: DBMS_DST_scriptsV1.9/upg_tzv_check.sql
----------------------------------------- 
SELECT version FROM v$timezone_file;
  
spool countstatsTSTZ.log
@countstatsTSTZ.sql
spool off
-----------------------------------------
exec dbms_scheduler.purge_log; 
-----------------------------------------
spool upg_tzv_check.log
@upg_tzv_check.sql
spool off
----------------------------------------
spool upg_tzv_apply.log
@upg_tzv_apply.sql
spool off
-----------------------------------------
SELECT version FROM v$timezone_file;
------------------------------------------
==================================================

mkdir -p /oraback/myorcl
mkdir -p /oraback/myorcl/log

$cold_backup.sh
export ORACLE_HOME=/u00/app/12.1.0/grid
export ORACLE_SID=+ASM
export PATH=$ORACLE_HOME/bin:$PATH
export LD_LIBRARY_PATH=$ORACLE_HOME/lib:$LD_LIBRARY_PATH
export LD_LIBRARY_PATH=$ORACLE_HOME/lib:$LD_LIBRARY_PATH
rman target / log=/oraback/PROD/log/PROD`date +%d%m%Y`.log <<EOF
sql 'alter system checkpoint';
shutdown immediate;
startup mount;
sql "create pfile='/oraback/PROD/pfile_test.ora' from spfile";
RUN {
ALLOCATE CHANNEL disk1 DEVICE TYPE DISK FORMAT '/oraback/PROD/test_%U';
ALLOCATE CHANNEL disk2 DEVICE TYPE DISK FORMAT '/oraback/PROD/test_%U';
ALLOCATE CHANNEL disk3 DEVICE TYPE DISK FORMAT '/oraback/PROD/test_%U';
BACKUP AS COMPRESSED BACKUPSET DATABASE;
BACKUP CURRENT CONTROLFILE FORMAT '/oraback/PROD/cntrl_%s_%p_%t';
RELEASE CHANNEL disk1;
RELEASE CHANNEL disk2;
RELEASE CHANNEL disk3;
}

##############################################


#!/bin/ksh
sqlplus -s "/ as sysdba" <<EOF
@/u01/app/oracle/admin/migration/test.sql
EOF 


=========================
Oracle on rhel6:
================================================================
rpm -qa |grep  binutils  
rpm -qa |grep  compat-libcap1  
rpm -qa |grep  ksh 
rpm -qa |grep  make  
rpm -qa |grep  sysstat 

==========All below rpm should be both 32 & 64 bit =============

rpm -qa |grep  gcc  
rpm -qa |grep  gcc-c++  
rpm -qa |grep  glibc 
rpm -qa |grep  libgcc  
rpm -qa |grep  libstdc++    
rpm -qa |grep  libaio  
rpm -qa |grep  libXext  
rpm -qa |grep  libXtst  
rpm -qa |grep  libX11  
rpm -qa |grep  libXau  
rpm -qa |grep  libxcb  
rpm -qa |grep  libXi  
rpm -qa |grep  unixODBC  
rpm -qa |grep  compat-libstdc++-33  
 
###################################################

rpm -q unzip wget binutils*.i* compat-libcap1.i* compat-libcap1* gcc-4* gcc-c++-4* glibc-devel* libaio* libgcc* libgcc*.i* libstdc++-* libstdc++-*.i* ksh make sysstat numactl numactl*.i* motif redhat-lsb oracle* openmotif21* xorg-x11-libs* binutils-2.* gcc-4.* gcc-c++* glibc-2.* glibc-common-2* glibc-devel-2.* libgcc-4* libstdc++-devel* libstdc++-4* make-3.* libXrender-* libXp-* libaio-* libgomp-* sysstat-* util-linux-ng-* unzip-* compat-libstdc++* elfutils-libelf-0* libaio-0* unixODBC-2* unixODBC-devel-2* xorg-x11-utils --qf '%{name}.%{arch}\n'|sort > /tmp/out.txt;egrep '(is not installed)' /tmp/out.txt > /tmp/out2.txt;awk '{ print $2 }' /tmp/out2.txt > /tmp/out3.txt;sed -e 's/^/yum install /' /tmp/out3.txt > /tmp/out4.txt;sed -e 's/$/ -y /' /tmp/out4.txt > rpm.sh; sh -x rpm.sh


rpm -q unzip wget binutils*.i* compat-libcap1.i* compat-libcap1* gcc-4* gcc-c++-4* glibc-devel* libaio* libgcc* libgcc*.i* libstdc++-* libstdc++-*.i* ksh make sysstat numactl numactl*.i* motif redhat-lsb oracle* --qf '%{name}.%{arch}\n'|sort > /tmp/out.txt;egrep '(is not installed)' /tmp/out.txt > /tmp/out2.txt;awk '{ print $2 }' /tmp/out2.txt > /tmp/out3.txt;sed -e 's/^/yum install /' /tmp/out3.txt > /tmp/out4.txt;sed -e 's/$/ -y /' /tmp/out4.txt > /tmp/rpm.sh; sh -x /tmp/rpm.sh

rpm -q unzip wget binutils*.i* compat-libcap1.i* compat-libcap1* gcc-4* gcc-c++-4* glibc-devel* libaio* libgcc* libgcc*.i* libstdc++-* libstdc++-*.i* ksh make sysstat numactl numactl*.i* motif redhat-lsb oracle* --qf '%{name}.%{arch}\n'|sort > /tmp/out.txt;egrep '(is not installed)' /tmp/out.txt



wget http://public-yum.oracle.com/repo/OracleLinux/OL7/1/base/x86_64/getPackage/oracle-rdbms-server-12cR1-preinstall-1.0-3.el7.x86_64.rpm

https://drive.google.com/open?id=10mjBQX-1THZhZQtDOrN2ny8eBpbNXxtL


 BN >  9th January 1950
 AL >  15th July 1957
 
 

======================================

get user password :

select 
'alter user "'||username||'" identified by values '''||extract(xmltype(dbms_metadata.get_xml('USER',username)),'//USER_T/PASSWORD/text()').getStringVal()||''';'  old_password 
from 
   dba_users
where
username = '&1';
   
 

sys  >  
alter user "SYS" identified by values 'E069F5C8D8D2B8E6';
 
 current >  oracle123@TESTDB1


=========================================== 

col CURRENT_SCN format 9999999999999999999
select current_scn from v$database;
 
col OLD_SCN format 9999999999999999999
select timestamp_to_scn(to_timestamp('04/04/2018 13:30:00','DD/MM/YYYY HH24:MI:SS')) as OLD_SCN from dual; 


SQL>
         CURRENT_SCN
--------------------
       8678660466105

SQL> SQL> SQL>
             OLD_SCN
--------------------
       8678557956236


rman target /

run {
allocate channel c1 type disk format '/MIGRATION/B2BPRODP/rmanbkp/inc/inc_%U.rmb';
backup incremental from scn 8678557956236 database;
}

===================================

alter database create standby controlfile as '/MIGRATION/B2BPRODP/rmanbkp/TARGET_standby.ctl';

==========================================

./runInstaller -ignoreSysPrereqs -ignorePrereq -waitforcompletion -showProgress -silent \
    -responseFile /backup/database/response/db_install.rsp \
    oracle.install.option=INSTALL_DB_SWONLY \
    ORACLE_HOSTNAME=10.142.0.2 \
    UNIX_GROUP_NAME=oinstall \
    INVENTORY_LOCATION=/u02/app/oraInventory \
    SELECTED_LANGUAGES=en,en_GB \
    ORACLE_HOME=/u02/app/oracle/product/11.2.0/db_1 \
    ORACLE_BASE=/u02/app/oracle \
    oracle.install.db.InstallEdition=EE \
    oracle.install.db.DBA_GROUP=dba \
    oracle.install.db.BACKUPDBA_GROUP=dba \
    oracle.install.db.DGDBA_GROUP=dba \
    oracle.install.db.KMDBA_GROUP=dba \
    SECURITY_UPDATES_VIA_MYORACLESUPPORT=false \
    DECLINE_SECURITY_UPDATES=true
	
	
=========================================

 /opt/app/oracle/product/11.2/bin/netca /silent /responsefile /opt/app/oracle/product/11.2/network/admin/netca.rsp

 wget home :
 ============
 wget https://www.dropbox.com/s/wiqpb65umtpz6cw/p10098816_112020_LINUX_1of7.zip
 wget https://www.dropbox.com/s/r3mk4x7966hm0dx/p10098816_112020_LINUX_2of7.zip
 wget https://www.dropbox.com/s/94fyxfgunquawox/p13390677_112040_Linux-x86-64_1of7.zip
 wget https://www.dropbox.com/s/6ny179fb8tba8z2/p13390677_112040_Linux-x86-64_2of7.zip
 
 wget https://www.dropbox.com/s/uj45k77qe4wtbz4/db_home1_12.1.0_Patch_26609783.tar.gz
 
===========================================
standby script :===========================
 
cd /u02/orasoft

sudo su 
 
wget https://www.dropbox.com/s/k5y81e1ljatoiah/StndByArchsRmv.zip

exit
 
mkdir -p /u01/admin/scripts/cposprd/

cd /u01/admin/scripts/cposprd/

cp /u02/orasoft/StndByArchsRmv.zip .

unzip StndByArchsRmv.zip

cd StndByArchsRmv


ls -lrt 

#########modify ( DB_home in .sh file )############
 
mkdir log

chmod 755 *

#45 05,07,14,22 * * * /u01/admin/scripts/cposprd/StndByArchsRmv/StndByArchsRmv.sh cposprd 2> /u01/admin/scripts/cposprd/StndByArchsRmv/StndByArchsRmv.err


======================================

PDB CONNECTION:

-------------------


SQL> show pdbs;

    CON_ID CON_NAME                       OPEN MODE  RESTRICTED
---------- ------------------------------ ---------- ----------
         2 PDB$SEED                       READ ONLY  NO
         3 GTSPDB                         READ WRITE NO
SQL>  ALTER SESSION SET CONTAINER=GTSPDB;

Session altered.

SQL>



GTSPDB =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = gtsgcprd-scan.proddbsnprivate.ktvcn.oraclevcn.com)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = gtspdb.proddbsnprivate.ktvcn.oraclevcn.com)
    )
  )
  
  

GTSPDB =
  (DESCRIPTION =
    (ADDRESS = (PROTOCOL = TCP)(HOST = gtsgcprd-scan.proddbsnprivate.ktvcn.oraclevcn.com)(PORT = 1521))
    (CONNECT_DATA =
      (SERVER = DEDICATED)
      (SERVICE_NAME = gtspdb.proddbsnprivate.ktvcn.oraclevcn.com)
    )
  )
 
select NAME,OPEN_MODE from v$pdbs;

 ===========================================================================================
 
 
 [oracle@ip-172-31-22-235 response]$ /u01/app/oracle/product/12.1.0/db_1/bin/netca /silent /responsefile /orasoft/database/response/netca.rsp

Mon Jun 04 14:39:24 UTC 2018 Oracle Net Configuration Assistant
Parsing command line arguments:
    Parameter "silent" = true
    Parameter "responsefile" = /orasoft/database/response/netca.rsp
    Parameter "log" = /tmp/netca.log
Done parsing command line arguments.
Oracle Net Services Configuration:
Configuring Listener:LISTENER
Listener configuration complete.
Oracle Net Listener Startup:
    Running Listener Control:
      /u01/app/oracle/product/12.1.0/db_1/bin/lsnrctl start LISTENER
    Listener Control complete.
    Listener started successfully.
Profile configuration complete.
Oracle Net Services configuration successful. The exit code is 0
[oracle@ip-172-31-22-235 response]$ ps -ef |grep pmon
oracle   29845 29423  0 14:39 pts/0    00:00:00 grep --color=auto pmon
[oracle@ip-172-31-22-235 response]$ ps -ef |grep tns
root        19     2  0 09:11 ?        00:00:00 [netns]
oracle   29834     1  0 14:39 ?        00:00:00 /u01/app/oracle/product/12.1.0/db_1/bin/tnslsnr LISTENER -inherit
oracle   29851 29423  0 14:39 pts/0    00:00:00 grep --color=auto tns
[oracle@ip-172-31-22-235 response]$


 ========================================creat ===
Creating Database Using DBCA Silent Mode:

=========================================

./dbca -silent -createDatabase \
 -templateName General_Purpose.dbc \
 -gdbname testdb -sid testdb -responseFile NO_VALUE \
 -characterSet AL32UTF8 \
 -sysPassword OraPasswd1 \
 -systemPassword OraPasswd1 \
 -createAsContainerDatabase false \
 -pdbAdminPassword OraPasswd1 \
 -databaseType MULTIPURPOSE \
 -automaticMemoryManagement false \
 -totalMemory 2048 \
 -storageType FS \
 -datafileDestination "/u01/dbfiles/" \
 -redoLogFileSize 100 \
 -emConfiguration NONE \
 -ignorePreReqs
 
 
 ./dbca -silent \
-createDatabase \
-templateName General_Purpose.dbc \
-gdbName DBATOOLS \
-sid DBATOOLS \
-SysPassword dba123 \
-SystemPassword dba123 \
-emConfiguration NONE \
-redoLogFileSize 500 \
-recoveryAreaDestination FRA \
-storageType ASM \
-asmSysPassword dba123 \
-diskGroupName DATA \
-characterSet AL32UTF8 \
-nationalCharacterSet AL16UTF16 \
-totalMemory 2400 \
-databaseType MULTIPURPOSE


 dbca -silent -deleteDatabase -sourceDB myorcldb -sysDBAUserName sys -sysDBAPassword OraPasswd1
 alter database recover managed standby database disconnect from session;
 
 ===========================================
 https://www.uxora.com/oracle/dba/27-silent-install-oracle-asm
 
 http://www.dbaglobe.com/2014/12/examples-on-silent-operations-of-netca.html
 
 netca -silent -responsefile /u01/app/oracle/product/12.1.0/db_home1/assistants/netca/netca.rsp
 
 Sample listener.ora  :
 =========================
 
SID_LIST_LISTENER_testdb =
  (SID_LIST =
     (SID_DESC =
       (ORACLE_HOME = /oracle/product/12.1.0/db_home1)
       (SID_NAME = testdb)
      )
   )

LISTENER_testdb =
  (DESCRIPTION_LIST =
    (DESCRIPTION =
      (ADDRESS = (PROTOCOL = TCP)(HOST = 40.76.56.207)(PORT = 1521))
    )
  )

 Sample tnsnames.ora  :
 =========================  
 
testdb =
 (DESCRIPTION =
   (ADDRESS = (PROTOCOL = TCP)(HOST = 40.76.56.207)(PORT = 1521))
   (CONNECT_DATA =
     (SERVER = DEDICATED)
     (SERVICE_NAME = testdb)
   )
 )


Reg Add "HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Office\16.0\common\officeupdate" /V "EnableAppearOffline" /D 1 /T REG_DWORD /F
 
 ASM Silent :
 ============
 
mkdir -p /oradata/u00/app/oracle/grid/12.1.0/


/oradata/sw/response/grid_install.rsp:
=======================================

INVENTORY_LOCATION=/oradata/u00/app/oraInventory
oracle.install.option=CRS_SWONLY
ORACLE_BASE=/oradata/u00/app/oracle
oracle.install.asm.OSDBA=asmdba
oracle.install.asm.OSOPER=asmoper
oracle.install.asm.OSASM=asmadmin




./runInstaller  -silent -responseFile /u02/orasoft/grid/response/grid_install.rsp -ignoreSysPrereqs -ignorePrereq


[root@my1stins rsa-key-20180702]#  ls -la /dev/oracleasm/disks/*
brw-------. 1 grid dba 8, 33 Jul  2 14:45 /dev/oracleasm/disks/ASMQCDEVDATA002
brw-------. 1 grid dba 8, 17 Jul  9 17:30 /dev/oracleasm/disks/ASMTEST001



./asmca -silent -configureASM -sysAsmPassword sysadmin -asmsnmpPassword sysadmin -diskString '/dev/oracleasm/disks/*' -diskGroupName DATA -diskList '/dev/oracleasm/disks/ASMTEST001' -redundancy EXTERNAL -au_size 16 -compatible.asm '12.1.0.0.0' -compatible.rdbms '12.1.0.0.0'



./asmca -silent -createDiskGroup \
-diskString '/dev/oracleasm/disks/*' \
-diskGroupName FRA \
-diskList '/dev/oracleasm/disks/ASMQCDEVDATA002' \
-redundancy EXTERNAL 


./asmca -silent -createDiskGroup -diskString '/dev/oracleasm/disks/*' -diskGroupName FRA -diskList '/dev/oracleasm/disks/ASMQCDEVDATA002' -redundancy EXTERNAL




[grid@my1stins bin]$ asmcmd lsdg
State    Type    Rebal  Sector  Block        AU  Total_MB  Free_MB  Req_mir_free_MB  Usable_file_MB  Offline_disks  Voting_files  Name
MOUNTED  EXTERN  N         512   4096  16777216    204784   204544                0          204544              0             N  DATA/
MOUNTED  EXTERN  N         512   4096   1048576    204797   204742                0          204742              0             N  FRA/
[

==============================================================================================================================================
./asmca -silent -configureASM -sysAsmPassword Oracle123 -asmsnmpPassword Oracle123 -diskString '/dev/oracleasm/disks/*' -diskGroupName LUXRXRPTQA_DDATA -diskList '/dev/oracleasm/disks/ASMLUXRXRPTQADATA001' -redundancy EXTERNAL -au_size 16 -compatible.asm '12.1.0.0.0' -compatible.rdbms '11.1.0.0.0'
 asmcmd lsdg
 ./asmca -silent -addDisk -sysAsmPassword Oracle123 -asmsnmpPassword Oracle123 -diskString '/dev/oracleasm/disks/*' -diskGroupName LUXRXRPTQA_DDATA -diskList '/dev/oracleasm/disks/ASMSMART11PDATA001' -redundancy EXTERNAL -au_size 16 -compatible.asm '12.1.0.0.0' -compatible.rdbms '11.1.0.0.0'
 ./asmca -silent -addDisk -sysAsmPassword Oracle123 -asmsnmpPassword Oracle123 -diskString '/dev/oracleasm/disks/*' -diskGroupName LUXRXRPTQA_DDATA -diskList '/dev/oracleasm/disks/ASMLUXRXRPTQADATA002'
 ./asmca -silent -addDisk -sysAsmPassword Oracle123 -asmsnmpPassword Oracle123 -diskString '/dev/oracleasm/disks/*' -diskGroupName LUXRXRPTQA_DDATA -diskList '/dev/oracleasm/disks/ASMLUXRXRPTQADATA003'
 ./asmca -silent -addDisk -sysAsmPassword Oracle123 -asmsnmpPassword Oracle123 -diskString '/dev/oracleasm/disks/*' -diskGroupName LUXRXRPTQA_DDATA -diskList '/dev/oracleasm/disks/ASMLUXRXRPTQADATA004'
 ./asmcmd lsdg
 ps -ef |grep pmon
 ./asmca -silent -createDiskGroup -diskString '/dev/oracleasm/disks/*' -diskGroupName LUXRXRPTQA_DFRA -diskList '/dev/oracleasm/disks/ASMLUXRXRPTQAFRA001' -redundancy EXTERNAL
 ./asmca -silent -addDisk -sysAsmPassword Oracle123 -asmsnmpPassword Oracle123 -diskString '/dev/oracleasm/disks/*' -diskGroupName LUXRXRPTQA_DFRA -diskList '/dev/oracleasm/disks/ASMLUXRXRPTQAFRA002'
 ./asmca -silent -createDiskGroup -diskString '/dev/oracleasm/disks/*' -diskGroupName LUXRXRPTQA_DREDO1 -diskList '/dev/oracleasm/disks/ASMLUXRXRPTQARDOCTL001' -redundancy EXTERNAL
 ./asmca -silent -createDiskGroup -diskString '/dev/oracleasm/disks/*' -diskGroupName LUXRXRPTQA_DREDO2 -diskList '/dev/oracleasm/disks/ASMLUXRXRPTQARDOCTL002' -redundancy EXTERNAL
 . oraenv
 ./asmcmd lsdg
 
=====================================================================================
 
export TNS_ADMIN=/oracle/product/12.1.0/db_home1/network/admin/
echo $TNS_ADMIN

srvctl stop listener
srvctl start listener
srvctl status listener
pwd



================================================================

 
 
 
set time on
set lines 200

prompt ++++++++++++++++++++LAST SEQUENCE RECIEVED FROM PRODUCTION and APPLIED ON STANDBY+++++++++++++++++++++++++

SELECT ARCH.THREAD# "Thread", ARCH.SEQUENCE# "Last Sequence Received", APPL.SEQUENCE# "Last Sequence Applied", (ARCH.SEQUENCE# - APPL.SEQUENCE#) "Difference"
FROM
(SELECT THREAD# ,SEQUENCE# FROM V$ARCHIVED_LOG WHERE (THREAD#,FIRST_TIME ) IN (SELECT THREAD#,MAX(FIRST_TIME) FROM V$ARCHIVED_LOG GROUP BY THREAD#)) ARCH,
(SELECT THREAD# ,SEQUENCE# FROM V$LOG_HISTORY WHERE (THREAD#,FIRST_TIME ) IN (SELECT THREAD#,MAX(FIRST_TIME) FROM V$LOG_HISTORY GROUP BY THREAD#)) APPL
WHERE
ARCH.THREAD# = APPL.THREAD#
;

 ===========================================

 ALTER DATABASE RECOVER MANAGED STANDBY DATABASE CANCEL;




ALTER DATABASE RECOVER MANAGED STANDBY DATABASE NODELAY DISCONNECT FROM SESSION;
=================================

RMAN VALIDATE :


RESTORE DATABASE PREVIEW ;
RESTORE DATABASE VALIDATE;
RESTORE ARCHIVELOG FROM sequence xx UNTIL SEQUENCE yy THREAD nn VALIDATE;
RESTORE CONTROLFILE VALIDATE;
RESTORE SPFILE VALIDATE;



RUN
{
set until time "to_date('30-MAY-201822:20:00','dd-mm-yyyyhh24:mi:ss')";
allocate channel ch1 device type disk ;
RESTORE DATABASE PREVIEW ;
}  


RUN
{
set until time "to_date('30-MAY-201822:20:00','dd-mm-yyyyhh24:mi:ss')";
allocate channel ch1 device type disk ;
restore database validate;
}
 
RUN
{
allocate channel ch1 type disk;
restore archivelog from sequence 8 until sequence 10 thread 1 validate;
restore archivelog from sequence 4 until sequence 6 thread 2 validate;
}

RUN
{
allocate channel ch1 type disk;
set until time "to_date('30-MAY-201822:20:00','dd-mm-yyyyhh24:mi:ss')";
restore controlfile validate;
restore spfile validate;
}




==================================================

time dgmgrl sys/ "switchover to 'WCMPROD1'"  

time dgmgrl sys/ "show configuration" 



==========================================


[oracle@LOLUCYWSDBT01 ~]$ cat /home/oracle/.bash_profile
# .bash_profile

# Get the aliases and functions
if [ -f ~/.bashrc ]; then
        . ~/.bashrc
fi

# User specific environment and startup programs

PATH=$PATH:$HOME/bin

export PATH

export ORACLE_BASE=/u01/app/oracle
export ORACLE_HOME=/u01/app/oracle/product/12.1.0/db_home1
export export PATH=$ORACLE_HOME/bin:$PATH
export ORACLE_SID=LUCY11T
export TNS_ADMIN=/u01/app/oracle/product/12.1.0/db_home1/network/admin
alias o='. /u01/app/oracle/product/12.1.0/db_home1/bin/oraenv'
alias s='sqlplus "/as sysdba"'
alias p='ps -ef |grep pmon;ps -ef |grep tns'
alias a='tail -f /u01/app/oracle/diag/rdbms/arsystem1/ARSYSTEM/trace/alert_ARSYSTEM.log'


=======================================================
[grid@LOLUCYWSDBT01 ~]$ cat .bash_profile

# .bash_profile

# Get the aliases and functions
if [ -f ~/.bashrc ]; then
        . ~/.bashrc
fi

# User specific environment and startup programs

PATH=$PATH:$HOME/bin

export PATH

export ORACLE_BASE=/u02/app/oracle
export ORACLE_HOME=/u02/app/oracle/product/11.2.0/db_home1
export PATH=$ORACLE_HOME/bin:$PATH
export ORACLE_SID=TEST
export TNS_ADMIN=/u02/app/oracle/product/11.2.0/db_home1/network/admin



#######################################################################



SET LONG 9000 
SELECT DBMS_METADATA.GET_DDL('DB_LINK',a.db_link,a.owner) FROM dba_db_links a;



=======================


GB1-SEA08.01.01           10560072

IT1-LX00R.20.04.13   10609905 B2BPCR


IT1-LXTTP.01.01.08   RETAIL




===================================
Attach Home
===================================

cd /u00/app/12.1.0/grid/oui/bin

./attachHome.sh

/u00/app/12.1.0/grid/OPatch/opatch lsinventory -allcd /u00/app/12.1.0/grid/oui/bin

./attachHome.sh

/u00/app/12.1.0/grid/OPatch/opatch lsinventory -all

=====================================
Recreate Grid Home Inventory
=====================================

ls -ld /u00/app/oraInventory

cd /u00/app/

mv oraInventory oraInventory_old

cd $ORACLE_HOME/oui/bin
pwd
/u00/app/12.1.0/grid/oui/bin

echo $ORACLE_HOME
/u00/app/12.1.0/grid


./runInstaller -silent -ignoreSysPrereqs -attachHome ORACLE_HOME="/u00/app/12.1.0/grid" ORACLE_HOME_NAME="12C_GI_HOME2"

==============================
GI Patching
==============================

date 

ps -ef |grep pmon;ps -ef |grep tns

sudo su -

cd /u02/orasoft


wget https://www.dropbox.com/s/p91tg099c5yosqx/p6880880_121010_Linux-x86-64%20%281%29.zip
wget https://www.dropbox.com/s/rahua336tfdmgzz/p27468957_121020_Linux-x86-64.zip


chown -R grid:oinstall /u00

sudo -iu grid

mv /u00/app/12.1.0/grid/OPatch /u00/app/12.1.0/grid/OPatch_old

cp /u02/orasoft/p6880880_121010_Linux-x86-64* /u00/app/12.1.0/grid/

cd /u00/app/12.1.0/grid/

unzip p6880880_121010_Linux-x86-64*

cd /u00/app/12.1.0/grid/oui/bin

./attachHome.sh

/u00/app/12.1.0/grid/OPatch/opatch lsinventory -all

cd /u02/orasoft

unzip p27468957_121020_Linux-x86-64.zip

exit 

sudo su - 

export PATH=$PATH:/u00/app/12.1.0/grid/OPatch

opatchauto apply /u02/orasoft/27468957 -oh /u00/app/12.1.0/grid

sleep 30

exit

sudo -iu grid

/u00/app/12.1.0/grid/OPatch/opatch lsinventory -all

ps -ef |grep pmon;ps -ef |grep tns

exit

date

================================================

ip=`hostname -I` ; sed -i "s/LOLUCYCHDBT01.luxgroup.net/$ip/g" listener.ora








==================================



/u00/app/12.1.0/grid/dbs/tmpASM1.ora


[grid@LCLUCYCHDBP01 dbs]$ cat /u00/app/12.1.0/grid/dbs/tmpASM1.ora
+ASM.asm_diskgroups='LUCY11CPDATA','LUCY11CPFRA','LUCY11CPREDO1','LUCY11CPREDO2'#Manual Mount
*.asm_diskstring='/dev/oracleasm/disks/*'
*.asm_power_limit=1
*.diagnostic_dest='/u00/app'
*.instance_type='asm'
*.large_pool_size=12M
*.remote_login_passwordfile='EXCLUSIVE'
[grid@LCLUCYCHDBP01 dbs]$
[grid@LCLUCYCHDBP01 dbs]$
[grid@LCLUCYCHDBP01 dbs]$


=======================================


sudo useradd -m SAdmin
sudo passwd SAdmin
sudo usermod -G wheel SAdmin
sudo vi /etc/sudoers
SAdmin    ALL=(ALL)       ALL
sudo vi /etc/ssh/sshd_config
PasswordAuthenttion yes
sudo reboot ica

=======================================


sudo useradd -m sadmin
sudo passwd sadmin          >  0m@@T@ra#$%67
sudo usermod -G wheel sadmin
sudo vi /etc/sudoers
sadmin    ALL=(ALL)       ALL
sudo vi /etc/ssh/sshd_config
PasswordAuthenttion yes
sudo reboot ica


==================================

pub key format :

ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEAgjL2JrZ8Su4f/idjwe54OXSR8Pa8L/3fcZOTIm79q672Jkwrn9LD
lUegEMPcxxeOyjbZdO9q4/NRUdYIo9DlUGX9SfBSPmDdxVHQ+jFQMGsJo2L0ajvWNWm1tK7VUHhn8n+/EsI2tVIPK
z//Ufsi0++PwOv8lRP5gbzwSIzUNVrp7so6sMROMmYvp2m+NQEFDn3pOyLIfwkU354iFgV3xXxBkMh+WxhC30A8ip
xYa+uWZha6EjLdeEBh/E4e/mH6Kye9NlWrgErJx5c2ZokjqoTAFwEH9oFb5kx8JTc47RK7csFIWFMxAu2ujYSUW6w
AP9UY+Yke1uK+AzpoJeRt+Q== rsa-key-20181022


####PuTTY-User-Key-File-2: ssh-rsa
####Comment: rsa-key-20181022

==================================

ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEAw8U8hauP4yNo1MvYMS7CM8nPgdJsb1IYrmmteWHR5NsnVOWmHufVLIV/1MnSK8qCKftQRQ2pEUtrpn+hx3aKhz+21szN5P5qOlAva/1UZeoCJFNwf+N+HBnf/hfOn3clGPGCaE3OcHAUkiqo4m5N70sDo8WTvprudEmcph7+CnzCQeBZRyo8CED5KJMd4DAobGFtEajr5Ng0PfBaB0U5eX8iYwrCJl6YjhpzuT7VsFFGCmRMQ6Qt4LADKoI4pjpQqXziahF0AZQLoKfKfBPkB3mR8hQQHCzvHgGTX/7eCk+y+HLeZoZMVKd99WzCYGfgH2zbD5cXOa42to0ELMahbw== rsa-key-20181024



PuTTY-User-Key-File-2: ssh-rsa
Encryption: aes256-cbc
Comment: rsa-key-20181208
Public-Lines: 6
ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEAhVykr2X8g5nQpE1ZSp8wryfsSq7GlRyQignVlB+iDx08PLK5PE+9FIQ50OFGlBYzykXwf4d8JbEpaGBQFvtqGPLtn3ZLakzeDo0QEFTJJCLBCCQArNbdyLO9IV5tn4g6gii8Lt2p+OvPOmuOAZ8dQ0PNVaS/IuCwlrtLuG0LAnZfu9tFWvASdAPH9oBA9X+8OOejyLTOu1CaNKPjrnrT18XOoc1UTjXtXusicqD+/iG2J4w8p3PlBIntPrC1H33OvgJZaoAMALJG1DHz8PMsaMsFFMnVaOkQ6+8/PpSQ9szti0sIjFtFSrF5UVlp9L41+k6AXRU544p+zK8eLVuZyQ== rsa-key-20181208
==========================


Redhat openstack- Competency : Red Hat OpenStack Deployment engineer, to perform RHOS installation, upgrades, maintenance, and ongoing configurations

Experience installing from bottom up, new system using tripple O. 
Must be a significant deployment that went live the person was responsible from start to end


======================================
IBM Cloud :
===========

Gobinda.Saha@dxc.com  >>   Taramaa123#456

https://www.onlinedigitallearning.com/my/


My Enrollments

My courses
------------
Foundation Badge Quiz

DL09304G  >  IBM Cloud Private Infrastructure and Architecture Series: Adopting Cloud technologies

BG09023G  > 


DL09305G  >  IBM Cloud Private Infrastructure and Architecture Series: Introduction to concepts, infrastructure, and architecture

DL09306G >   IBM Cloud Private Infrastructure and Architecture Series: IBM Cloud Professional Services


https://www-03.ibm.com/services/learning/itesp.wss/zz-en?pageType=journey_description&journeyId=LDE-ICP-LJ02&tag=o-itns-01-02

https://www-03.ibm.com/services/learning/ites.wss/zz-en?searchString=IBM%20Cloud%20Professional%20Services&pageType=search&noOfResultsPerPage=20&rowStart=0&cc=#(cc%3A''%2Cfilters%3A()%2CnumberOfResults%3A'20'%2CpageNumber%3A'1'%2CpubEntIdentifier%3ApublicEntitled%2Cquery%3A'IBM%20Cloud%20Professional%20Services'%2Csorting%3Arelevance%2F%2Fasc%2Ctype%3Aall%2CviewMode%3A0)


=======================================

Badge Description

https://www-03.ibm.com/services/learning/ites.wss/zz-en?pageType=badges&id=ac394a45-2d7e-490e-8893-762204893114


https://www.ibm.com/developerworks/community/groups/service/html/communitystart?communityUuid=bd570318-14bf-4277-bddc-56a74b904e41


IBM Cloud - Business Partner Badge Collection
==============================================

https://www.ibm.com/developerworks/community/groups/service/html/communitystart?communityUuid=0323c646-08c1-4452-ac5f-c7409d97a79e


Cloud / Cloud Solutions

	

How to take an On-Premise Solution to the IBM Cloud Workshop

	
IBM Business Partner Cloud Success
	
IBM Cloud Solutions - Sales Mastery

	
IBM Business Partner Cloud Native Development
 
IBM Cloud Solutions - Top Gun


IBM Support
You may want to contact the IBM Skills Gateway support here: skillsgw@us.ibm.com.
10:36:08 PM
Or review their FAQ page here: https://www-03.ibm.com/services/learning/ites.wss/zz-en?pageType=page&c=P430723G05904L37


==============================================
IBM Cloud Private Installation and Configuration Series :  (  BG09024G  )

What it takes to earn this badge  ::


Complete the IBM Cloud Private Installation and Configuration: Installation and configuration course   (  DL09307G  )

Complete the IBM Cloud Private Installation and Configuration: Cloud native scenarios course.   (  DL09308G  )


Complete the IBM Cloud Private Installation and Configuration: IBM Cloud Private Services course  ( DL09309G  )
  

Complete the IBM Cloud Private Installation and Configuration: High availability course   ( DL09310G  ) 


Complete the IBM Cloud Private Installation and Configuration Badge Quiz with a passing score of 80% or higher


IBM Cloud Private - Expert Professional :
============================================
Skills
Microservices|IBM Cloud Private|Administrator|Architect|Cloud Native|CI/CD|Continuous Deployment|Continuous Integration|Developer|DevOps|ICP|Jenkins|Linux|Private Cloud|Business Partners|UrbanCode|Containers|Docker|Kubernetes|Helm|Cloud Foundry

What it takes to earn this badge:

IBM Cloud Private Infrastructure and Architecture

IBM Cloud Private - Continuous Integration/Continuous Delivery Pipelines

IBM Cloud Private - Technical Bootcamp

For IBM customers and IBM employees earning this badge, send screen captures of these 3 badges in Acclaim to: agoering@us.ibm.com

For IBM business partners earning this badge, send screen captures of these 3 badges to Acclaim to CloudBP@us.ibm.com.Â Â 


=======================================================
FAL


In Primary site:

FAL_SERVER=STANDBY
FAL_CLIENT=PRIMARY

In Standby site:

FAL_SERVER=PRIMARY
FAL_CLIENT=STANDBY


=======================


If the complete deal above >  
early engagement period > deal review, HLD > costing , presales part for POC .> Bid evaluation  ( all )> LLD  > final review call > deal finalize >  account team +sales team>   > 



=======================



ASM cleanup:

cd $ASM_HOME/rdbms/audit
find . -type f -name '*.aud' | xargs rm
find . -name "*.aud" -mtime +90 -exec rm {} \;  
cd $ASM_HOME/bin
./crsctl stat res -p
./crsctl modify resource ora.asm -attr "CHECK_INTERVAL=300" -unsupported  



=======================


ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEA023x/FvIZBirt4bbEtcaOwS2eme+28tSLITayfNGj2giKeXiRhcaiDqfJgSDCYul10JbL+Zi24qRvznpt3RsouHDgQ55I8v9VcaLRQSZa9Mf+aA3bbAg1SO2fsxeX2bwkEtiEyObe/h3DSipBy816KstMRIjnEq6oPyNru4EPo21WPbKPiUsUC8fES1hQYbC3frJiTh2BDSjEjLf5vs9SA6cGrkg0IvGIQyZmgo7Pw2luxUHS7NyRNBn5STYBmfpxFibWzp1G0ZtpPakfgHm9rbgMSiRMjl1AL3gaIX0S1S/3ihH9rjKQt5yN2Fpg2v8mD8f27elWzWB4iyXVIOLYw== oci2102

ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEAst479uKz7/ugSqMEfK7AImHAa7w0VfGllSEGUbRgCyIQJ1QDbbRcPsyZ6DzB83vnfZ8ZEn3j1LeJehripLJFjbRAJdbfHLbv/ey67Nse1rs8HUcpjv4h8E+ZUc33xq0LdXRq0YjAR32kzdA4ZuwLwMNdapZiouUzDFHsZJ5Td+yLWizDL8qz09nKYWATkfAyh6kZ9VgDdO6KyLqRDNtVWCFOnyD+tKlxF1zGON/2CZuAKZMfgknaD4QZjlaB4KNRsOReqaxqHLguRdpiNBEL0UOrszcPaPqYiPH3a4NLNTD4D04pUdaZ+QUrj9r8DGH9X888e7pcyL1uGU+sF3PfWQ== lnxadmin

AAAAB3NzaC1yc2EAAAABJQAAAQEAst479uKz7/ugSqMEfK7AImHAa7w0VfGllSEGUbRgCyIQJ1QDbbRcPsyZ6DzB83vnfZ8ZEn3j1LeJehripLJFjbRAJdbfHLbv/ey67Nse1rs8HUcpjv4h8E+ZUc33xq0LdXRq0YjAR32kzdA4ZuwLwMNdapZiouUzDFHsZJ5Td+yLWizDL8qz09nKYWATkfAyh6kZ9VgDdO6KyLqRDNtVWCFOnyD+tKlxF1zGON/2CZuAKZMfgknaD4QZjlaB4KNRsOReqaxqHLguRdpiNBEL0UOrszcPaPqYiPH3a4NLNTD4D04pUdaZ+QUrj9r8DGH9X888e7pcyL1uGU+sF3PfWQ==


ssh-rsa AAAAB3NzaC1yc2EAAAABJQAAAQEAx5kT1EZ+zF+6bSx848O+uDokPSzFn8Mb6UNAkkGuAyHMvmjAQZMjZaC9t5MOnyrwrpsHqcybu7zNXER2LlLo/6R+qUdv+yOnhoz8csFAQbafdN9d4SEMi/mGCk4rKfMiLHcrbrts9siVaBVhJvD6OaxzLu6JWcYyZ/2TafD45xO3sdaRpv9L9/4uwp3eG/nyrBojpZWJFtIn0CRS0IzpibjnClGENO54ptbvw7AOLTys+YfuUGVGwSGa31ot62Y0oDx2zJrx7P8iInO2KF2NvGsx34K1uF4EdnhjIjiueKit/PU7Eym2NR2zkz8gHplTuKi7foRrnhZAC+LRG8YVVQ== mygcp


Taramaa123#

TAramaa123#456##




https://objectstorage.us-ashburn-1.oraclecloud.com/p/1eVUjRbAzCw4n2a45pRNZfFMZRKT8QvPD3UabbDx_a4/n/nrdcg3dscih7/b/bucket-20190613-0007/o/
